
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.6" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs/null.min.css"
      type="text/css" />

<script src="../site_libs/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=analysisDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=analysisArray;
            var docs_map=analysisArrayMap;
            var pos=analysisArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  $('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  $(".toc #toc-level0").append('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>');
            }
            // $("#toc-header").hide(); // comment out because it prevents search bar from displaying
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Gene Mapping with CNV</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Gene Mapping with CNV</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Overview</a>
</li>
        
<li>
  <a href="../analysis.html">Analysis</a>
</li>
        
<li>
  <a href="../prototype.html">Prototype</a>
</li>
        
<li>
  <a href="../utils.html">Utils</a>
</li>
        
<li>
  <a href="../setup/index.html">Setup</a>
</li>
        
<li>
  <a href="../writeup.html">Writeup</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="http://github.com/gaow/cnv-gene-mapping"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Implement-of-table-1-and-Figure-3-in-CNV-in-schizophrenia-in-Sweden">Implement of table 1 and Figure 3 in CNV in schizophrenia in Sweden<a class="anchor-link" href="#Implement-of-table-1-and-Figure-3-in-CNV-in-schizophrenia-in-Sweden">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">pandasql</span> <span class="k">import</span> <span class="n">sqldf</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Table-1">Table 1<a class="anchor-link" href="#Table-1">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_pheno</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/swcnv/swcnv.pheno&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
<span class="n">sw_sum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/swcnv/swcnv.qc6.cnv.summary&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span> <span class="c1"># &quot;CHR&quot;</span>
<span class="n">sw_fam</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/swcnv/swcnv.qc6.fam&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                       <span class="n">usecols</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Case-Ctrl&quot;</span><span class="p">])</span> <span class="c1"># sex and case-ctrl</span>
<span class="n">sw_cnv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/swcnv/swcnv.qc6.cnv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
<span class="n">sw_cluster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/swcnv/swcnv.clusters&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span> <span class="c1"># Sw1, Sw2-4, Sw5-6</span>
<span class="n">sw_cluster</span> <span class="o">=</span> <span class="n">sw_cluster</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uFID&quot;</span><span class="p">:</span> <span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;uIID&quot;</span><span class="p">:</span> <span class="s2">&quot;IID&quot;</span><span class="p">})</span>
<span class="n">sw_indiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/swcnv/swcnv.qc6.cnv.indiv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span> <span class="c1"># &quot;NSEG&quot;: number of CNV in each sample</span>
<span class="n">sw_cluster_indiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_cluster</span><span class="p">,</span> <span class="n">sw_indiv</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">])</span>
<span class="n">sw_cluster_cnv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_cluster</span><span class="p">,</span> <span class="n">sw_cnv</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">])</span>
<span class="c1"># One line for each individual with at least one CNV</span>
<span class="n">sw_cluster_cnv_indiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_cluster_cnv</span><span class="p">,</span> <span class="n">sw_indiv</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">])</span>
<span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;BP2&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;BP1&quot;</span><span class="p">])</span><span class="o">/</span><span class="mi">1000</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>          FID  IID            tr  CHR        BP1        BP2  TYPE     SCORE  \
0     PT-BPTP    1  scz_s234_eur    7    9128802    9229882     1   65.0100   
1     PT-BPAI    1  scz_s234_eur   16   18228118   18727232     3   13.1300   
2     PT-BSLJ    1  scz_s234_eur    1   16869363   17005978     3   38.6800   
3     PT-BQP5    1  scz_s234_eur   16   18830938   19075191     3   97.8900   
4     PT-BP9I    1  scz_s234_eur   21   37481955   37619514     4  147.0000   
5     PT-BQGK    1  scz_s234_eur   15   97984319   99176197     3  811.3100   
6     PT-BSRL    1  scz_s234_eur   11   54773893   56010199     3  436.6850   
7     PT-BPTX    1  scz_s234_eur    6  119714337  119951785     1  171.4600   
8     PT-BPYW    1  scz_s234_eur    9   11919831   12182949     1  313.6600   
9     PT-BRL3    1  scz_s234_eur   16   15072787   15241308     3   41.4400   
10    PT-BRL3    1  scz_s234_eur   22   23689983   25070067     3  322.4150   
11    PT-BQ15    1  scz_s234_eur    7  125640231  125772441     1  130.6000   
12    PT-BQ15    1  scz_s234_eur   15   22673399   23241449     3  168.9300   
13    PT-BRLU    1  scz_s234_eur   22   16864898   17288220     3  116.7500   
14    PT-BQYE    1  scz_s234_eur    7   88150798   90161919     3   83.0420   
15    PT-BQ64    1  scz_s234_eur    6   57656301   58082951     3  148.1100   
16    PT-BQ64    1  scz_s234_eur    6   61930020   62123362     3   79.7500   
17    PT-BQ64    1  scz_s234_eur    9   45368770   46210382     1   14.4300   
18    PT-BQ64    1  scz_s234_eur    9   68837844   69186411     1   17.9000   
19    PT-BQ64    1  scz_s234_eur    9   69685271   69978022     1   33.2200   
20    PT-BSY2    1  scz_s234_eur    1  248249108  248434821     3  112.9500   
21    PT-BSY2    1  scz_s234_eur   11  134348915  134719568     3  254.7000   
22    PT-BSY2    1  scz_s234_eur   17   26835922   27055440     3   49.8600   
23    PT-BRMS    1  scz_s234_eur    4  181479865  181583203     3  141.5200   
24    PT-BRMS    1  scz_s234_eur   22   33538320   33848010     3  340.3100   
25    PT-BRLT    1  scz_s234_eur    1  104163499  104303639     4   15.5600   
26    PT-BRLT    1  scz_s234_eur    9   41475106   42065343     3   11.7800   
27    PT-BRLT    1  scz_s234_eur    9   45054940   46331526     3   11.2600   
28    PT-BRLT    1  scz_s234_eur    9   68995234   69958201     3   19.1300   
29    PT-BRLT    1  scz_s234_eur   10   88997299   89117300     4   11.0700   
...       ...  ...           ...  ...        ...        ...   ...       ...   
9693  PT-P29A    1  scz_swe6_eur   12    6079058    6402340     3  105.2600   
9694  PT-P29F    1  scz_swe6_eur    6  169021311  170116319     1   83.4267   
9695  PT-P29L    1  scz_swe6_eur   15   94242985   94402204     3   46.9200   
9696  PT-P29N    1  scz_swe6_eur    3   35826707   35938795     3   33.5400   
9697  PT-P29P    1  scz_swe6_eur   12   19469320   19578107     3   15.8100   
9698  PT-P29U    1  scz_swe6_eur    2  110863095  110980346     3   43.9400   
9699  PT-P29U    1  scz_swe6_eur   13   58977716   59091043     3   32.8800   
9700  PT-P2A5    1  scz_swe6_eur    8   16416711   16526958     1   83.2600   
9701  PT-P2A6    1  scz_swe6_eur    2   35819686   36087642     1  150.2800   
9702  PT-P2A6    1  scz_swe6_eur    3  109621818  109727353     1   49.3600   
9703  PT-P2A6    1  scz_swe6_eur    7    9283620    9458495     1   77.9600   
9704  PT-P2A9    1  scz_swe6_eur    9     312134     594579     3  184.1000   
9705  PT-P2AB    1  scz_swe6_eur    9  138182186  138284278     3   37.6200   
9706  PT-P2AE    1  scz_swe6_eur    7  110892226  111122474     1   61.6700   
9707  PT-P2AJ    1  scz_swe6_eur    2   89620837   91732866     1   17.2000   
9708  PT-P2AJ    1  scz_swe6_eur    3  141835715  142085310     3   46.8900   
9709  PT-P2AM    1  scz_swe6_eur    1   12852872   12961019     1   28.2800   
9710  PT-P2AP    1  scz_swe6_eur    4   12374586   12643903     3   49.6900   
9711  PT-P2AP    1  scz_swe6_eur    7  110892226  111023322     1   58.6300   
9712  PT-P2AV    1  scz_swe6_eur    8   78863442   79059629     1   77.0800   
9713  PT-P2AW    1  scz_swe6_eur    9  120869313  121385397     3   94.1350   
9714  PT-P2AX    1  scz_swe6_eur   13   43544964   43732555     3  108.8700   
9715  PT-P2AX    1  scz_swe6_eur   19   43663086   43835935     1   32.4500   
9716  PT-P2AY    1  scz_swe6_eur    1   25447125   25760920     3   41.0100   
9717  PT-P2AY    1  scz_swe6_eur   19    6898681    7103542     3   64.8900   
9718  PT-P2B1    1  scz_swe6_eur    1  102667388  102846147     1   98.9900   
9719  PT-P2BA    1  scz_swe6_eur    8   13285702   13417869     1   69.9800   
9720  PT-P2BE    1  scz_swe6_eur   13   84559815   84669950     1   18.6900   
9721  PT-P2BG    1  scz_swe6_eur   15   32018731   32620127     3   61.9050   
9722  PT-P2BI    1  scz_swe6_eur   14   35398428   35624831     3   40.2900   

      SITES  PHE  NSEG        KB     KBAVG   CNV_LEN  
0        86    1     1   101.080   101.080   101.080  
1        41    1     1   499.114   499.114   499.114  
2        55    1     1   136.615   136.615   136.615  
3       113    1     1   244.253   244.253   244.253  
4       100    1     1   137.559   137.559   137.559  
5       934    1     1  1191.880  1191.880  1191.878  
6       623    1     1  1236.310  1236.310  1236.306  
7       133    1     1   237.448   237.448   237.448  
8       223    1     1   263.118   263.118   263.118  
9        62    1     2  1548.610   774.303   168.521  
10      757    1     2  1548.610   774.303  1380.084  
11      110    1     2   700.260   350.130   132.210  
12      305    1     2   700.260   350.130   568.050  
13      179    1     1   423.322   423.322   423.322  
14     1204    1     1  2011.120  2011.120  2011.121  
15      165    1     5  2102.920   420.584   426.650  
16       84    1     5  2102.920   420.584   193.342  
17       49    1     5  2102.920   420.584   841.612  
18       34    1     5  2102.920   420.584   348.567  
19       68    1     5  2102.920   420.584   292.751  
20      106    1     3   775.884   258.628   185.713  
21      342    1     3   775.884   258.628   370.653  
22       80    1     3   775.884   258.628   219.518  
23       81    1     2   413.028   206.514   103.338  
24      276    1     2   413.028   206.514   309.690  
25       30    1     6  3208.220   534.704   140.140  
26       48    1     6  3208.220   534.704   590.237  
27       65    1     6  3208.220   534.704  1276.586  
28      111    1     6  3208.220   534.704   962.967  
29       18    1     6  3208.220   534.704   120.001  
...     ...  ...   ...       ...       ...       ...  
9693    101    0     2   682.496   341.248   323.282  
9694    322    0     1  1095.010  1095.010  1095.008  
9695     39    0     1   159.219   159.219   159.219  
9696     20    0     1   112.088   112.088   112.088  
9697     20    0     1   108.787   108.787   108.787  
9698     27    0     2   230.578   115.289   117.251  
9699     18    0     2   230.578   115.289   113.327  
9700     35    0     1   110.247   110.247   110.247  
9701     88    0     3   548.366   182.789   267.956  
9702     24    0     3   548.366   182.789   105.535  
9703     46    0     3   548.366   182.789   174.875  
9704    164    0     1   282.445   282.445   282.445  
9705     41    0     1   102.092   102.092   102.092  
9706     38    0     1   230.248   230.248   230.248  
9707     17    0     2  2361.620  1180.810  2112.029  
9708     37    0     2  2361.620  1180.810   249.595  
9709     17    0     1   108.147   108.147   108.147  
9710     58    0     2   400.413   200.207   269.317  
9711     25    0     2   400.413   200.207   131.096  
9712     40    0     1   196.187   196.187   196.187  
9713    124    0     1   516.084   516.084   516.084  
9714     75    0     2   360.440   180.220   187.591  
9715     20    0     2   360.440   180.220   172.849  
9716     50    0     2   518.656   259.328   313.795  
9717     66    0     2   518.656   259.328   204.861  
9718     41    0     1   178.759   178.759   178.759  
9719     52    0     1   132.167   132.167   132.167  
9720     21    0     1   110.135   110.135   110.135  
9721    108    0     1   601.396   601.396   601.396  
9722     36    0     1   226.403   226.403   226.403  

[9723 rows x 14 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_indiv2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_cluster_cnv</span><span class="p">,</span> <span class="n">sw_indiv</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">sw_indiv2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>           FID  IID            tr   CHR          BP1          BP2  TYPE  \
0      PT-BPTP    1  scz_s234_eur   7.0    9128802.0    9229882.0   1.0   
1      PT-BPAI    1  scz_s234_eur  16.0   18228118.0   18727232.0   3.0   
2      PT-BSLJ    1  scz_s234_eur   1.0   16869363.0   17005978.0   3.0   
3      PT-BQP5    1  scz_s234_eur  16.0   18830938.0   19075191.0   3.0   
4      PT-BP9I    1  scz_s234_eur  21.0   37481955.0   37619514.0   4.0   
5      PT-BQGK    1  scz_s234_eur  15.0   97984319.0   99176197.0   3.0   
6      PT-BSRL    1  scz_s234_eur  11.0   54773893.0   56010199.0   3.0   
7      PT-BPTX    1  scz_s234_eur   6.0  119714337.0  119951785.0   1.0   
8      PT-BPYW    1  scz_s234_eur   9.0   11919831.0   12182949.0   1.0   
9      PT-BRL3    1  scz_s234_eur  16.0   15072787.0   15241308.0   3.0   
10     PT-BRL3    1  scz_s234_eur  22.0   23689983.0   25070067.0   3.0   
11     PT-BQ15    1  scz_s234_eur   7.0  125640231.0  125772441.0   1.0   
12     PT-BQ15    1  scz_s234_eur  15.0   22673399.0   23241449.0   3.0   
13     PT-BRLU    1  scz_s234_eur  22.0   16864898.0   17288220.0   3.0   
14     PT-BQYE    1  scz_s234_eur   7.0   88150798.0   90161919.0   3.0   
15     PT-BQ64    1  scz_s234_eur   6.0   57656301.0   58082951.0   3.0   
16     PT-BQ64    1  scz_s234_eur   6.0   61930020.0   62123362.0   3.0   
17     PT-BQ64    1  scz_s234_eur   9.0   45368770.0   46210382.0   1.0   
18     PT-BQ64    1  scz_s234_eur   9.0   68837844.0   69186411.0   1.0   
19     PT-BQ64    1  scz_s234_eur   9.0   69685271.0   69978022.0   1.0   
20     PT-BSY2    1  scz_s234_eur   1.0  248249108.0  248434821.0   3.0   
21     PT-BSY2    1  scz_s234_eur  11.0  134348915.0  134719568.0   3.0   
22     PT-BSY2    1  scz_s234_eur  17.0   26835922.0   27055440.0   3.0   
23     PT-BRMS    1  scz_s234_eur   4.0  181479865.0  181583203.0   3.0   
24     PT-BRMS    1  scz_s234_eur  22.0   33538320.0   33848010.0   3.0   
25     PT-BRLT    1  scz_s234_eur   1.0  104163499.0  104303639.0   4.0   
26     PT-BRLT    1  scz_s234_eur   9.0   41475106.0   42065343.0   3.0   
27     PT-BRLT    1  scz_s234_eur   9.0   45054940.0   46331526.0   3.0   
28     PT-BRLT    1  scz_s234_eur   9.0   68995234.0   69958201.0   3.0   
29     PT-BRLT    1  scz_s234_eur  10.0   88997299.0   89117300.0   4.0   
...        ...  ...           ...   ...          ...          ...   ...   
14225  PT-OPXC    1           NaN   NaN          NaN          NaN   NaN   
14226  PT-OPF8    1           NaN   NaN          NaN          NaN   NaN   
14227  PT-OPF6    1           NaN   NaN          NaN          NaN   NaN   
14228  PT-ONZ5    1           NaN   NaN          NaN          NaN   NaN   
14229  PT-ONVU    1           NaN   NaN          NaN          NaN   NaN   
14230  PT-OPMI    1           NaN   NaN          NaN          NaN   NaN   
14231  PT-ONVB    1           NaN   NaN          NaN          NaN   NaN   
14232  PT-OP8J    1           NaN   NaN          NaN          NaN   NaN   
14233  PT-OOR5    1           NaN   NaN          NaN          NaN   NaN   
14234  PT-OPDG    1           NaN   NaN          NaN          NaN   NaN   
14235  PT-OQ2I    1           NaN   NaN          NaN          NaN   NaN   
14236  PT-OOQS    1           NaN   NaN          NaN          NaN   NaN   
14237  PT-P2AD    1           NaN   NaN          NaN          NaN   NaN   
14238  PT-OOWU    1           NaN   NaN          NaN          NaN   NaN   
14239  PT-ONJH    1           NaN   NaN          NaN          NaN   NaN   
14240  PT-OP98    1           NaN   NaN          NaN          NaN   NaN   
14241  PT-OO1T    1           NaN   NaN          NaN          NaN   NaN   
14242  PT-ONTV    1           NaN   NaN          NaN          NaN   NaN   
14243  PT-8W4J    1           NaN   NaN          NaN          NaN   NaN   
14244  PT-8K2E    1           NaN   NaN          NaN          NaN   NaN   
14245  PT-M82Q    1           NaN   NaN          NaN          NaN   NaN   
14246  PT-M8EA    1           NaN   NaN          NaN          NaN   NaN   
14247  PT-M8A2    1           NaN   NaN          NaN          NaN   NaN   
14248  PT-M7ND    1           NaN   NaN          NaN          NaN   NaN   
14249  PT-M7WL    1           NaN   NaN          NaN          NaN   NaN   
14250  PT-8K3C    1           NaN   NaN          NaN          NaN   NaN   
14251  PT-COVS    1           NaN   NaN          NaN          NaN   NaN   
14252  PT-CP7D    1           NaN   NaN          NaN          NaN   NaN   
14253  PT-CP85    1           NaN   NaN          NaN          NaN   NaN   
14254  PT-CP1D    1           NaN   NaN          NaN          NaN   NaN   

         SCORE   SITES  PHE  NSEG        KB     KBAVG  
0       65.010    86.0    2     1   101.080   101.080  
1       13.130    41.0    2     1   499.114   499.114  
2       38.680    55.0    2     1   136.615   136.615  
3       97.890   113.0    2     1   244.253   244.253  
4      147.000   100.0    2     1   137.559   137.559  
5      811.310   934.0    2     1  1191.880  1191.880  
6      436.685   623.0    2     1  1236.310  1236.310  
7      171.460   133.0    2     1   237.448   237.448  
8      313.660   223.0    2     1   263.118   263.118  
9       41.440    62.0    2     2  1548.610   774.303  
10     322.415   757.0    2     2  1548.610   774.303  
11     130.600   110.0    2     2   700.260   350.130  
12     168.930   305.0    2     2   700.260   350.130  
13     116.750   179.0    2     1   423.322   423.322  
14      83.042  1204.0    2     1  2011.120  2011.120  
15     148.110   165.0    2     5  2102.920   420.584  
16      79.750    84.0    2     5  2102.920   420.584  
17      14.430    49.0    2     5  2102.920   420.584  
18      17.900    34.0    2     5  2102.920   420.584  
19      33.220    68.0    2     5  2102.920   420.584  
20     112.950   106.0    2     3   775.884   258.628  
21     254.700   342.0    2     3   775.884   258.628  
22      49.860    80.0    2     3   775.884   258.628  
23     141.520    81.0    2     2   413.028   206.514  
24     340.310   276.0    2     2   413.028   206.514  
25      15.560    30.0    2     6  3208.220   534.704  
26      11.780    48.0    2     6  3208.220   534.704  
27      11.260    65.0    2     6  3208.220   534.704  
28      19.130   111.0    2     6  3208.220   534.704  
29      11.070    18.0    2     6  3208.220   534.704  
...        ...     ...  ...   ...       ...       ...  
14225      NaN     NaN    1     0     0.000     0.000  
14226      NaN     NaN    1     0     0.000     0.000  
14227      NaN     NaN    1     0     0.000     0.000  
14228      NaN     NaN    1     0     0.000     0.000  
14229      NaN     NaN    1     0     0.000     0.000  
14230      NaN     NaN    1     0     0.000     0.000  
14231      NaN     NaN    1     0     0.000     0.000  
14232      NaN     NaN    1     0     0.000     0.000  
14233      NaN     NaN    1     0     0.000     0.000  
14234      NaN     NaN    1     0     0.000     0.000  
14235      NaN     NaN    1     0     0.000     0.000  
14236      NaN     NaN    1     0     0.000     0.000  
14237      NaN     NaN    1     0     0.000     0.000  
14238      NaN     NaN    1     0     0.000     0.000  
14239      NaN     NaN    1     0     0.000     0.000  
14240      NaN     NaN    1     0     0.000     0.000  
14241      NaN     NaN    1     0     0.000     0.000  
14242      NaN     NaN    1     0     0.000     0.000  
14243      NaN     NaN    1     0     0.000     0.000  
14244      NaN     NaN    2     0     0.000     0.000  
14245      NaN     NaN    2     0     0.000     0.000  
14246      NaN     NaN    2     0     0.000     0.000  
14247      NaN     NaN    2     0     0.000     0.000  
14248      NaN     NaN    2     0     0.000     0.000  
14249      NaN     NaN    2     0     0.000     0.000  
14250      NaN     NaN    2     0     0.000     0.000  
14251      NaN     NaN    2     0     0.000     0.000  
14252      NaN     NaN    2     0     0.000     0.000  
14253      NaN     NaN    2     0     0.000     0.000  
14254      NaN     NaN    2     0     0.000     0.000  

[14255 rows x 13 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Number of Cases and Controls, 2: cases, 1: controls</span>
<span class="n">sw_fam</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Case-Ctrl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Case-Ctrl
1    5917
2    4719
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># sex by status</span>
<span class="n">sex_by_casectrl</span> <span class="o">=</span> <span class="n">sw_fam</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Case-Ctrl&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">sex_by_casectrl</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Case-Ctrl  sex
1          1      3034
           2      2883
2          1      2826
           2      1893
dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prp_male_case</span> <span class="o">=</span> <span class="n">sex_by_casectrl</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">sex_by_casectrl</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sex_by_casectrl</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_male_case</span><span class="p">)</span>
<span class="n">prp_male_ctrl</span> <span class="o">=</span> <span class="n">sex_by_casectrl</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">sex_by_casectrl</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sex_by_casectrl</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_male_ctrl</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.598855689765
0.512759844516
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>tr            PHE
scz_s234_eur  1      2137
              2      1847
scz_swe1_eur  1       206
              2       207
scz_swe5_eur  1      2456
              2      1674
scz_swe6_eur  1      1118
              2       991
dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># &quot;NSEG&quot;: number of CNV in each subject</span>
<span class="n">mean_cnv_case_sw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe1_eur&quot;</span><span class="p">]</span>
                            <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">mean_cnv_ctrl_sw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe1_eur&quot;</span><span class="p">]</span>
                            <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mean_cnv_case_sw1</span><span class="p">,</span> <span class="n">mean_cnv_ctrl_sw1</span><span class="p">)</span>
<span class="n">mean_cnv_case_sw234</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_s234_eur&quot;</span><span class="p">]</span>
                              <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">mean_cnv_ctrl_sw234</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_s234_eur&quot;</span><span class="p">]</span>
                              <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mean_cnv_case_sw234</span><span class="p">,</span> <span class="n">mean_cnv_ctrl_sw234</span><span class="p">)</span>
<span class="n">mean_cnv_case_sw56</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe5_eur&quot;</span><span class="p">]</span>
                            <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                            <span class="o">+</span> <span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe6_eur&quot;</span><span class="p">]</span>
                            <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">mean_cnv_ctrl_sw56</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="p">(</span><span class="s2">&quot;scz_swe5_eur&quot;</span><span class="p">)]</span>
                             <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                            <span class="o">+</span> <span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe6_eur&quot;</span><span class="p">]</span>
                            <span class="p">[</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mean_cnv_case_sw56</span><span class="p">,</span> <span class="n">mean_cnv_ctrl_sw56</span><span class="p">)</span>
<span class="n">mean_cnv_case</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">mean_cnv_ctrl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_cluster_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">mean_cnv_case</span><span class="p">,</span> <span class="n">mean_cnv_ctrl</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1.05797101449 0.844660194175
1.2360584732 1.20870379036
0.758348968105 0.683547845551
0.958465776648 0.878823728241
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prp_del_case</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">prp_del_ctrl</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="c1"># 1 is deletion, 3 is duplication</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_case</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_case</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_ctrl</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_ctrl</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.38182622153437984
0.38211538461538463
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prp_del_case_sw1</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe1_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">prp_del_ctrl_sw1</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe1_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_case_sw1</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_case_sw1</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_ctrl_sw1</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_ctrl_sw1</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.4794520547945205
0.39080459770114945
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prp_del_case_sw234</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_s234_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">prp_del_ctrl_sw234</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_s234_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_case_sw234</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_case_sw234</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_ctrl_sw234</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_ctrl_sw234</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.3587385019710907
0.36624080526519553
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prp_del_case_sw56</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe5_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe6_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">prp_del_ctrl_sw56</span> <span class="o">=</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe5_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;TYPE&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe6_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_case_sw56</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_case_sw56</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">prp_del_ctrl_sw56</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prp_del_ctrl_sw56</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.39864355689525244
0.4088235294117647
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">median_cnv_len_case</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">median_cnv_len_ctrl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_case</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_ctrl</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>188.797
182.711
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">median_cnv_len_case_sw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe1_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">median_cnv_len_ctrl_sw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe1_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_case_sw1</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_ctrl_sw1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>178.016
181.313
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">median_cnv_len_case_sw234</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_s234_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">median_cnv_len_ctrl_sw234</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_s234_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_case_sw234</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_ctrl_sw234</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>188.213
182.211
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">median_cnv_len_case_sw56</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe5_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe6_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">median_cnv_len_ctrl_sw56</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe5_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;CNV_LEN&quot;</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">sw_cluster_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe6_eur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_case_sw56</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">median_cnv_len_ctrl_sw56</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>191.854
182.507
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Figure-3">Figure 3<a class="anchor-link" href="#Figure-3">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_cluster_indiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_cluster</span><span class="p">,</span> <span class="n">sw_indiv</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">])</span>
<span class="n">sw_cluster_indiv_cnv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_cluster_indiv</span><span class="p">,</span> <span class="n">sw_cnv</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">])</span>
<span class="n">sw_cluster_indiv_cnv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sw_cluster_indiv_cnv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># sw_cluster_indiv_cnv</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># One line for each individual, with CNV or without CNV</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FID, IID, PHE, NSEG, TYPE, tr</span>
<span class="s1">FROM sw_cluster_indiv_cnv</span>
<span class="s1">GROUP BY FID, IID, PHE, NSEG, tr</span>
<span class="s1">ORDER BY PHE DESC</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="c1"># FIXME: needs to combine TYPE</span>
<span class="n">sw_indiv_adj</span> <span class="o">=</span> <span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="c1"># sw_indiv_adj = sw_indiv_adj.rename(columns={&quot;PHE_NEW&quot;: &quot;PHE&quot;})</span>
<span class="n">sw_indiv_adj</span><span class="p">[</span><span class="s2">&quot;hasCNV&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sw_indiv_adj</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sw_indiv_adj</span><span class="p">[</span><span class="s2">&quot;tr_adj&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sw_indiv_adj</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_swe1_eur&quot;</span> 
                                <span class="k">else</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;tr&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;scz_s234_eur&quot;</span> <span class="k">else</span> <span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sw_indiv_adj</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[17]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FID</th>
      <th>IID</th>
      <th>PHE</th>
      <th>NSEG</th>
      <th>TYPE</th>
      <th>tr</th>
      <th>hasCNV</th>
      <th>tr_adj</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PT-1RTZ</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PT-1RU7</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PT-1RUJ</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PT-1RUO</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PT-1RV2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PT-1RV4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PT-1RVE</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PT-1RVH</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PT-1RVS</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PT-1RW3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>PT-1RW7</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>PT-1RWF</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PT-1RZG</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PT-1RZK</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PT-1RZM</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>PT-1RZN</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PT-1RZO</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PT-1RZP</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PT-1RZS</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>PT-1RZV</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>PT-1RZW</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>PT-1RZY</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>22</th>
      <td>PT-1RZZ</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>PT-1S11</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>PT-1S16</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25</th>
      <td>PT-1S18</td>
      <td>1</td>
      <td>1</td>
      <td>11</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>PT-1S19</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PT-1S1C</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>PT-1S1D</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe1_eur</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>29</th>
      <td>PT-1S1E</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe1_eur</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10606</th>
      <td>PT-P29X</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10607</th>
      <td>PT-P2A1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10608</th>
      <td>PT-P2A5</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10609</th>
      <td>PT-P2A6</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10610</th>
      <td>PT-P2A7</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10611</th>
      <td>PT-P2A9</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10612</th>
      <td>PT-P2AA</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10613</th>
      <td>PT-P2AB</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10614</th>
      <td>PT-P2AD</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10615</th>
      <td>PT-P2AE</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10616</th>
      <td>PT-P2AJ</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>3.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10617</th>
      <td>PT-P2AM</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10618</th>
      <td>PT-P2AN</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10619</th>
      <td>PT-P2AP</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10620</th>
      <td>PT-P2AU</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10621</th>
      <td>PT-P2AV</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10622</th>
      <td>PT-P2AW</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10623</th>
      <td>PT-P2AX</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10624</th>
      <td>PT-P2AY</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>3.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10625</th>
      <td>PT-P2B1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10626</th>
      <td>PT-P2B2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10627</th>
      <td>PT-P2B4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10628</th>
      <td>PT-P2BA</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10629</th>
      <td>PT-P2BC</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10630</th>
      <td>PT-P2BD</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10631</th>
      <td>PT-P2BE</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10632</th>
      <td>PT-P2BG</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10633</th>
      <td>PT-P2BH</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10634</th>
      <td>PT-P2BI</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10635</th>
      <td>PT-P2BL</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>scz_swe6_eur</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>10636 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># all CNVs logistic regression</span>
<span class="n">indep_cols</span> <span class="o">=</span> <span class="n">sw_indiv_adj</span><span class="p">[[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">,</span> <span class="s2">&quot;tr_adj&quot;</span><span class="p">]]</span>
<span class="n">all_CNV_logit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">sw_indiv_adj</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">],</span> <span class="n">indep_cols</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">all_CNV_logit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">params</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: 0.685450
         Iterations 4
                           Logit Regression Results                           
==============================================================================
Dep. Variable:                    PHE   No. Observations:                10636
Model:                          Logit   Df Residuals:                    10634
Method:                           MLE   Df Model:                            1
Date:                Wed, 19 Jul 2017   Pseudo R-squ.:                0.001951
Time:                        17:37:32   Log-Likelihood:                -7290.4
converged:                       True   LL-Null:                       -7304.7
                                        LLR p-value:                 9.354e-08
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
NSEG           0.0634      0.018      3.543      0.000       0.028       0.098
tr_adj        -0.1124      0.010    -11.813      0.000      -0.131      -0.094
==============================================================================
NSEG      1.065444
tr_adj    0.893694
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># all CNV OR, Fisher&#39;s test</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT PHE, TYPE, count(FID)</span>
<span class="s1">FROM sw_indiv_adj</span>
<span class="s1">GROUP BY PHE, TYPE</span>
<span class="s1">ORDER BY count(FID) DESC</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">sw_indiv_adj</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;PHE&quot;</span><span class="p">,</span> <span class="s2">&quot;TYPE&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="n">stats</span><span class="o">.</span><span class="n">fisher_exact</span><span class="p">([[</span><span class="mi">1659</span><span class="o">+</span><span class="mi">1083</span><span class="o">+</span><span class="mi">50</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1969</span><span class="o">+</span><span class="mi">1288</span><span class="o">+</span><span class="mi">46</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1922</span><span class="p">,</span> <span class="mi">2610</span><span class="p">]])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>   PHE  TYPE  count(FID)
0    0   NaN        2610
1    0   3.0        1969
2    1   NaN        1922
3    1   3.0        1659
4    0   1.0        1288
5    1   1.0        1083
6    1   4.0          50
7    0   4.0          46
8    1   0.0           5
9    0   0.0           4
PHE  TYPE
0    0.0        4
     1.0     1288
     3.0     1969
     4.0       46
1    0.0        5
     1.0     1083
     3.0     1659
     4.0       50
dtype: int64
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1.1485380709477924</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_cluster_cnv_indiv</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[20]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FID</th>
      <th>IID</th>
      <th>tr</th>
      <th>CHR</th>
      <th>BP1</th>
      <th>BP2</th>
      <th>TYPE</th>
      <th>SCORE</th>
      <th>SITES</th>
      <th>PHE</th>
      <th>NSEG</th>
      <th>KB</th>
      <th>KBAVG</th>
      <th>CNV_LEN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PT-BPTP</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>7</td>
      <td>9128802</td>
      <td>9229882</td>
      <td>1</td>
      <td>65.0100</td>
      <td>86</td>
      <td>1</td>
      <td>1</td>
      <td>101.080</td>
      <td>101.080</td>
      <td>101.080</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PT-BPAI</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>16</td>
      <td>18228118</td>
      <td>18727232</td>
      <td>3</td>
      <td>13.1300</td>
      <td>41</td>
      <td>1</td>
      <td>1</td>
      <td>499.114</td>
      <td>499.114</td>
      <td>499.114</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PT-BSLJ</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>1</td>
      <td>16869363</td>
      <td>17005978</td>
      <td>3</td>
      <td>38.6800</td>
      <td>55</td>
      <td>1</td>
      <td>1</td>
      <td>136.615</td>
      <td>136.615</td>
      <td>136.615</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PT-BQP5</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>16</td>
      <td>18830938</td>
      <td>19075191</td>
      <td>3</td>
      <td>97.8900</td>
      <td>113</td>
      <td>1</td>
      <td>1</td>
      <td>244.253</td>
      <td>244.253</td>
      <td>244.253</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PT-BP9I</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>21</td>
      <td>37481955</td>
      <td>37619514</td>
      <td>4</td>
      <td>147.0000</td>
      <td>100</td>
      <td>1</td>
      <td>1</td>
      <td>137.559</td>
      <td>137.559</td>
      <td>137.559</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PT-BQGK</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>15</td>
      <td>97984319</td>
      <td>99176197</td>
      <td>3</td>
      <td>811.3100</td>
      <td>934</td>
      <td>1</td>
      <td>1</td>
      <td>1191.880</td>
      <td>1191.880</td>
      <td>1191.878</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PT-BSRL</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>11</td>
      <td>54773893</td>
      <td>56010199</td>
      <td>3</td>
      <td>436.6850</td>
      <td>623</td>
      <td>1</td>
      <td>1</td>
      <td>1236.310</td>
      <td>1236.310</td>
      <td>1236.306</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PT-BPTX</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>6</td>
      <td>119714337</td>
      <td>119951785</td>
      <td>1</td>
      <td>171.4600</td>
      <td>133</td>
      <td>1</td>
      <td>1</td>
      <td>237.448</td>
      <td>237.448</td>
      <td>237.448</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PT-BPYW</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>9</td>
      <td>11919831</td>
      <td>12182949</td>
      <td>1</td>
      <td>313.6600</td>
      <td>223</td>
      <td>1</td>
      <td>1</td>
      <td>263.118</td>
      <td>263.118</td>
      <td>263.118</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PT-BRL3</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>16</td>
      <td>15072787</td>
      <td>15241308</td>
      <td>3</td>
      <td>41.4400</td>
      <td>62</td>
      <td>1</td>
      <td>2</td>
      <td>1548.610</td>
      <td>774.303</td>
      <td>168.521</td>
    </tr>
    <tr>
      <th>10</th>
      <td>PT-BRL3</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>22</td>
      <td>23689983</td>
      <td>25070067</td>
      <td>3</td>
      <td>322.4150</td>
      <td>757</td>
      <td>1</td>
      <td>2</td>
      <td>1548.610</td>
      <td>774.303</td>
      <td>1380.084</td>
    </tr>
    <tr>
      <th>11</th>
      <td>PT-BQ15</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>7</td>
      <td>125640231</td>
      <td>125772441</td>
      <td>1</td>
      <td>130.6000</td>
      <td>110</td>
      <td>1</td>
      <td>2</td>
      <td>700.260</td>
      <td>350.130</td>
      <td>132.210</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PT-BQ15</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>15</td>
      <td>22673399</td>
      <td>23241449</td>
      <td>3</td>
      <td>168.9300</td>
      <td>305</td>
      <td>1</td>
      <td>2</td>
      <td>700.260</td>
      <td>350.130</td>
      <td>568.050</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PT-BRLU</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>22</td>
      <td>16864898</td>
      <td>17288220</td>
      <td>3</td>
      <td>116.7500</td>
      <td>179</td>
      <td>1</td>
      <td>1</td>
      <td>423.322</td>
      <td>423.322</td>
      <td>423.322</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PT-BQYE</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>7</td>
      <td>88150798</td>
      <td>90161919</td>
      <td>3</td>
      <td>83.0420</td>
      <td>1204</td>
      <td>1</td>
      <td>1</td>
      <td>2011.120</td>
      <td>2011.120</td>
      <td>2011.121</td>
    </tr>
    <tr>
      <th>15</th>
      <td>PT-BQ64</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>6</td>
      <td>57656301</td>
      <td>58082951</td>
      <td>3</td>
      <td>148.1100</td>
      <td>165</td>
      <td>1</td>
      <td>5</td>
      <td>2102.920</td>
      <td>420.584</td>
      <td>426.650</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PT-BQ64</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>6</td>
      <td>61930020</td>
      <td>62123362</td>
      <td>3</td>
      <td>79.7500</td>
      <td>84</td>
      <td>1</td>
      <td>5</td>
      <td>2102.920</td>
      <td>420.584</td>
      <td>193.342</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PT-BQ64</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>9</td>
      <td>45368770</td>
      <td>46210382</td>
      <td>1</td>
      <td>14.4300</td>
      <td>49</td>
      <td>1</td>
      <td>5</td>
      <td>2102.920</td>
      <td>420.584</td>
      <td>841.612</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PT-BQ64</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>9</td>
      <td>68837844</td>
      <td>69186411</td>
      <td>1</td>
      <td>17.9000</td>
      <td>34</td>
      <td>1</td>
      <td>5</td>
      <td>2102.920</td>
      <td>420.584</td>
      <td>348.567</td>
    </tr>
    <tr>
      <th>19</th>
      <td>PT-BQ64</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>9</td>
      <td>69685271</td>
      <td>69978022</td>
      <td>1</td>
      <td>33.2200</td>
      <td>68</td>
      <td>1</td>
      <td>5</td>
      <td>2102.920</td>
      <td>420.584</td>
      <td>292.751</td>
    </tr>
    <tr>
      <th>20</th>
      <td>PT-BSY2</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>1</td>
      <td>248249108</td>
      <td>248434821</td>
      <td>3</td>
      <td>112.9500</td>
      <td>106</td>
      <td>1</td>
      <td>3</td>
      <td>775.884</td>
      <td>258.628</td>
      <td>185.713</td>
    </tr>
    <tr>
      <th>21</th>
      <td>PT-BSY2</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>11</td>
      <td>134348915</td>
      <td>134719568</td>
      <td>3</td>
      <td>254.7000</td>
      <td>342</td>
      <td>1</td>
      <td>3</td>
      <td>775.884</td>
      <td>258.628</td>
      <td>370.653</td>
    </tr>
    <tr>
      <th>22</th>
      <td>PT-BSY2</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>17</td>
      <td>26835922</td>
      <td>27055440</td>
      <td>3</td>
      <td>49.8600</td>
      <td>80</td>
      <td>1</td>
      <td>3</td>
      <td>775.884</td>
      <td>258.628</td>
      <td>219.518</td>
    </tr>
    <tr>
      <th>23</th>
      <td>PT-BRMS</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>4</td>
      <td>181479865</td>
      <td>181583203</td>
      <td>3</td>
      <td>141.5200</td>
      <td>81</td>
      <td>1</td>
      <td>2</td>
      <td>413.028</td>
      <td>206.514</td>
      <td>103.338</td>
    </tr>
    <tr>
      <th>24</th>
      <td>PT-BRMS</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>22</td>
      <td>33538320</td>
      <td>33848010</td>
      <td>3</td>
      <td>340.3100</td>
      <td>276</td>
      <td>1</td>
      <td>2</td>
      <td>413.028</td>
      <td>206.514</td>
      <td>309.690</td>
    </tr>
    <tr>
      <th>25</th>
      <td>PT-BRLT</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>1</td>
      <td>104163499</td>
      <td>104303639</td>
      <td>4</td>
      <td>15.5600</td>
      <td>30</td>
      <td>1</td>
      <td>6</td>
      <td>3208.220</td>
      <td>534.704</td>
      <td>140.140</td>
    </tr>
    <tr>
      <th>26</th>
      <td>PT-BRLT</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>9</td>
      <td>41475106</td>
      <td>42065343</td>
      <td>3</td>
      <td>11.7800</td>
      <td>48</td>
      <td>1</td>
      <td>6</td>
      <td>3208.220</td>
      <td>534.704</td>
      <td>590.237</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PT-BRLT</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>9</td>
      <td>45054940</td>
      <td>46331526</td>
      <td>3</td>
      <td>11.2600</td>
      <td>65</td>
      <td>1</td>
      <td>6</td>
      <td>3208.220</td>
      <td>534.704</td>
      <td>1276.586</td>
    </tr>
    <tr>
      <th>28</th>
      <td>PT-BRLT</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>9</td>
      <td>68995234</td>
      <td>69958201</td>
      <td>3</td>
      <td>19.1300</td>
      <td>111</td>
      <td>1</td>
      <td>6</td>
      <td>3208.220</td>
      <td>534.704</td>
      <td>962.967</td>
    </tr>
    <tr>
      <th>29</th>
      <td>PT-BRLT</td>
      <td>1</td>
      <td>scz_s234_eur</td>
      <td>10</td>
      <td>88997299</td>
      <td>89117300</td>
      <td>4</td>
      <td>11.0700</td>
      <td>18</td>
      <td>1</td>
      <td>6</td>
      <td>3208.220</td>
      <td>534.704</td>
      <td>120.001</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9693</th>
      <td>PT-P29A</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>12</td>
      <td>6079058</td>
      <td>6402340</td>
      <td>3</td>
      <td>105.2600</td>
      <td>101</td>
      <td>0</td>
      <td>2</td>
      <td>682.496</td>
      <td>341.248</td>
      <td>323.282</td>
    </tr>
    <tr>
      <th>9694</th>
      <td>PT-P29F</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>6</td>
      <td>169021311</td>
      <td>170116319</td>
      <td>1</td>
      <td>83.4267</td>
      <td>322</td>
      <td>0</td>
      <td>1</td>
      <td>1095.010</td>
      <td>1095.010</td>
      <td>1095.008</td>
    </tr>
    <tr>
      <th>9695</th>
      <td>PT-P29L</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>15</td>
      <td>94242985</td>
      <td>94402204</td>
      <td>3</td>
      <td>46.9200</td>
      <td>39</td>
      <td>0</td>
      <td>1</td>
      <td>159.219</td>
      <td>159.219</td>
      <td>159.219</td>
    </tr>
    <tr>
      <th>9696</th>
      <td>PT-P29N</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>3</td>
      <td>35826707</td>
      <td>35938795</td>
      <td>3</td>
      <td>33.5400</td>
      <td>20</td>
      <td>0</td>
      <td>1</td>
      <td>112.088</td>
      <td>112.088</td>
      <td>112.088</td>
    </tr>
    <tr>
      <th>9697</th>
      <td>PT-P29P</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>12</td>
      <td>19469320</td>
      <td>19578107</td>
      <td>3</td>
      <td>15.8100</td>
      <td>20</td>
      <td>0</td>
      <td>1</td>
      <td>108.787</td>
      <td>108.787</td>
      <td>108.787</td>
    </tr>
    <tr>
      <th>9698</th>
      <td>PT-P29U</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>2</td>
      <td>110863095</td>
      <td>110980346</td>
      <td>3</td>
      <td>43.9400</td>
      <td>27</td>
      <td>0</td>
      <td>2</td>
      <td>230.578</td>
      <td>115.289</td>
      <td>117.251</td>
    </tr>
    <tr>
      <th>9699</th>
      <td>PT-P29U</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>13</td>
      <td>58977716</td>
      <td>59091043</td>
      <td>3</td>
      <td>32.8800</td>
      <td>18</td>
      <td>0</td>
      <td>2</td>
      <td>230.578</td>
      <td>115.289</td>
      <td>113.327</td>
    </tr>
    <tr>
      <th>9700</th>
      <td>PT-P2A5</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>8</td>
      <td>16416711</td>
      <td>16526958</td>
      <td>1</td>
      <td>83.2600</td>
      <td>35</td>
      <td>0</td>
      <td>1</td>
      <td>110.247</td>
      <td>110.247</td>
      <td>110.247</td>
    </tr>
    <tr>
      <th>9701</th>
      <td>PT-P2A6</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>2</td>
      <td>35819686</td>
      <td>36087642</td>
      <td>1</td>
      <td>150.2800</td>
      <td>88</td>
      <td>0</td>
      <td>3</td>
      <td>548.366</td>
      <td>182.789</td>
      <td>267.956</td>
    </tr>
    <tr>
      <th>9702</th>
      <td>PT-P2A6</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>3</td>
      <td>109621818</td>
      <td>109727353</td>
      <td>1</td>
      <td>49.3600</td>
      <td>24</td>
      <td>0</td>
      <td>3</td>
      <td>548.366</td>
      <td>182.789</td>
      <td>105.535</td>
    </tr>
    <tr>
      <th>9703</th>
      <td>PT-P2A6</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>7</td>
      <td>9283620</td>
      <td>9458495</td>
      <td>1</td>
      <td>77.9600</td>
      <td>46</td>
      <td>0</td>
      <td>3</td>
      <td>548.366</td>
      <td>182.789</td>
      <td>174.875</td>
    </tr>
    <tr>
      <th>9704</th>
      <td>PT-P2A9</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>9</td>
      <td>312134</td>
      <td>594579</td>
      <td>3</td>
      <td>184.1000</td>
      <td>164</td>
      <td>0</td>
      <td>1</td>
      <td>282.445</td>
      <td>282.445</td>
      <td>282.445</td>
    </tr>
    <tr>
      <th>9705</th>
      <td>PT-P2AB</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>9</td>
      <td>138182186</td>
      <td>138284278</td>
      <td>3</td>
      <td>37.6200</td>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>102.092</td>
      <td>102.092</td>
      <td>102.092</td>
    </tr>
    <tr>
      <th>9706</th>
      <td>PT-P2AE</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>7</td>
      <td>110892226</td>
      <td>111122474</td>
      <td>1</td>
      <td>61.6700</td>
      <td>38</td>
      <td>0</td>
      <td>1</td>
      <td>230.248</td>
      <td>230.248</td>
      <td>230.248</td>
    </tr>
    <tr>
      <th>9707</th>
      <td>PT-P2AJ</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>2</td>
      <td>89620837</td>
      <td>91732866</td>
      <td>1</td>
      <td>17.2000</td>
      <td>17</td>
      <td>0</td>
      <td>2</td>
      <td>2361.620</td>
      <td>1180.810</td>
      <td>2112.029</td>
    </tr>
    <tr>
      <th>9708</th>
      <td>PT-P2AJ</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>3</td>
      <td>141835715</td>
      <td>142085310</td>
      <td>3</td>
      <td>46.8900</td>
      <td>37</td>
      <td>0</td>
      <td>2</td>
      <td>2361.620</td>
      <td>1180.810</td>
      <td>249.595</td>
    </tr>
    <tr>
      <th>9709</th>
      <td>PT-P2AM</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>12852872</td>
      <td>12961019</td>
      <td>1</td>
      <td>28.2800</td>
      <td>17</td>
      <td>0</td>
      <td>1</td>
      <td>108.147</td>
      <td>108.147</td>
      <td>108.147</td>
    </tr>
    <tr>
      <th>9710</th>
      <td>PT-P2AP</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>4</td>
      <td>12374586</td>
      <td>12643903</td>
      <td>3</td>
      <td>49.6900</td>
      <td>58</td>
      <td>0</td>
      <td>2</td>
      <td>400.413</td>
      <td>200.207</td>
      <td>269.317</td>
    </tr>
    <tr>
      <th>9711</th>
      <td>PT-P2AP</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>7</td>
      <td>110892226</td>
      <td>111023322</td>
      <td>1</td>
      <td>58.6300</td>
      <td>25</td>
      <td>0</td>
      <td>2</td>
      <td>400.413</td>
      <td>200.207</td>
      <td>131.096</td>
    </tr>
    <tr>
      <th>9712</th>
      <td>PT-P2AV</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>8</td>
      <td>78863442</td>
      <td>79059629</td>
      <td>1</td>
      <td>77.0800</td>
      <td>40</td>
      <td>0</td>
      <td>1</td>
      <td>196.187</td>
      <td>196.187</td>
      <td>196.187</td>
    </tr>
    <tr>
      <th>9713</th>
      <td>PT-P2AW</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>9</td>
      <td>120869313</td>
      <td>121385397</td>
      <td>3</td>
      <td>94.1350</td>
      <td>124</td>
      <td>0</td>
      <td>1</td>
      <td>516.084</td>
      <td>516.084</td>
      <td>516.084</td>
    </tr>
    <tr>
      <th>9714</th>
      <td>PT-P2AX</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>13</td>
      <td>43544964</td>
      <td>43732555</td>
      <td>3</td>
      <td>108.8700</td>
      <td>75</td>
      <td>0</td>
      <td>2</td>
      <td>360.440</td>
      <td>180.220</td>
      <td>187.591</td>
    </tr>
    <tr>
      <th>9715</th>
      <td>PT-P2AX</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>19</td>
      <td>43663086</td>
      <td>43835935</td>
      <td>1</td>
      <td>32.4500</td>
      <td>20</td>
      <td>0</td>
      <td>2</td>
      <td>360.440</td>
      <td>180.220</td>
      <td>172.849</td>
    </tr>
    <tr>
      <th>9716</th>
      <td>PT-P2AY</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>25447125</td>
      <td>25760920</td>
      <td>3</td>
      <td>41.0100</td>
      <td>50</td>
      <td>0</td>
      <td>2</td>
      <td>518.656</td>
      <td>259.328</td>
      <td>313.795</td>
    </tr>
    <tr>
      <th>9717</th>
      <td>PT-P2AY</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>19</td>
      <td>6898681</td>
      <td>7103542</td>
      <td>3</td>
      <td>64.8900</td>
      <td>66</td>
      <td>0</td>
      <td>2</td>
      <td>518.656</td>
      <td>259.328</td>
      <td>204.861</td>
    </tr>
    <tr>
      <th>9718</th>
      <td>PT-P2B1</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>1</td>
      <td>102667388</td>
      <td>102846147</td>
      <td>1</td>
      <td>98.9900</td>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>178.759</td>
      <td>178.759</td>
      <td>178.759</td>
    </tr>
    <tr>
      <th>9719</th>
      <td>PT-P2BA</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>8</td>
      <td>13285702</td>
      <td>13417869</td>
      <td>1</td>
      <td>69.9800</td>
      <td>52</td>
      <td>0</td>
      <td>1</td>
      <td>132.167</td>
      <td>132.167</td>
      <td>132.167</td>
    </tr>
    <tr>
      <th>9720</th>
      <td>PT-P2BE</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>13</td>
      <td>84559815</td>
      <td>84669950</td>
      <td>1</td>
      <td>18.6900</td>
      <td>21</td>
      <td>0</td>
      <td>1</td>
      <td>110.135</td>
      <td>110.135</td>
      <td>110.135</td>
    </tr>
    <tr>
      <th>9721</th>
      <td>PT-P2BG</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>15</td>
      <td>32018731</td>
      <td>32620127</td>
      <td>3</td>
      <td>61.9050</td>
      <td>108</td>
      <td>0</td>
      <td>1</td>
      <td>601.396</td>
      <td>601.396</td>
      <td>601.396</td>
    </tr>
    <tr>
      <th>9722</th>
      <td>PT-P2BI</td>
      <td>1</td>
      <td>scz_swe6_eur</td>
      <td>14</td>
      <td>35398428</td>
      <td>35624831</td>
      <td>3</td>
      <td>40.2900</td>
      <td>36</td>
      <td>0</td>
      <td>1</td>
      <td>226.403</td>
      <td>226.403</td>
      <td>226.403</td>
    </tr>
  </tbody>
</table>
<p>9723 rows × 14 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_cnv_indiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_cnv</span><span class="p">,</span> <span class="n">sw_indiv</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;IID&quot;</span><span class="p">])</span>
<span class="n">sw_cnv_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sw_cnv_indiv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># the occurrence of each CNV, no matter in cases or controls</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FID, CHR, BP1, BP2, PHE, count(FID)</span>
<span class="s1">FROM sw_cnv_indiv</span>
<span class="s1">WHERE NSEG != 0</span>
<span class="s1">GROUP BY CHR, BP1, BP2</span>
<span class="s1">ORDER BY CHR</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">n_CNV_occur</span> <span class="o">=</span> <span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">n_CNV_occur</span> <span class="o">=</span> <span class="n">n_CNV_occur</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;count(FID)&quot;</span><span class="p">:</span> <span class="s2">&quot;n_CNV_occur&quot;</span><span class="p">})</span>
<span class="c1"># print (n_CNV_occur)</span>
<span class="c1">### single occurrence CNVs</span>
<span class="n">single_CNV</span> <span class="o">=</span> <span class="n">n_CNV_occur</span><span class="p">[</span><span class="n">n_CNV_occur</span><span class="p">[</span><span class="s2">&quot;n_CNV_occur&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># print (single_CNV)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">single_CNV_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;CHR&quot;</span><span class="p">,</span> <span class="s2">&quot;BP1&quot;</span><span class="p">,</span> <span class="s2">&quot;BP2&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">,</span> <span class="s2">&quot;n_CNV_occur&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">single_CNV_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]:</span>
        <span class="n">single_CNV_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">single_CNV</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]:</span>
        <span class="n">single_CNV_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">continue</span>
<span class="n">single_CNV_test</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[22]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FID</th>
      <th>CHR</th>
      <th>BP1</th>
      <th>BP2</th>
      <th>PHE</th>
      <th>n_CNV_occur</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PT-L1HP</td>
      <td>1.0</td>
      <td>1106784.0</td>
      <td>1220136.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PT-L1HP</td>
      <td>1.0</td>
      <td>1307872.0</td>
      <td>1450947.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PT-FFQE</td>
      <td>1.0</td>
      <td>3000465.0</td>
      <td>3135175.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PT-1RU6</td>
      <td>1.0</td>
      <td>4116604.0</td>
      <td>4614822.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PT-8TK1</td>
      <td>1.0</td>
      <td>7656503.0</td>
      <td>7952404.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PT-ESXF</td>
      <td>1.0</td>
      <td>9070930.0</td>
      <td>9182914.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>PT-BRMI</td>
      <td>1.0</td>
      <td>10846558.0</td>
      <td>11100454.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>PT-BQZR</td>
      <td>1.0</td>
      <td>16096756.0</td>
      <td>16731510.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>PT-OOJX</td>
      <td>1.0</td>
      <td>19586294.0</td>
      <td>19798007.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>PT-3MNA</td>
      <td>1.0</td>
      <td>35453372.0</td>
      <td>35575946.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>PT-ETII</td>
      <td>1.0</td>
      <td>42366988.0</td>
      <td>42467921.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>PT-28IE</td>
      <td>1.0</td>
      <td>46813267.0</td>
      <td>46971549.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PT-ONJI</td>
      <td>1.0</td>
      <td>47413786.0</td>
      <td>47533705.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>PT-3MIA</td>
      <td>1.0</td>
      <td>48662372.0</td>
      <td>48793880.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>PT-ITMV</td>
      <td>1.0</td>
      <td>51885148.0</td>
      <td>53064034.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>PT-1RWA</td>
      <td>1.0</td>
      <td>59355505.0</td>
      <td>60046117.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PT-9ZJC</td>
      <td>1.0</td>
      <td>60433836.0</td>
      <td>60590660.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PT-OPKC</td>
      <td>1.0</td>
      <td>64015342.0</td>
      <td>64125544.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PT-OP95</td>
      <td>1.0</td>
      <td>68990012.0</td>
      <td>69100544.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>PT-OP95</td>
      <td>1.0</td>
      <td>69333693.0</td>
      <td>69515706.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>PT-FGU9</td>
      <td>1.0</td>
      <td>72628347.0</td>
      <td>72885281.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>PT-1SCO</td>
      <td>1.0</td>
      <td>73652872.0</td>
      <td>73776375.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>PT-OQ3N</td>
      <td>1.0</td>
      <td>74644454.0</td>
      <td>74756402.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>PT-OP96</td>
      <td>1.0</td>
      <td>78501215.0</td>
      <td>78632090.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>PT-8VHE_dup1</td>
      <td>1.0</td>
      <td>79641217.0</td>
      <td>79794719.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>PT-L3CT</td>
      <td>1.0</td>
      <td>84062434.0</td>
      <td>84304638.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>PT-BSRE</td>
      <td>1.0</td>
      <td>86805880.0</td>
      <td>87560668.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>PT-8VYY</td>
      <td>1.0</td>
      <td>88406195.0</td>
      <td>88511346.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>PT-287K</td>
      <td>1.0</td>
      <td>90345512.0</td>
      <td>90511157.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>PT-L2L5</td>
      <td>1.0</td>
      <td>95732250.0</td>
      <td>96388709.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>918</th>
      <td>PT-BQT2</td>
      <td>20.0</td>
      <td>37820996.0</td>
      <td>38014501.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>919</th>
      <td>PT-L1GA</td>
      <td>20.0</td>
      <td>41165006.0</td>
      <td>41273975.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>920</th>
      <td>PT-BSS5</td>
      <td>20.0</td>
      <td>50021455.0</td>
      <td>50377745.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>921</th>
      <td>PT-IRWP</td>
      <td>20.0</td>
      <td>51216970.0</td>
      <td>51341639.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>922</th>
      <td>PT-8TDY</td>
      <td>20.0</td>
      <td>52126563.0</td>
      <td>52450967.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>923</th>
      <td>PT-ESKF</td>
      <td>20.0</td>
      <td>55299406.0</td>
      <td>55534555.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>924</th>
      <td>PT-FFUS</td>
      <td>20.0</td>
      <td>58259236.0</td>
      <td>58436963.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>925</th>
      <td>PT-29C2</td>
      <td>20.0</td>
      <td>61276391.0</td>
      <td>61410101.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>926</th>
      <td>PT-FFR3</td>
      <td>21.0</td>
      <td>15154158.0</td>
      <td>15279270.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>927</th>
      <td>PT-L1MR</td>
      <td>21.0</td>
      <td>17530981.0</td>
      <td>17658262.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>928</th>
      <td>PT-ESH2</td>
      <td>21.0</td>
      <td>22456896.0</td>
      <td>22589517.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>929</th>
      <td>PT-OP8L</td>
      <td>21.0</td>
      <td>22737432.0</td>
      <td>22842175.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>930</th>
      <td>PT-28G2</td>
      <td>21.0</td>
      <td>23639689.0</td>
      <td>23932793.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>931</th>
      <td>PT-ONLL</td>
      <td>21.0</td>
      <td>24492713.0</td>
      <td>24639393.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>932</th>
      <td>PT-8WLO</td>
      <td>21.0</td>
      <td>29194187.0</td>
      <td>29351622.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>933</th>
      <td>PT-BQU8</td>
      <td>21.0</td>
      <td>31690321.0</td>
      <td>32371198.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>934</th>
      <td>PT-8VT6</td>
      <td>21.0</td>
      <td>37118059.0</td>
      <td>37293452.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>935</th>
      <td>PT-BQTZ</td>
      <td>21.0</td>
      <td>38572220.0</td>
      <td>38717900.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>936</th>
      <td>PT-8VXW</td>
      <td>21.0</td>
      <td>40764712.0</td>
      <td>40884871.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>937</th>
      <td>PT-2M65</td>
      <td>21.0</td>
      <td>45308538.0</td>
      <td>45424268.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>938</th>
      <td>PT-FGYN</td>
      <td>21.0</td>
      <td>46311264.0</td>
      <td>46435610.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>939</th>
      <td>PT-1S18</td>
      <td>22.0</td>
      <td>22315167.0</td>
      <td>22438373.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>940</th>
      <td>PT-ITR3</td>
      <td>22.0</td>
      <td>25291682.0</td>
      <td>25585047.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>941</th>
      <td>PT-8K11</td>
      <td>22.0</td>
      <td>30075087.0</td>
      <td>30216982.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>942</th>
      <td>PT-BRMS</td>
      <td>22.0</td>
      <td>33538320.0</td>
      <td>33848010.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>943</th>
      <td>PT-8TKO</td>
      <td>22.0</td>
      <td>37422390.0</td>
      <td>37810947.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>944</th>
      <td>PT-ONVN</td>
      <td>22.0</td>
      <td>38307909.0</td>
      <td>38463141.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>945</th>
      <td>PT-ETEH</td>
      <td>22.0</td>
      <td>38506688.0</td>
      <td>38606780.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>946</th>
      <td>PT-ESLT</td>
      <td>22.0</td>
      <td>47081716.0</td>
      <td>47332082.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>947</th>
      <td>PT-BQT2</td>
      <td>23.0</td>
      <td>154582472.0</td>
      <td>154739717.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>948 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">single_CNV_test1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_indiv_adj</span><span class="p">,</span> <span class="n">single_CNV_test</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">])</span>
<span class="c1"># print (single_CNV_test1)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FID, PHE, tr_adj, count(n_CNV_occur)</span>
<span class="s1">FROM single_CNV_test1</span>
<span class="s1">GROUP BY FID</span>
<span class="s1">ORDER BY count(n_CNV_occur) DESC</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">single_CNV_test2</span> <span class="o">=</span> <span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">single_CNV_test2</span> <span class="o">=</span> <span class="n">single_CNV_test2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;count(n_CNV_occur)&quot;</span><span class="p">:</span> <span class="s2">&quot;single_CNV_count&quot;</span><span class="p">})</span>
<span class="c1"># print (single_CNV_test2)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">indep_cols2</span> <span class="o">=</span> <span class="n">single_CNV_test2</span><span class="p">[[</span><span class="s2">&quot;single_CNV_count&quot;</span><span class="p">,</span> <span class="s2">&quot;tr_adj&quot;</span><span class="p">]]</span>
<span class="n">single_CNV_logit_test</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">single_CNV_test2</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">],</span> <span class="n">indep_cols2</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">single_CNV_logit_test</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">res2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">res2</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: 0.685471
         Iterations 4
                           Logit Regression Results                           
==============================================================================
Dep. Variable:                    PHE   No. Observations:                10636
Model:                          Logit   Df Residuals:                    10634
Method:                           MLE   Df Model:                            1
Date:                Wed, 19 Jul 2017   Pseudo R-squ.:                0.001921
Time:                        17:37:45   Log-Likelihood:                -7290.7
converged:                       True   LL-Null:                       -7304.7
                                        LLR p-value:                 1.170e-07
====================================================================================
                       coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------------
single_CNV_count     0.2144      0.062      3.476      0.001       0.093       0.335
tr_adj              -0.0987      0.008    -12.716      0.000      -0.114      -0.084
====================================================================================
1.2390821356939634
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">single_CNV_allindiv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sw_indiv_adj</span><span class="p">,</span> <span class="n">single_CNV</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FID&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">])</span>
<span class="c1"># print (single_CNV_allindiv)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FID, PHE, NSEG, tr_adj, count(n_CNV_occur)</span>
<span class="s1">FROM single_CNV_allindiv</span>
<span class="s1">GROUP BY FID</span>
<span class="s1">ORDER BY count(n_CNV_occur) DESC</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">single_CNV_indiv</span> <span class="o">=</span> <span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">single_CNV_indiv</span> <span class="o">=</span> <span class="n">single_CNV_indiv</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;count(n_CNV_occur)&quot;</span><span class="p">:</span> <span class="s2">&quot;single_CNV_count&quot;</span><span class="p">})</span>
<span class="n">single_CNV_indiv</span><span class="p">[</span><span class="s2">&quot;tmp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">single_CNV_indiv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;single_CNV_count&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># print (single_CNV_indiv)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">indep_cols1</span> <span class="o">=</span> <span class="n">single_CNV_indiv</span><span class="p">[[</span><span class="s2">&quot;single_CNV_count&quot;</span><span class="p">,</span> <span class="s2">&quot;tr_adj&quot;</span><span class="p">]]</span>
<span class="n">single_CNV_logit</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">single_CNV_indiv</span><span class="p">[</span><span class="s2">&quot;PHE&quot;</span><span class="p">],</span> <span class="n">indep_cols1</span><span class="p">)</span>
<span class="n">res1</span> <span class="o">=</span> <span class="n">single_CNV_logit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">res1</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">res1</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: 0.685408
         Iterations 4
                           Logit Regression Results                           
==============================================================================
Dep. Variable:                    PHE   No. Observations:                10636
Model:                          Logit   Df Residuals:                    10634
Method:                           MLE   Df Model:                            1
Date:                Wed, 19 Jul 2017   Pseudo R-squ.:                0.002013
Time:                        17:37:53   Log-Likelihood:                -7290.0
converged:                       True   LL-Null:                       -7304.7
                                        LLR p-value:                 5.873e-08
====================================================================================
                       coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------------
single_CNV_count     0.0901      0.025      3.667      0.000       0.042       0.138
tr_adj              -0.1079      0.009    -12.390      0.000      -0.125      -0.091
====================================================================================
1.09429538679
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_CNV_occur</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;n_CNV_occur&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[30]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>n_CNV_occur
1     5373
2      529
3      167
4       92
5       44
6       43
7       25
8       24
9       14
10      13
11       5
12      11
13       3
14       9
15       5
16       1
17       3
18       5
19       5
20       5
22       3
24       3
27       1
28       1
29       1
30       1
31       1
32       1
33       1
34       1
35       2
40       1
51       1
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_CNV_occur</span><span class="p">[</span><span class="s2">&quot;n_CNV_occur&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[31]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>9723</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># the occurrence of each CNV, in cases or controls separately</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT FID, CHR, BP1, BP2, PHE, count(FID)</span>
<span class="s1">FROM sw_cluster_indiv_cnv</span>
<span class="s1">WHERE NSEG != 0</span>
<span class="s1">GROUP BY CHR, BP1, BP2, PHE</span>
<span class="s1">ORDER BY count(FID) DESC</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">n_CNV_occur_sep</span> <span class="o">=</span> <span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">n_CNV_occur_sep</span> <span class="o">=</span> <span class="n">n_CNV_occur_sep</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;count(FID)&quot;</span><span class="p">:</span> <span class="s2">&quot;n_CNV_occur&quot;</span><span class="p">})</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">n_CNV_occur_sep</span><span class="p">)</span>
<span class="c1"># 2-6 occurrence CNVs</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT PHE, CHR, BP1, BP2, count(n_CNV_occur)</span>
<span class="s1">FROM n_CNV_occur_sep</span>
<span class="s1">WHERE n_CNV_occur &gt;= 2 AND n_CNV_occur &lt;= 6</span>
<span class="s1">GROUP BY PHE, CHR, BP1, BP2</span>
<span class="s1">ORDER BY count(n_CNV_occur) DESC</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>          FID  CHR         BP1         BP2  PHE  n_CNV_occur
0     PT-P29N    3  35,826,707  35,938,795    0           30
1     PT-OPVY    7   9,128,070   9,229,882    0           26
2     PT-OQ36    7  64,679,561  65,088,807    0           24
3     PT-CDFS    1 104,109,238 104,268,222    0           21
4     PT-3MID    1 161,496,900 161,638,530    0           21
5     PT-P29T    3  35,826,707  35,938,795    1           21
6     PT-1TC3   22  24,283,097  24,396,622    1           20
7     PT-CDH4   12  19,474,770  19,576,936    0           19
8     PT-P298    8   2,346,867   2,582,764    0           18
9     PT-29CN    3 100,340,068 100,442,478    1           17
10    PT-OPJ6    7   9,127,173   9,229,882    0           17
11    PT-OQ4D    8  16,416,409  16,526,958    0           17
12    PT-BQG2    9  43,315,670  43,800,186    0           17
13    PT-BQOS    1 104,155,643 104,268,222    1           15
14    PT-9ZDN   12  19,474,770  19,576,936    1           15
15    PT-1TB8   22  24,283,097  24,396,622    0           15
16    PT-OPYC    1  12,850,542  12,961,019    0           14
17    PT-BS5N    1 104,109,238 104,268,222    1           14
18    PT-8UI4    3  35,803,775  35,941,770    1           14
19    PT-OQ32    4 168,808,600 168,987,754    0           14
20    PT-P29H    7   9,128,070   9,229,882    1           14
21    PT-P29W    8   2,346,867   2,582,764    1           14
22    PT-L36T    9  28,194,546  28,342,179    0           14
23    PT-29C7   13  64,259,484  64,373,228    0           14
24    PT-BSWG    3  35,803,775  35,941,770    0           13
25    PT-8W3I    3 100,340,068 100,442,478    0           13
26    PT-9ZT5    6 162,721,807 162,914,277    0           13
27    PT-OO6K    6 162,724,247 162,914,986    0           13
28    PT-3MI4   15  24,574,757  24,778,891    0           13
29    PT-296N   16  14,989,839  15,116,257    0           13
...       ...  ...         ...         ...  ...          ...
7064  PT-1S8F   23   2,839,942   3,678,164    1            1
7065  PT-1S1Y   23   2,850,801   3,637,916    1            1
7066  PT-1S19   23   2,850,801   3,659,193    1            1
7067  PT-1TC9   23   2,854,842   3,165,914    0            1
7068  PT-P2AQ   23   2,861,866   3,176,513    1            1
7069  PT-1S7C   23   2,916,735   3,539,248    1            1
7070  PT-1SC5   23   2,916,735   3,554,481    0            1
7071  PT-1S1P   23   2,916,735   3,659,193    1            1
7072  PT-1TC8   23   2,922,213   3,281,304    0            1
7073  PT-ETOE   23   2,959,861   3,151,119    0            1
7074  PT-1S76   23   2,979,529   3,442,152    1            1
7075  PT-1SCR   23   2,979,529   3,539,248    1            1
7076  PT-1TAY   23   2,979,529   3,659,193    0            1
7077  PT-1S7P   23   2,979,529   3,659,193    1            1
7078  PT-1SC9   23   3,070,182   4,736,479    1            1
7079  PT-1S1Z   23   3,231,040   3,539,248    0            1
7080  PT-8UXD   23   3,502,739   3,673,759    0            1
7081  PT-OQ49   23   3,608,067   4,120,689    0            1
7082  PT-ET3Q   23   3,953,950   4,084,888    0            1
7083  PT-ETNK   23   3,953,950   4,084,888    1            1
7084  PT-1S2E   23   4,179,644   4,443,426    0            1
7085  PT-1TC8   23   4,421,385   5,775,743    0            1
7086  PT-8U7V   23   4,540,694   4,951,075    0            1
7087  PT-1S2E   23   4,605,593   4,984,469    0            1
7088  PT-OQ49   23   4,642,016   5,579,703    0            1
7089  PT-BQK3   23 154,120,748 154,565,731    1            1
7090  PT-BQTV   23 154,120,748 154,582,472    0            1
7091  PT-FFQW   23 154,453,339 154,563,670    0            1
7092  PT-IT78   23 154,453,339 154,563,670    1            1
7093  PT-BQT2   23 154,582,472 154,739,717    1            1

[7094 rows x 6 columns]
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt output_prompt">Out[32]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PHE</th>
      <th>CHR</th>
      <th>BP1</th>
      <th>BP2</th>
      <th>count(n_CNV_occur)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>12,852,748</td>
      <td>13,015,495</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>12,858,053</td>
      <td>12,961,019</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>12,867,090</td>
      <td>13,015,495</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>16,844,932</td>
      <td>17,262,247</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>16,869,363</td>
      <td>16,970,456</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>1</td>
      <td>16,869,363</td>
      <td>16,986,851</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>1</td>
      <td>16,869,363</td>
      <td>17,005,978</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>1</td>
      <td>16,886,135</td>
      <td>16,986,851</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0</td>
      <td>1</td>
      <td>16,886,135</td>
      <td>17,082,591</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>1</td>
      <td>16,886,135</td>
      <td>17,114,712</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0</td>
      <td>1</td>
      <td>28,610,661</td>
      <td>28,815,282</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>1</td>
      <td>40,183,029</td>
      <td>40,308,992</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>1</td>
      <td>46,231,495</td>
      <td>46,412,647</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0</td>
      <td>1</td>
      <td>46,321,843</td>
      <td>46,558,927</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0</td>
      <td>1</td>
      <td>102,657,644</td>
      <td>102,852,850</td>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0</td>
      <td>1</td>
      <td>102,673,499</td>
      <td>102,846,147</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>1</td>
      <td>104,157,317</td>
      <td>104,268,222</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0</td>
      <td>1</td>
      <td>104,158,309</td>
      <td>104,268,222</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0</td>
      <td>1</td>
      <td>121,155,528</td>
      <td>121,355,881</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0</td>
      <td>1</td>
      <td>121,168,848</td>
      <td>121,355,881</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0</td>
      <td>1</td>
      <td>121,172,329</td>
      <td>121,323,430</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0</td>
      <td>1</td>
      <td>121,172,329</td>
      <td>121,447,136</td>
      <td>1</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0</td>
      <td>1</td>
      <td>145,382,124</td>
      <td>145,792,064</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0</td>
      <td>1</td>
      <td>145,625,706</td>
      <td>145,770,639</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0</td>
      <td>1</td>
      <td>145,625,979</td>
      <td>145,762,959</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0</td>
      <td>1</td>
      <td>145,625,979</td>
      <td>145,807,817</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0</td>
      <td>1</td>
      <td>146,786,080</td>
      <td>146,942,884</td>
      <td>1</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0</td>
      <td>1</td>
      <td>147,713,016</td>
      <td>147,844,790</td>
      <td>1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0</td>
      <td>1</td>
      <td>148,513,790</td>
      <td>148,870,937</td>
      <td>1</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0</td>
      <td>1</td>
      <td>161,496,900</td>
      <td>161,656,498</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>851</th>
      <td>1</td>
      <td>19</td>
      <td>43,663,086</td>
      <td>43,845,593</td>
      <td>1</td>
    </tr>
    <tr>
      <th>852</th>
      <td>1</td>
      <td>19</td>
      <td>43,663,369</td>
      <td>43,846,394</td>
      <td>1</td>
    </tr>
    <tr>
      <th>853</th>
      <td>1</td>
      <td>19</td>
      <td>54,992,671</td>
      <td>55,097,535</td>
      <td>1</td>
    </tr>
    <tr>
      <th>854</th>
      <td>1</td>
      <td>19</td>
      <td>55,237,246</td>
      <td>55,339,733</td>
      <td>1</td>
    </tr>
    <tr>
      <th>855</th>
      <td>1</td>
      <td>19</td>
      <td>55,251,085</td>
      <td>55,378,699</td>
      <td>1</td>
    </tr>
    <tr>
      <th>856</th>
      <td>1</td>
      <td>20</td>
      <td>14,726,832</td>
      <td>15,028,962</td>
      <td>1</td>
    </tr>
    <tr>
      <th>857</th>
      <td>1</td>
      <td>20</td>
      <td>29,420,352</td>
      <td>29,525,422</td>
      <td>1</td>
    </tr>
    <tr>
      <th>858</th>
      <td>1</td>
      <td>21</td>
      <td>10,736,871</td>
      <td>11,010,386</td>
      <td>1</td>
    </tr>
    <tr>
      <th>859</th>
      <td>1</td>
      <td>21</td>
      <td>10,736,871</td>
      <td>11,013,964</td>
      <td>1</td>
    </tr>
    <tr>
      <th>860</th>
      <td>1</td>
      <td>21</td>
      <td>10,736,871</td>
      <td>11,018,107</td>
      <td>1</td>
    </tr>
    <tr>
      <th>861</th>
      <td>1</td>
      <td>21</td>
      <td>10,755,724</td>
      <td>11,013,964</td>
      <td>1</td>
    </tr>
    <tr>
      <th>862</th>
      <td>1</td>
      <td>21</td>
      <td>10,829,682</td>
      <td>11,013,964</td>
      <td>1</td>
    </tr>
    <tr>
      <th>863</th>
      <td>1</td>
      <td>21</td>
      <td>10,868,754</td>
      <td>11,013,964</td>
      <td>1</td>
    </tr>
    <tr>
      <th>864</th>
      <td>1</td>
      <td>21</td>
      <td>14,594,235</td>
      <td>15,155,536</td>
      <td>1</td>
    </tr>
    <tr>
      <th>865</th>
      <td>1</td>
      <td>21</td>
      <td>14,613,203</td>
      <td>15,011,015</td>
      <td>1</td>
    </tr>
    <tr>
      <th>866</th>
      <td>1</td>
      <td>21</td>
      <td>14,613,203</td>
      <td>15,052,812</td>
      <td>1</td>
    </tr>
    <tr>
      <th>867</th>
      <td>1</td>
      <td>21</td>
      <td>14,613,203</td>
      <td>15,129,378</td>
      <td>1</td>
    </tr>
    <tr>
      <th>868</th>
      <td>1</td>
      <td>21</td>
      <td>14,613,203</td>
      <td>15,279,270</td>
      <td>1</td>
    </tr>
    <tr>
      <th>869</th>
      <td>1</td>
      <td>21</td>
      <td>27,909,387</td>
      <td>28,273,618</td>
      <td>1</td>
    </tr>
    <tr>
      <th>870</th>
      <td>1</td>
      <td>21</td>
      <td>37,481,955</td>
      <td>37,617,200</td>
      <td>1</td>
    </tr>
    <tr>
      <th>871</th>
      <td>1</td>
      <td>21</td>
      <td>37,481,955</td>
      <td>37,619,514</td>
      <td>1</td>
    </tr>
    <tr>
      <th>872</th>
      <td>1</td>
      <td>21</td>
      <td>37,484,880</td>
      <td>37,617,929</td>
      <td>1</td>
    </tr>
    <tr>
      <th>873</th>
      <td>1</td>
      <td>21</td>
      <td>37,484,880</td>
      <td>37,619,514</td>
      <td>1</td>
    </tr>
    <tr>
      <th>874</th>
      <td>1</td>
      <td>22</td>
      <td>16,855,618</td>
      <td>17,294,251</td>
      <td>1</td>
    </tr>
    <tr>
      <th>875</th>
      <td>1</td>
      <td>22</td>
      <td>18,732,919</td>
      <td>19,006,125</td>
      <td>1</td>
    </tr>
    <tr>
      <th>876</th>
      <td>1</td>
      <td>22</td>
      <td>18,738,296</td>
      <td>19,008,108</td>
      <td>1</td>
    </tr>
    <tr>
      <th>877</th>
      <td>1</td>
      <td>22</td>
      <td>18,876,428</td>
      <td>21,465,835</td>
      <td>1</td>
    </tr>
    <tr>
      <th>878</th>
      <td>1</td>
      <td>22</td>
      <td>24,283,097</td>
      <td>24,390,796</td>
      <td>1</td>
    </tr>
    <tr>
      <th>879</th>
      <td>1</td>
      <td>22</td>
      <td>24,283,097</td>
      <td>24,393,823</td>
      <td>1</td>
    </tr>
    <tr>
      <th>880</th>
      <td>1</td>
      <td>23</td>
      <td>2,741,339</td>
      <td>3,649,902</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>881 rows × 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># res1 = pd.DataFrame(columns=(&quot;FID&quot;, &quot;IID&quot;, &quot;PHE&quot;, &quot;n_cnv&quot;))</span>
<span class="c1"># i = 0</span>
<span class="c1"># for tup in sw_indiv.itertuples():</span>
<span class="c1">#     if tup.NSEG&gt;0:</span>
<span class="c1">#         for d in range(tup.NSEG):</span>
<span class="c1">#             res1.loc[i] = [tup.FID, tup.IID, tup.PHE, 1]</span>
<span class="c1">#             i += 1</span>
<span class="c1">#     else:</span>
<span class="c1">#         res1.loc[i] = [tup.FID, tup.IID, tup.PHE, 0]</span>
<span class="c1">#         i += 1</span>
<span class="c1"># print (res1)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[34]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>6104</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">][</span><span class="n">sw_indiv</span><span class="p">[</span><span class="s2">&quot;NSEG&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[35]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>4532</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">single_CNV</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[36]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>5373</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_mds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;../data/swcnv/swcnv.mds&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;\s+&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C_sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C1&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C2&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C3&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C4&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C5&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C6&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C7&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C8&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C9&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C10&quot;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sw_mds</span><span class="p">[</span><span class="s2">&quot;C_sum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1.00015782373
</pre>
</div>
</div>

</div>
</div>

</div>
<hr>
&copy 2016-2017 Min Qiao at <a href="http://xinhelab.org">Xin He lab</a>, The University of Chicago
<p><small>Exported from <a href="http://github.com/gaow/cnv-gene-mapping/blob/7233da3dc3da87536a14182030d73af0601271f3/analysis/20170721_swcnv.ipynb"><code>analysis/20170721_swcnv.ipynb</code></a> committed by Min Qiao on Mon Sep 16 00:18:07 2019 <a href="http://github.com/gaow/cnv-gene-mapping/commit/7233da3dc3da87536a14182030d73af0601271f3">revision 10, 7233da3</a> <a href="https://stephenslab.github.io/ipynb-website/notes.html#Note-about-commit-ids"><span class="fa fa-question-circle"></span></a></small></p>
</div>
</div>
</body>
</html>
