
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.7" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs/null.min.css"
      type="text/css" />

<script src="../site_libs/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=dscDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=dscArray;
            var docs_map=dscArrayMap;
            var pos=dscArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  $('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  $(".toc #toc-level0").append('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>');
            }
            // $("#toc-header").hide(); // comment out because it prevents search bar from displaying
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Gene Mapping with CNV</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Gene Mapping with CNV</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Overview</a>
</li>
        
<li>
  <a href="../analysis.html">Analysis</a>
</li>
        
<li>
  <a href="../prototype.html">Prototype</a>
</li>
        
<li>
  <a href="../dsc.html">Dsc</a>
</li>
        
<li>
  <a href="../setup/index.html">Setup</a>
</li>
        
<li>
  <a href="../writeup.html">Writeup</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="http://github.com/gaow/cnv-gene-mapping"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Use-BoomSpikeSlab">Use BoomSpikeSlab<a class="anchor-link" href="#Use-BoomSpikeSlab">&#182;</a></h1><h2 id="First-check-the-result-of-varbvs-on-whole-genome">First check the result of varbvs on whole genome<a class="anchor-link" href="#First-check-the-result-of-varbvs-on-whole-genome">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="nf">readRDS</span><span class="p">(</span><span class="s">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/deletion.genes.block30.binomial.whole.genome.prior.varbvs.nologodds.updateb0.rds&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">mu0</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">b0</span> <span class="o">*</span> <span class="n">res</span><span class="o">$</span><span class="n">w</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">mu0</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.777072111580423
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">sd0</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">sa</span> <span class="o">*</span> <span class="n">res</span><span class="o">$</span><span class="n">w</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">sd0</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.843650169910125
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">pi0</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">((</span><span class="m">10</span><span class="nf">^</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">logodds</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="m">1</span> <span class="o">+</span> <span class="m">10</span><span class="nf">^</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">logodds</span><span class="p">)))</span> <span class="o">*</span> <span class="n">res</span><span class="o">$</span><span class="n">w</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">pi0</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.0437754961218526
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># library(varbvs)</span>
<span class="c1"># help(varbvs)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># varbvs::varbvs</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">susieR</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">BoomSpikeSlab</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Loading required package: Boom
Loading required package: MASS

Attaching package: ‘Boom’

The following object is masked from ‘package:stats’:

    rWishart


Attaching package: ‘BoomSpikeSlab’

The following object is masked from ‘package:stats’:

    knots

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data.table</span><span class="o">::</span><span class="nf">fread</span><span class="p">(</span><span class="s">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/block_79_137/deletion.genes.block30.for_simu.sample.genes.block_79_137.gz&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="bp">F</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">as.matrix</span><span class="p">(</span><span class="n">data.table</span><span class="o">::</span><span class="nf">fread</span><span class="p">(</span><span class="s">&quot;/data/GIT/cnv-gene-mapping/data/deletion_simu/deletion.genes.block30.for_simu.sample.y&quot;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">sum</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nf">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="m">0.06</span><span class="p">),</span> <span class="nf">c</span><span class="p">((</span><span class="nf">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="m">+1</span><span class="p">)</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y[sampler</span><span class="p">,</span> <span class="n">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X[sampler</span><span class="p">,</span> <span class="n">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">X_inter</span> <span class="o">=</span> <span class="nf">cbind</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">storage.mode</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">=</span> <span class="s">&#39;double&#39;</span>
<span class="nf">storage.mode</span><span class="p">(</span><span class="n">X_inter</span><span class="p">)</span> <span class="o">=</span> <span class="s">&#39;double&#39;</span>
<span class="nf">storage.mode</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="s">&#39;double&#39;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">dim</span><span class="p">(</span><span class="n">X_inter</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>7108</li>
	<li>60</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">X_center</span> <span class="o">&lt;-</span> <span class="nf">scale</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">prior</span> <span class="o">&lt;-</span> <span class="nf">LogitZellnerPrior</span><span class="p">(</span><span class="n">X_inter</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">prior.success.probability</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">expected.model.size</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">prior.information.weight</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> 
                           <span class="n">diagonal.shrinkage</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">optional.coefficient.estimate</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">prior.inclusion.probabilities</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">names</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>'prior.inclusion.probabilities'</li>
	<li>'mu'</li>
	<li>'sigma.guess'</li>
	<li>'prior.df'</li>
	<li>'sigma.upper.limit'</li>
	<li>'max.flips'</li>
	<li>'siginv'</li>
	<li>'prior.success.probability'</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">prior</span><span class="o">$</span><span class="n">sigma.guess</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.707106781186548
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">prior_glm</span> <span class="o">&lt;-</span> <span class="nf">SpikeSlabGlmPrior</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span> <span class="n">prior.inclusion.probabilities</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="nf">ncol</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span> <span class="n">expected.model.size</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                               <span class="n">optional.coefficient.estimate</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span> <span class="n">mean.on.natural.scale</span> <span class="o">=</span> <span class="m">-1</span><span class="p">,</span> <span class="n">max.flips</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">diagonal.shrinkage</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">prior.information.weight</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">names</span><span class="p">(</span><span class="n">prior_glm</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>'prior.inclusion.probabilities'</li>
	<li>'mu'</li>
	<li>'sigma.guess'</li>
	<li>'prior.df'</li>
	<li>'sigma.upper.limit'</li>
	<li>'max.flips'</li>
	<li>'siginv'</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">prior1</span> <span class="o">&lt;-</span> <span class="n">prior</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">length</span><span class="p">(</span><span class="n">prior</span><span class="o">$</span><span class="n">mu</span><span class="p">);</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
60
</div>

</div>

<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
59
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">prior1</span><span class="o">$</span><span class="n">prior.inclusion.probabilities</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">prior</span><span class="o">$</span><span class="n">prior.inclusion.probabilities[1]</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="n">pi0</span><span class="p">,</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
<span class="n">prior1</span><span class="o">$</span><span class="n">mu</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">prior</span><span class="o">$</span><span class="n">mu[1]</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">mu0</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">mu0</span><span class="p">,</span> <span class="n">mu0</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">9</span><span class="p">),</span> <span class="n">mu0</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span> <span class="n">mu0</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span> <span class="n">mu0</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span>
<span class="c1"># prior1$mu &lt;- c(prior$mu[1], colSums(X_inter)[2:ncol(X_inter)]*0.001)</span>
<span class="n">prior1</span><span class="o">$</span><span class="n">sigma.guess</span> <span class="o">&lt;-</span> <span class="n">sd0</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">length</span><span class="p">(</span><span class="n">prior</span><span class="o">$</span><span class="n">mu</span><span class="p">)</span> <span class="o">==</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
FALSE
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">model1</span> <span class="o">&lt;-</span> <span class="nf">logit.spike</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">X</span><span class="p">,</span> <span class="n">niter</span> <span class="o">=</span> <span class="m">1000</span><span class="p">,</span> <span class="n">prior</span> <span class="o">=</span> <span class="n">prior1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>=-=-=-=-= Iteration 0 Thu Oct  3 22:48:23 2019 =-=-=-=-=
=-=-=-=-= Iteration 100 Thu Oct  3 22:48:53 2019 =-=-=-=-=
=-=-=-=-= Iteration 200 Thu Oct  3 22:49:17 2019 =-=-=-=-=
=-=-=-=-= Iteration 300 Thu Oct  3 22:49:46 2019 =-=-=-=-=
=-=-=-=-= Iteration 400 Thu Oct  3 22:50:16 2019 =-=-=-=-=
=-=-=-=-= Iteration 500 Thu Oct  3 22:50:45 2019 =-=-=-=-=
=-=-=-=-= Iteration 600 Thu Oct  3 22:51:12 2019 =-=-=-=-=
=-=-=-=-= Iteration 700 Thu Oct  3 22:51:41 2019 =-=-=-=-=
=-=-=-=-= Iteration 800 Thu Oct  3 22:52:09 2019 =-=-=-=-=
=-=-=-=-= Iteration 900 Thu Oct  3 22:52:33 2019 =-=-=-=-=
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">model0</span> <span class="o">&lt;-</span> <span class="nf">logit.spike</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">X</span><span class="p">,</span> <span class="n">niter</span> <span class="o">=</span> <span class="m">1000</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>=-=-=-=-= Iteration 0 Thu Oct  3 23:21:08 2019 =-=-=-=-=
=-=-=-=-= Iteration 100 Thu Oct  3 23:21:38 2019 =-=-=-=-=
=-=-=-=-= Iteration 200 Thu Oct  3 23:22:05 2019 =-=-=-=-=
=-=-=-=-= Iteration 300 Thu Oct  3 23:22:28 2019 =-=-=-=-=
=-=-=-=-= Iteration 400 Thu Oct  3 23:22:55 2019 =-=-=-=-=
=-=-=-=-= Iteration 500 Thu Oct  3 23:23:24 2019 =-=-=-=-=
=-=-=-=-= Iteration 600 Thu Oct  3 23:23:48 2019 =-=-=-=-=
=-=-=-=-= Iteration 700 Thu Oct  3 23:24:12 2019 =-=-=-=-=
=-=-=-=-= Iteration 800 Thu Oct  3 23:24:39 2019 =-=-=-=-=
=-=-=-=-= Iteration 900 Thu Oct  3 23:25:05 2019 =-=-=-=-=
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">model0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>null log likelihood:            -1545.166 
posterior mean log likelihood:  -1545.7 
posterior max log likelihood:   -1545.166 
mean deviance R-sq:             -0.0003451598 

predicted vs observed success rates, by decile:
                    predicted   observed
(0.056818,0.056824] 0.0568237 0.05882353

summary of coefficients:
                 mean      sd mean.inc sd.inc inc.prob
(Intercept) -2.810000 0.05300   -2.810  0.053    1.000
XV17         0.000105 0.00331    0.105  0.000    0.001
XV59         0.000000 0.00000    0.000  0.000    0.000
XV58         0.000000 0.00000    0.000  0.000    0.000
XV57         0.000000 0.00000    0.000  0.000    0.000
XV56         0.000000 0.00000    0.000  0.000    0.000
XV55         0.000000 0.00000    0.000  0.000    0.000
XV54         0.000000 0.00000    0.000  0.000    0.000
XV53         0.000000 0.00000    0.000  0.000    0.000
XV52         0.000000 0.00000    0.000  0.000    0.000
XV51         0.000000 0.00000    0.000  0.000    0.000
XV50         0.000000 0.00000    0.000  0.000    0.000
XV49         0.000000 0.00000    0.000  0.000    0.000
XV48         0.000000 0.00000    0.000  0.000    0.000
XV47         0.000000 0.00000    0.000  0.000    0.000
XV46         0.000000 0.00000    0.000  0.000    0.000
XV45         0.000000 0.00000    0.000  0.000    0.000
XV44         0.000000 0.00000    0.000  0.000    0.000
XV43         0.000000 0.00000    0.000  0.000    0.000
XV42         0.000000 0.00000    0.000  0.000    0.000
XV41         0.000000 0.00000    0.000  0.000    0.000
XV40         0.000000 0.00000    0.000  0.000    0.000
XV39         0.000000 0.00000    0.000  0.000    0.000
XV38         0.000000 0.00000    0.000  0.000    0.000
XV37         0.000000 0.00000    0.000  0.000    0.000
XV36         0.000000 0.00000    0.000  0.000    0.000
XV35         0.000000 0.00000    0.000  0.000    0.000
XV34         0.000000 0.00000    0.000  0.000    0.000
XV33         0.000000 0.00000    0.000  0.000    0.000
XV32         0.000000 0.00000    0.000  0.000    0.000
XV31         0.000000 0.00000    0.000  0.000    0.000
XV30         0.000000 0.00000    0.000  0.000    0.000
XV29         0.000000 0.00000    0.000  0.000    0.000
XV28         0.000000 0.00000    0.000  0.000    0.000
XV27         0.000000 0.00000    0.000  0.000    0.000
XV26         0.000000 0.00000    0.000  0.000    0.000
XV25         0.000000 0.00000    0.000  0.000    0.000
XV24         0.000000 0.00000    0.000  0.000    0.000
XV23         0.000000 0.00000    0.000  0.000    0.000
XV22         0.000000 0.00000    0.000  0.000    0.000
XV21         0.000000 0.00000    0.000  0.000    0.000
XV20         0.000000 0.00000    0.000  0.000    0.000
XV19         0.000000 0.00000    0.000  0.000    0.000
XV18         0.000000 0.00000    0.000  0.000    0.000
XV16         0.000000 0.00000    0.000  0.000    0.000
XV15         0.000000 0.00000    0.000  0.000    0.000
XV14         0.000000 0.00000    0.000  0.000    0.000
XV13         0.000000 0.00000    0.000  0.000    0.000
XV12         0.000000 0.00000    0.000  0.000    0.000
XV11         0.000000 0.00000    0.000  0.000    0.000
XV10         0.000000 0.00000    0.000  0.000    0.000
XV9          0.000000 0.00000    0.000  0.000    0.000
XV8          0.000000 0.00000    0.000  0.000    0.000
XV7          0.000000 0.00000    0.000  0.000    0.000
XV6          0.000000 0.00000    0.000  0.000    0.000
XV5          0.000000 0.00000    0.000  0.000    0.000
XV4          0.000000 0.00000    0.000  0.000    0.000
XV3          0.000000 0.00000    0.000  0.000    0.000
XV2          0.000000 0.00000    0.000  0.000    0.000
XV1          0.000000 0.00000    0.000  0.000    0.000</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">model</span> <span class="o">&lt;-</span> <span class="nf">logit.spike</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">X</span><span class="p">,</span> <span class="n">niter</span> <span class="o">=</span> <span class="m">30000</span><span class="p">,</span> <span class="n">prior</span> <span class="o">=</span> <span class="n">prior</span><span class="p">)</span>
<span class="c1"># model &lt;- logit.spike(y ~ X_inter, niter = 100)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="c1"># prior 1000</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span> <span class="c1"># prior1 1000</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>null log likelihood:            -1545.166 
posterior mean log likelihood:  -1545.637 
posterior max log likelihood:   -1544.987 
mean deviance R-sq:             -0.0003043409 

predicted vs observed success rates, by decile:
                 predicted   observed
(0.0564,0.0582] 0.05739954 0.05128205

summary of coefficients:
                 mean     sd mean.inc  sd.inc inc.prob
(Intercept) -2.820000 0.0478  -2.8200 0.04780    1.000
XV22         0.000816 0.1230   0.0742 1.23000    0.011
XV55         0.002830 0.0449   0.7070 0.08550    0.004
XV44         0.001430 0.0243   0.3580 0.16100    0.004
XV33         0.003210 0.0506   0.8010 0.00488    0.004
XV23         0.003010 0.0477   0.7540 0.04700    0.004
XV11         0.004150 0.0664   1.0400 0.20300    0.004
XV5         -0.000840 0.0266  -0.8400 0.00000    0.001
XV59         0.000000 0.0000   0.0000 0.00000    0.000
XV58         0.000000 0.0000   0.0000 0.00000    0.000
XV57         0.000000 0.0000   0.0000 0.00000    0.000
XV56         0.000000 0.0000   0.0000 0.00000    0.000
XV54         0.000000 0.0000   0.0000 0.00000    0.000
XV53         0.000000 0.0000   0.0000 0.00000    0.000
XV52         0.000000 0.0000   0.0000 0.00000    0.000
XV51         0.000000 0.0000   0.0000 0.00000    0.000
XV50         0.000000 0.0000   0.0000 0.00000    0.000
XV49         0.000000 0.0000   0.0000 0.00000    0.000
XV48         0.000000 0.0000   0.0000 0.00000    0.000
XV47         0.000000 0.0000   0.0000 0.00000    0.000
XV46         0.000000 0.0000   0.0000 0.00000    0.000
XV45         0.000000 0.0000   0.0000 0.00000    0.000
XV43         0.000000 0.0000   0.0000 0.00000    0.000
XV42         0.000000 0.0000   0.0000 0.00000    0.000
XV41         0.000000 0.0000   0.0000 0.00000    0.000
XV40         0.000000 0.0000   0.0000 0.00000    0.000
XV39         0.000000 0.0000   0.0000 0.00000    0.000
XV38         0.000000 0.0000   0.0000 0.00000    0.000
XV37         0.000000 0.0000   0.0000 0.00000    0.000
XV36         0.000000 0.0000   0.0000 0.00000    0.000
XV35         0.000000 0.0000   0.0000 0.00000    0.000
XV34         0.000000 0.0000   0.0000 0.00000    0.000
XV32         0.000000 0.0000   0.0000 0.00000    0.000
XV31         0.000000 0.0000   0.0000 0.00000    0.000
XV30         0.000000 0.0000   0.0000 0.00000    0.000
XV29         0.000000 0.0000   0.0000 0.00000    0.000
XV28         0.000000 0.0000   0.0000 0.00000    0.000
XV27         0.000000 0.0000   0.0000 0.00000    0.000
XV26         0.000000 0.0000   0.0000 0.00000    0.000
XV25         0.000000 0.0000   0.0000 0.00000    0.000
XV24         0.000000 0.0000   0.0000 0.00000    0.000
XV21         0.000000 0.0000   0.0000 0.00000    0.000
XV20         0.000000 0.0000   0.0000 0.00000    0.000
XV19         0.000000 0.0000   0.0000 0.00000    0.000
XV18         0.000000 0.0000   0.0000 0.00000    0.000
XV17         0.000000 0.0000   0.0000 0.00000    0.000
XV16         0.000000 0.0000   0.0000 0.00000    0.000
XV15         0.000000 0.0000   0.0000 0.00000    0.000
XV14         0.000000 0.0000   0.0000 0.00000    0.000
XV13         0.000000 0.0000   0.0000 0.00000    0.000
XV12         0.000000 0.0000   0.0000 0.00000    0.000
XV10         0.000000 0.0000   0.0000 0.00000    0.000
XV9          0.000000 0.0000   0.0000 0.00000    0.000
XV8          0.000000 0.0000   0.0000 0.00000    0.000
XV7          0.000000 0.0000   0.0000 0.00000    0.000
XV6          0.000000 0.0000   0.0000 0.00000    0.000
XV4          0.000000 0.0000   0.0000 0.00000    0.000
XV3          0.000000 0.0000   0.0000 0.00000    0.000
XV2          0.000000 0.0000   0.0000 0.00000    0.000
XV1          0.000000 0.0000   0.0000 0.00000    0.000</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">n</span> <span class="o">&lt;-</span> <span class="m">100</span>
<span class="n">p</span> <span class="o">&lt;-</span> <span class="m">10</span>
<span class="n">ngood</span> <span class="o">&lt;-</span> <span class="m">3</span>
<span class="n">niter</span> <span class="o">&lt;-</span> <span class="m">1000</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="m">-1</span><span class="p">)),</span> <span class="n">nrow</span><span class="o">=</span><span class="n">n</span><span class="p">))</span>
<span class="n">beta</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="n">ngood</span><span class="p">),</span> <span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">ngood</span><span class="p">))</span>
<span class="n">prob</span> <span class="o">&lt;-</span> <span class="nf">plogis</span><span class="p">(</span><span class="n">x</span> <span class="o">%*%</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">runif</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">prob</span>
<span class="n">x</span> <span class="o">&lt;-</span> <span class="n">x[</span><span class="p">,</span><span class="m">-1</span><span class="n">]</span>
<span class="n">model</span> <span class="o">&lt;-</span> <span class="nf">logit.spike</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">x</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="n">niter</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>=-=-=-=-= Iteration 0 Wed Oct  2 22:00:39 2019 =-=-=-=-=
=-=-=-=-= Iteration 100 Wed Oct  2 22:00:39 2019 =-=-=-=-=
=-=-=-=-= Iteration 200 Wed Oct  2 22:00:39 2019 =-=-=-=-=
=-=-=-=-= Iteration 300 Wed Oct  2 22:00:39 2019 =-=-=-=-=
=-=-=-=-= Iteration 400 Wed Oct  2 22:00:39 2019 =-=-=-=-=
=-=-=-=-= Iteration 500 Wed Oct  2 22:00:40 2019 =-=-=-=-=
=-=-=-=-= Iteration 600 Wed Oct  2 22:00:40 2019 =-=-=-=-=
=-=-=-=-= Iteration 700 Wed Oct  2 22:00:40 2019 =-=-=-=-=
=-=-=-=-= Iteration 800 Wed Oct  2 22:00:40 2019 =-=-=-=-=
=-=-=-=-= Iteration 900 Wed Oct  2 22:00:40 2019 =-=-=-=-=
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>null log likelihood:            -57.30569 
posterior mean log likelihood:  -69.21457 
posterior max log likelihood:   -67.30182 
mean deviance R-sq:             -0.2078131 

predicted vs observed success rates, by decile:
              predicted observed
(0.49,0.494]  0.4923392      0.0
(0.494,0.496] 0.4952206      0.1
(0.496,0.498] 0.4969029      0.2
(0.498,0.499] 0.4983347      0.2
(0.499,0.5]   0.4996715      0.4
(0.5,0.502]   0.5011072      0.3
(0.502,0.503] 0.5022994      0.0
(0.503,0.504] 0.5036059      0.4
(0.504,0.507] 0.5056010      0.3
(0.507,0.512] 0.5090135      0.7

summary of coefficients:
        mean     sd mean.inc sd.inc inc.prob
x5 -0.017700 0.0942   -0.455 0.1720    0.039
x1 -0.011400 0.0738   -0.394 0.1940    0.029
x9 -0.000636 0.0142   -0.318 0.0138    0.002
x2 -0.001020 0.0228   -0.510 0.0000    0.002
x8  0.000000 0.0000    0.000 0.0000    0.000
x7  0.000000 0.0000    0.000 0.0000    0.000
x6  0.000000 0.0000    0.000 0.0000    0.000
x4  0.000000 0.0000    0.000 0.0000    0.000
x3  0.000000 0.0000    0.000 0.0000    0.000</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>null log likelihood:            -67.68585 
posterior mean log likelihood:  -69.297 
posterior max log likelihood:   -67.94729 
mean deviance R-sq:             -0.02380324 

predicted vs observed success rates, by decile:
                predicted  observed
(0.4974,0.4986] 0.4982661 0.6666667
(0.4986,0.499]  0.4988171 0.3000000
(0.499,0.4995]  0.4991941 0.6000000
(0.4995,0.4999] 0.4996560 0.5000000
(0.4999,0.5002] 0.5000711 0.4000000
(0.5002,0.5004] 0.5002891 0.8000000
(0.5004,0.5007] 0.5005541 0.8000000
(0.5007,0.501]  0.5009263 0.4000000
(0.501,0.5014]  0.5011724 0.6000000
(0.5014,0.5027] 0.5018429 0.9000000

summary of coefficients:
                 mean      sd mean.inc  sd.inc inc.prob
x3           0.004290 0.04540   0.4290 0.16300    0.010
x1           0.001960 0.02430   0.2450 0.12700    0.008
x9          -0.000974 0.01540  -0.2440 0.00585    0.004
x2          -0.000161 0.00413  -0.0536 0.06500    0.003
x7          -0.000214 0.00483  -0.1070 0.01970    0.002
x5           0.000281 0.00629   0.1410 0.00644    0.002
x8           0.000000 0.00000   0.0000 0.00000    0.000
x6           0.000000 0.00000   0.0000 0.00000    0.000
x4           0.000000 0.00000   0.0000 0.00000    0.000
(Intercept)  0.000000 0.00000   0.0000 0.00000    0.000</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">colSums</span><span class="p">(</span><span class="n">test</span><span class="o">$</span><span class="n">beta</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<dl class=dl-horizontal>
	<dt>(Intercept)</dt>
		<dd>0</dd>
	<dt>x1</dt>
		<dd>1.96146004299969</dd>
	<dt>x2</dt>
		<dd>-0.16081442311462</dd>
	<dt>x3</dt>
		<dd>4.29328535410661</dd>
	<dt>x4</dt>
		<dd>0</dd>
	<dt>x5</dt>
		<dd>0.281467533823226</dd>
	<dt>x6</dt>
		<dd>0</dd>
	<dt>x7</dt>
		<dd>-0.214314657350521</dd>
	<dt>x8</dt>
		<dd>0</dd>
	<dt>x9</dt>
		<dd>-0.974139610722915</dd>
</dl>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">dim</span><span class="p">(</span><span class="n">model</span><span class="o">$</span><span class="n">beta</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>1000</li>
	<li>60</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[98]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">model</span><span class="o">$</span><span class="n">beta[</span><span class="p">,</span> <span class="m">20</span><span class="n">]</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.00994830787243098
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">model</span><span class="o">$</span><span class="n">beta[</span><span class="p">,</span> <span class="m">50</span><span class="n">]</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.00178724383993779
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">res1</span> <span class="o">=</span> <span class="nf">susie</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">scaled_prior_variance</span> <span class="o">=</span> <span class="m">0.005</span><span class="p">,</span> <span class="n">estimate_prior_method</span> <span class="o">=</span> <span class="s">&quot;optim&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">max</span><span class="p">(</span><span class="n">res1</span><span class="o">$</span><span class="n">pip</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">res2</span> <span class="o">=</span> <span class="nf">readRDS</span><span class="p">(</span><span class="s">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/block_79_137/deletion.genes.block30.for_simu.sample.genes.block_79_137.varbvs.rds&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">names</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>'fit'</li>
	<li>'mu'</li>
	<li>'beta'</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">max</span><span class="p">(</span><span class="n">res2</span><span class="o">$</span><span class="n">fit</span><span class="o">$</span><span class="n">pip</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
0.0269814805603835
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Make input prior as the format of output of SpikeSlabPrior</strong></p>
<p>pi: vector of prior.inclusion.probabilities</p>
<p>b: optional.coefficient.estimate</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>spike.slab.prior Create a spike and slab prior for use with lm.spike.
SpikeSlabPrior(x,
y = NULL,
expected.r2 = .5,
prior.df = .01,
expected.model.size = 1,
prior.information.weight = .01,
diagonal.shrinkage = .5,
optional.coefficient.estimate = NULL,
max.flips = -1,
mean.y = mean(y, na.rm = TRUE),
sdy = sd(as.numeric(y), na.rm = TRUE),
prior.inclusion.probabilities = NULL,
sigma.upper.limit = Inf)

This object is intended for use with logit.spike.
LogitZellnerPrior(
predictors,
successes = NULL,
trials = NULL,
prior.success.probability = NULL,
expected.model.size = 1,
prior.information.weight = .01,
diagonal.shrinkage = .5,
optional.coefficient.estimate = NULL,
max.flips = -1,
prior.inclusion.probabilities = NULL)</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>logit.spike    Spike and slab logistic regression
logit.spike(formula,
niter,
data,
subset,
prior = NULL,
na.action = options("na.action"),
contrasts = NULL,
drop.unused.levels = TRUE,
initial.value = NULL,
ping = niter / 10,
nthreads = 0,
clt.threshold = 2,
mh.chunk.size = 10,
proposal.df = 3,
sampler.weights = c("DA" = .333, "RWM" = .333, "TIM" = .333),
seed = NULL,
...)

lm.spike       Spike and slab regression
lm.spike(formula,
niter,
data,
subset,
prior = NULL,
error.distribution = c("gaussian", "student"),
contrasts = NULL,
drop.unused.levels = TRUE,
model.options = SsvsOptions(),
ping = niter / 10,
seed = NULL,
...)</code></pre>

</div>
</div>
</div>
<hr>
&copy 2016-2017 Min Qiao at <a href="http://xinhelab.org">Xin He lab</a>, The University of Chicago
<p><small>Exported from <a href="http://github.com/gaow/cnv-gene-mapping/blob/3a8885b238d6e24d2e25ff2d630f5047592d174c/dsc/20190909_Boom_Spike_Slab.ipynb"><code>dsc/20190909_Boom_Spike_Slab.ipynb</code></a> committed by minqiao on Thu Oct 3 23:31:12 2019 <a href="http://github.com/gaow/cnv-gene-mapping/commit/3a8885b238d6e24d2e25ff2d630f5047592d174c">revision 7, 3a8885b</a> <a href="https://stephenslab.github.io/ipynb-website/notes.html#Note-about-commit-ids"><span class="fa fa-question-circle"></span></a></small></p>
</div>
</div>
</body>
</html>
