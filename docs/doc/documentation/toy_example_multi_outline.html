<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>toy_example_multi_outline</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>








<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>

 <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>

<style>  /* defined here in case the main.css below cannot be loaded */
.lev1 {margin-left: 80px}
.lev2 {margin-left: 100px}
.lev3 {margin-left: 120px}
.lev4 {margin-left: 140px}
.lev5 {margin-left: 160px}
.lev6 {margin-left: 180px}
</style>

<link rel="stylesheet" type="text/css" href="../../css/jt.css">
<link rel="stylesheet" type="text/css" href="../../css/toc2.css">

<script src="../../js/toc2.js"></script>
<script src="../../js/docs.js"></script>

<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["STIX","TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>

<script>
$( document ).ready(function(){

            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false, 
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }

            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;

            // fire the main function with these parameters


            table_of_contents(cfg,st);

            var file=analysisDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=documentation;
            var pos=documentation.indexOf(file);
        
            for (var a=pos;a>=0;a--){
                  var name=docs[a]
                  $('<li><a href="'+name+'.html">'+name.replace(/_/g," ")+'</a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");


            $('<li id="indexHome"><a href="../../documentation.html"><b>Analysis Home<b></a></li>').insertBefore("#toc-level0 li:eq(0)");
            for (var a=pos+1;a<docs.length;a++){
                  var name=docs[a]
                  $(".toc #toc-level0").append('<li><a href="'+name+'.html">'+name.replace(/_/g," ")+'</a></li>');
            }
            $("#toc-header").hide();

    });
</script>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Toy-example-of-multi-gene-configuration-overlapped-with-multi-CNV">Toy example of multi-gene configuration overlapped with multi-CNV<a class="anchor-link" href="#Toy-example-of-multi-gene-configuration-overlapped-with-multi-CNV">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Simulate-CNVs">Simulate CNVs<a class="anchor-link" href="#Simulate-CNVs">&#182;</a></h4><p>1) Simulate CNV length (number of overlapped genes), following geometric distribution (p=0.5), maximum 10 genes.</p>
<p>2) Simulate CNV start position according to the corresponding length. For example, if a CNV interrupts 5 genes, then it could only start within the first 6 gene position, and the start position is randomly selected among the 6 genes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Assign-CNVs-to-cases-and-controls">Assign CNVs to cases and controls<a class="anchor-link" href="#Assign-CNVs-to-cases-and-controls">&#182;</a></h4><p>1) Set the 5th gene as causal gene.</p>
<p>2) Simulate a random number from standard normal for each CNV. For each CNV interrupts with 5th gene, add a constant 1 to the simulated number.</p>
<p>3) Since longer CNVs are supposed to have higher risk than shorter CNVs, I add a value to the number obtained from 2nd step, which is 0.1*number of covered gene.</p>
<p>4) Calculate the median of all the values obtained from the first three steps; set those larger than median as cases, and the others are controls.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Results">Results<a class="anchor-link" href="#Results">&#182;</a></h3><h4 id="CNV-maximum-length-overlap-with-10-genes;-sample-size-2000;-5th-gene-is-causal">CNV maximum length overlap with 10 genes; sample size 2000; 5th gene is causal<a class="anchor-link" href="#CNV-maximum-length-overlap-with-10-genes;-sample-size-2000;-5th-gene-is-causal">&#182;</a></h4><h4 id="Constant-$0$">Constant $0$<a class="anchor-link" href="#Constant-$0$">&#182;</a></h4><p>1) varbvs</p>

<pre><code>variable       prob PVE    coef    Pr(coef.&gt;0.95)
gene4   0.040238922 NA  0.3292613   [+0.065,+0.583]
gene5   0.037825435 NA  0.3154991   [+0.084,+0.567]
gene3   0.017228166 NA  0.2784136   [+0.025,+0.526]
gene10   0.016860727    NA  0.0000000   [-1.964,+1.983]
gene7   0.006282785 NA  0.1961343   [-0.065,+0.462]

</code></pre>
<p>2) DAP, consumed 1.15s</p>

<pre><code>Posterior expected model size: 0.280 (sd = 0.486)
LogNC = -0.74363 ( Log10NC = -0.323 )
Posterior inclusion probability

1 chr6.100010   9.67567e-02      0.000
2 chr6.100004   6.81672e-02     -0.131
3 chr6.100005   6.24375e-02     -0.173
4 chr6.100003   2.61014e-02     -0.563
5 chr6.100006   6.95827e-03     -1.069
6 chr6.100007   6.23152e-03     -1.117
7 chr6.100002   4.64830e-03     -1.244
8 chr6.100009   3.12758e-03     -1.416
9 chr6.100008   2.85567e-03     -1.455
10 chr6.100001   2.70326e-03     -1.479

</code></pre>
<h4 id="Constant-$0.1$">Constant $0.1$<a class="anchor-link" href="#Constant-$0.1$">&#182;</a></h4><p>1) varbvs</p>

<pre><code>variable    prob    PVE coef    Pr(coef.&gt;0.95)
gene5   0.78612965  NA  0.4906664   [+0.235,+0.732]
gene10   0.03997344 NA  0.0000000   [-1.878,+1.858]
gene3   0.03384508  NA  0.2664869   [+0.006,+0.514]
gene4   0.02159713  NA  0.2448626   [-0.041,+0.541]
gene7   0.01573406  NA  0.2086066   [-0.068,+0.465]

</code></pre>
<p>2) DAP, consumed 1.84s</p>

<pre><code>Posterior expected model size: 1.004 (sd = 0.483)
LogNC = 1.14602 ( Log10NC = 0.498 )
Posterior inclusion probability

1 chr6.100005   7.25925e-01      1.708
2 chr6.100004   1.40245e-01      0.968
3 chr6.100010   9.87981e-02      0.000
4 chr6.100003   2.80659e-02     -0.103
5 chr6.100006   5.51975e-03     -0.349
6 chr6.100007   3.52228e-03     -0.544
7 chr6.100002   1.08403e-03     -1.055

</code></pre>
<h4 id="Constant-$0.5$">Constant $0.5$<a class="anchor-link" href="#Constant-$0.5$">&#182;</a></h4><p>1) varbvs</p>

<pre><code>variable    prob    PVE coef    Pr(coef.&gt;0.95)
gene5   1.00000000  NA  1.0491817   [+0.790,+1.291]
gene7   0.06417755  NA  0.2934619   [+0.040,+0.560]
gene3   0.06116803  NA  0.2843804   [+0.002,+0.539]
gene10   0.04828492 NA  0.0000000   [-1.798,+1.966]
gene2   0.02864481  NA  0.2341940   [-0.044,+0.514]

</code></pre>
<p>2) DAP, consumed 2.31s</p>

<pre><code>Posterior expected model size: 1.193 (sd = 0.429)
LogNC = 24.68358 ( Log10NC = 10.720 )
Posterior inclusion probability

1 chr6.100005   9.98185e-01     12.043
2 chr6.100010   9.94609e-02      0.000
3 chr6.100007   3.88496e-02      1.558
4 chr6.100003   3.85528e-02      1.267
5 chr6.100002   1.78767e-02     -0.525

</code></pre>
<h4 id="Constant-$1.0$">Constant $1.0$<a class="anchor-link" href="#Constant-$1.0$">&#182;</a></h4><p>1) varbvs</p>

<pre><code>variable    prob    PVE coef    Pr(coef.&gt;0.95)
gene5   1.00000000  NA  1.8363550   [+1.578,+2.089]
gene3   0.08170696  NA  0.3087521   [+0.050,+0.589]
gene2   0.06772296  NA  0.3017016   [+0.045,+0.578]
gene10   0.04849084 NA  0.0000000   [-1.955,+1.949]
gene7   0.02220443  NA  0.2107806   [-0.096,+0.485]

</code></pre>
<p>2) DAP, consumed 1.70s</p>

<pre><code>Posterior expected model size: 1.199 (sd = 0.429)
LogNC = 73.39645 ( Log10NC = 31.876 )
Posterior inclusion probability

1 chr6.100005   9.98454e-01     33.195
2 chr6.100010   9.97905e-02      0.000
3 chr6.100003   5.33412e-02      3.068
4 chr6.100002   4.78144e-02      0.287</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="DAP-results-annotation">DAP results annotation<a class="anchor-link" href="#DAP-results-annotation">&#182;</a></h4><p>The last section of the output is the posterior inclusion probabilities (PIP) for top ranked genes, for example, PIP for gene5 is 0.998</p>
<p>The last column gives $\text{log}_{10}$ Bayes factor of the corresponding SNP/gene in single-SNP/gene testing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
