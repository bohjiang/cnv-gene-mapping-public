<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.7" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs/null.min.css"
      type="text/css" />

<script src="../site_libs/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=dscDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=dscArray;
            var docs_map=dscArrayMap;
            var pos=dscArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  $('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  $(".toc #toc-level0").append('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>');
            }
            // $("#toc-header").hide(); // comment out because it prevents search bar from displaying
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Gene Mapping with CNV</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Gene Mapping with CNV</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Overview</a>
</li>
        
<li>
  <a href="../analysis.html">Analysis</a>
</li>
        
<li>
  <a href="../prototype.html">Prototype</a>
</li>
        
<li>
  <a href="../dsc.html">Dsc</a>
</li>
        
<li>
  <a href="../setup/index.html">Setup</a>
</li>
        
<li>
  <a href="../writeup.html">Writeup</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="http://github.com/gaow/cnv-gene-mapping"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Logistic-regression-spike-slab-prior-using-PyMC3">Logistic regression spike slab prior using PyMC3<a class="anchor-link" href="#Logistic-regression-spike-slab-prior-using-PyMC3">&#182;</a></h1><p>Previously we have tried BoomSpikeSlab and LogitBvs R packages to fit spike slab model for logistic regression but didn't get anywhere the way we want (FIXME: add link). Now I'm looking at some customized options. According to <a href="https://www.kaggle.com/melondonkey/bayesian-spike-and-slab-in-pymc3">this post</a>, <code>stan</code> cannot handle spike slab model because it is not discrete. The post implements a <code>PyMC3</code> based sampler that looks neat enough so I'm trying to use it for our problem here.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Indeed discrete prior might also be not optimal for <code>PyMC3</code>, as pointed out <a href="https://www.kaggle.com/derekpowll/bayesian-lr-w-cauchy-prior-in-pymc3">in this notebook</a>. I think we can also try a spiky normal plus a slab normal mixture -- at least they will be continous there.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Software-required">Software required<a class="anchor-link" href="#Software-required">&#182;</a></h2>
<pre><code>pip install pymc3 -U
pip install mkl-service</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">])</span>
<span class="n">MU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="n">SIGMA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">component</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">MU</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">component</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([0, 1, 1, 1, 0, 1, 1, 0, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">MU</span><span class="p">[</span><span class="n">component</span><span class="p">],</span> <span class="n">SIGMA</span><span class="p">[</span><span class="n">component</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([ 0.76397154,  1.99545767,  2.1173305 ,  2.23544477, -1.28675726,
        0.39846262,  2.03269792, -0.19665662,  3.33318123,  1.89974938])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([1., 1.])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mixture-normal-distribution">Mixture normal distribution<a class="anchor-link" href="#Mixture-normal-distribution">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mixture normal distribution 1</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">components</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">components</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[51]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[0, 0, 0, 0, 0, 0, 0, 1, 0, 0]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">mus</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.777</span><span class="p">]</span>
<span class="n">sds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.844</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="p">[</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.777</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.844</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">components</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[53]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[array([1.28720023]),
 array([0.64809114]),
 array([-0.3611226]),
 array([-0.45568501]),
 array([1.21371894]),
 array([-1.44743445]),
 array([-0.33758135]),
 array([0.53345844]),
 array([1.1999563]),
 array([-0.07242969])]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mixture normal distribution 2</p>
<p><a href="https://stackoverflow.com/questions/47759577/creating-a-mixture-of-probability-distributions-for-sampling/47763145">link</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">distributions</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="mf">0.777</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="mf">0.844</span><span class="p">}}]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">coefficients</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[81]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([0.95, 0.05])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">num_distr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">distributions</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">num_distr</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">distr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">distributions</span><span class="p">):</span>
    <span class="n">data</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">distr</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">](</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">sample_size</span><span class="p">,),</span> <span class="o">**</span><span class="n">distr</span><span class="p">[</span><span class="s2">&quot;kwargs&quot;</span><span class="p">])</span>
<span class="n">random_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_distr</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">coefficients</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sample_size</span><span class="p">),</span> <span class="n">random_idx</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[91]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[-0.09237664,  0.17136483],
       [-0.73917917,  0.39410428],
       [ 0.71290654, -0.27170287],
       [-1.36621545,  0.42736131],
       [ 1.78552146,  0.59895483],
       [ 0.8076554 ,  0.94463695],
       [ 0.34226721, -1.42798862],
       [ 0.61487827,  0.02921961],
       [ 1.84703846,  2.0127458 ],
       [-0.35777455,  0.22689052]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">random_idx</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[92]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 1])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">sample</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[93]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([-0.09237664, -0.73917917,  0.71290654, -1.36621545,  1.78552146,
        0.8076554 ,  0.34226721,  0.61487827,  1.84703846,  0.22689052])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-X-and-y">Import X and y<a class="anchor-link" href="#Import-X-and-y">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;/home/min/GIT/cnv-gene-mapping/data&quot;</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">739</span>
<span class="n">end</span> <span class="o">=</span> <span class="mi">743</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">X_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{cwd}/deletion_simu/block_{start}_{end}/deletion.genes.block30.for_simu.sample.genes.block_{start}_{end}.gz&#39;</span>
<span class="n">y_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{cwd}/deletion_simu/deletion.genes.block30.for_simu.sample.y&#39;</span>
<span class="n">fisher_f</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{cwd}/deletion_simu/deletion.genes.block30.for_simu.sample.genes.block1.fisher.gz&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fisher_f</span><span class="p">,</span> <span class="n">compression</span> <span class="o">=</span> <span class="s2">&quot;gzip&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>274</td>
      <td>gene_742</td>
      <td>16</td>
      <td>6690</td>
      <td>4</td>
      <td>6702</td>
      <td>0.011757</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1384</td>
      <td>gene_743</td>
      <td>5</td>
      <td>6701</td>
      <td>3</td>
      <td>6703</td>
      <td>0.726481</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2184</td>
      <td>gene_744</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2185</td>
      <td>gene_741</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2186</td>
      <td>gene_740</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">y_file</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(13412,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">X_file</span><span class="p">,</span> <span class="n">compression</span> <span class="o">=</span> <span class="s2">&quot;gzip&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(13412, 5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0     5.0
1     5.0
2    20.0
3     8.0
4     5.0
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is 13K samples 14 features for the CNV problem.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-specification">Model specification<a class="anchor-link" href="#Model-specification">&#182;</a></h2><p>That is, to specify <strong>how the data is generated</strong>. Specifically it is about setting up the spike slab prior for logistic model, $$b\sim \pi_0 \delta_0 + (1-\pi_0)N(\mu, \sigma^2)$$ where from <code>varbvs</code> analysis, $\pi_0 = 0.043, \mu = 0.77, \sigma = 0.84$.</p>
<p>For intercept since for centered data it has interpretation of baseline odds ratio, I'm giving it a normal prior $N(0, 1.5)$ to roughly cover the span of baseline odds 0.05 (log odds about -3), for a not so rare disease.</p>
<p><strong>Question: how should we handle intercept? How did <code>varbvs</code> handle intercept?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">pi_varbvs</span> <span class="o">=</span> <span class="mf">0.0437754961218526</span>
<span class="n">mu_varbvs</span> <span class="o">=</span> <span class="mf">0.777072111580423</span>
<span class="n">si_varbvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.711745609189383</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Spike-and-Slab-model">Spike and Slab model<a class="anchor-link" href="#Spike-and-Slab-model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="kn">import</span> <span class="nn">pymc3</span> <span class="kn">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="kn">as</span> <span class="nn">tt</span>

<span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">pi0</span> <span class="o">=</span> <span class="n">pi_varbvs</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">mu_varbvs</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">si_varbvs</span><span class="p">,</span> <span class="n">mu_intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.05</span><span class="o">/</span><span class="mf">0.95</span><span class="p">),</span> <span class="n">sigma_intercept</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">):</span>
    <span class="n">invlogit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tt</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">model</span><span class="p">:</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Bernoulli</span><span class="p">(</span><span class="s1">&#39;xi&#39;</span><span class="p">,</span> <span class="n">pi0</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#inclusion probability for each variable</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">mu_intercept</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">sigma_intercept</span><span class="p">)</span> <span class="c1"># Intercept</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#Prior for the non-zero coefficients</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">xi</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span> <span class="c1">#Deterministic function to map the stochastics to the output</span>
        <span class="n">y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Bernoulli</span><span class="p">(</span><span class="s1">&#39;y_obs&#39;</span><span class="p">,</span> <span class="n">invlogit</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">observed</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>  <span class="c1">#Data likelihood</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>




<div class="output_latex output_subarea output_execute_result">
$$
            \begin{array}{rcl}
            \text{xi} &\sim & \text{Bernoulli}(\mathit{p}=0.0437754961218526)\\\text{alpha} &\sim & \text{Normal}(\mathit{mu}=-2.9444389791664403,~\mathit{sigma}=0.01)\\\text{beta} &\sim & \text{Normal}(\mathit{mu}=0.777072111580423,~\mathit{sigma}=0.8436501699101251)\\\text{y_obs} &\sim & \text{Bernoulli}(\mathit{p}=f(f(),~f(f(),~f(f(f(f(array,~f(\text{xi},~\text{beta})),~f(\text{alpha})))))))
            \end{array}
            $$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sampling">Sampling<a class="anchor-link" href="#Sampling">&#182;</a></h2><p>Need to read additional <code>PyMC3</code> documentation to do proper sampling diagnostics, but generally it helps to use multiple chains.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1"># Here I use 20 cores on my 40 core machine, with 10 chains, to generate 2000 samples.</span>
<span class="c1"># Takes 50min on my desktop</span>
<span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">random_seed</span> <span class="o">=</span> <span class="mi">999</span><span class="p">,</span> <span class="kp">cores</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">progressbar</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">chains</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Sequential sampling (1 chains in 1 job)
CompoundStep
&gt;BinaryGibbsMetropolis: [xi]
&gt;NUTS: [beta, alpha]
100%|██████████| 2500/2500 [01:17&lt;00:00, 32.11it/s]
Only one chain was sampled, this makes it impossible to run some convergence checks
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Results">Results<a class="anchor-link" href="#Results">&#182;</a></h2><p>This will summarize samples generated to posterior quantities including PIP, $\tilde{b}$ and $\tilde{\mu}$ ($b$ given inclusion, $\xi=1$).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">trace</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">]),</span>
                        <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">],</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;xi&quot;</span><span class="p">])),</span>
                        <span class="s1">&#39;beta_given_inclusion&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">trace</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">trace</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">trace</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">])</span>
                        <span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[30]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>1.0000</td>
      <td>2.985224</td>
      <td>2.985224</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0790</td>
      <td>0.090412</td>
      <td>1.144460</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0345</td>
      <td>0.013819</td>
      <td>0.400536</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0325</td>
      <td>0.011673</td>
      <td>0.359161</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0280</td>
      <td>0.014475</td>
      <td>0.516956</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">pm</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>mc_error</th>
      <th>hpd_2.5</th>
      <th>hpd_97.5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>xi__0</td>
      <td>0.022000</td>
      <td>0.146683</td>
      <td>0.003763</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>xi__1</td>
      <td>0.039500</td>
      <td>0.194781</td>
      <td>0.004433</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>xi__2</td>
      <td>0.470000</td>
      <td>0.499099</td>
      <td>0.011489</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <td>xi__3</td>
      <td>0.019500</td>
      <td>0.138274</td>
      <td>0.003154</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>xi__4</td>
      <td>0.023500</td>
      <td>0.151485</td>
      <td>0.003497</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>alpha</td>
      <td>-0.001069</td>
      <td>0.017164</td>
      <td>0.000361</td>
      <td>-0.033539</td>
      <td>0.031783</td>
    </tr>
    <tr>
      <td>beta__0</td>
      <td>0.769954</td>
      <td>0.828415</td>
      <td>0.018496</td>
      <td>-0.886062</td>
      <td>2.319919</td>
    </tr>
    <tr>
      <td>beta__1</td>
      <td>0.773492</td>
      <td>0.849241</td>
      <td>0.018786</td>
      <td>-0.832353</td>
      <td>2.454229</td>
    </tr>
    <tr>
      <td>beta__2</td>
      <td>1.002387</td>
      <td>0.707638</td>
      <td>0.017866</td>
      <td>-0.421315</td>
      <td>2.348060</td>
    </tr>
    <tr>
      <td>beta__3</td>
      <td>0.806046</td>
      <td>0.824134</td>
      <td>0.018227</td>
      <td>-0.835216</td>
      <td>2.351347</td>
    </tr>
    <tr>
      <td>beta__4</td>
      <td>0.758471</td>
      <td>0.828696</td>
      <td>0.018647</td>
      <td>-0.938903</td>
      <td>2.334827</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mixture-normal-model">Mixture normal model<a class="anchor-link" href="#Mixture-normal-model">&#182;</a></h2><p><a href="https://docs.pymc.io/notebooks/api_quickstart.html">link</a></p>
<p><a href="https://www.ritchievink.com/blog/2018/06/05/clustering-data-with-dirichlet-mixtures-in-edward-and-pymc3/">link 2</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="kn">import</span> <span class="nn">pymc3</span> <span class="kn">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="kn">as</span> <span class="nn">tt</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="n">w_mix</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">floatX</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="n">pi_varbvs</span><span class="p">,</span> <span class="n">pi_varbvs</span><span class="p">])</span>
<span class="n">mu_mix</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">floatX</span><span class="p">([</span><span class="n">mu2</span><span class="p">,</span> <span class="n">mu_varbvs</span><span class="p">])</span>
<span class="n">sigma_mix</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">floatX</span><span class="p">([</span><span class="n">sigma2</span><span class="p">,</span> <span class="n">si_varbvs</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">get_mix_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">mu_intercept</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma_intercept</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">):</span>
    <span class="n">invlogit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tt</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">model</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">mu_intercept</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">sigma_intercept</span><span class="p">)</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">NormalMixture</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">w_mix</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">mu_mix</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma_mix</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
        <span class="n">y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Bernoulli</span><span class="p">(</span><span class="s1">&#39;y_obs&#39;</span><span class="p">,</span> <span class="n">invlogit</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">observed</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">get_mix_model</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">model1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_latex output_subarea output_execute_result">
$$
            \begin{array}{rcl}
            \text{alpha} &\sim & \text{Normal}(\mathit{mu}=0.0,~\mathit{sigma}=1.5)\\\text{beta} &\sim & \text{NormalMixture}(\mathit{w}=array,~\mathit{mu}=array,~\mathit{sigma}=array)\\\text{y_obs} &\sim & \text{Bernoulli}(\mathit{p}=f(f(),~f(f(),~f(f(f(f(array,~\text{beta}),~f(\text{alpha})))))))
            \end{array}
            $$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sampling">Sampling<a class="anchor-link" href="#Sampling">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="k">with</span> <span class="n">model1</span><span class="p">:</span>
    <span class="n">trace1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">random_seed</span> <span class="o">=</span> <span class="mi">999</span><span class="p">,</span> <span class="kp">cores</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">progressbar</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">chains</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Sequential sampling (1 chains in 1 job)
NUTS: [beta, alpha]
100%|██████████| 2500/2500 [00:47&lt;00:00, 52.42it/s]
Only one chain was sampled, this makes it impossible to run some convergence checks
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Results">Results<a class="anchor-link" href="#Results">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">pm</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[38]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>mc_error</th>
      <th>hpd_2.5</th>
      <th>hpd_97.5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>alpha</td>
      <td>-0.001635</td>
      <td>0.017740</td>
      <td>0.000338</td>
      <td>-0.035965</td>
      <td>0.033394</td>
    </tr>
    <tr>
      <td>beta__0</td>
      <td>0.036425</td>
      <td>0.756459</td>
      <td>0.014511</td>
      <td>-1.282890</td>
      <td>1.605263</td>
    </tr>
    <tr>
      <td>beta__1</td>
      <td>0.058020</td>
      <td>0.764307</td>
      <td>0.015561</td>
      <td>-1.371872</td>
      <td>1.564398</td>
    </tr>
    <tr>
      <td>beta__2</td>
      <td>1.201155</td>
      <td>0.464218</td>
      <td>0.009858</td>
      <td>0.368932</td>
      <td>2.162282</td>
    </tr>
    <tr>
      <td>beta__3</td>
      <td>0.278193</td>
      <td>0.639481</td>
      <td>0.014458</td>
      <td>-0.983561</td>
      <td>1.507265</td>
    </tr>
    <tr>
      <td>beta__4</td>
      <td>0.064904</td>
      <td>0.756572</td>
      <td>0.016012</td>
      <td>-1.443134</td>
      <td>1.465203</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">results1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="c1">#&#39;inclusion_probability&#39;: np.apply_along_axis(np.mean, 0, trace1[&#39;xi&#39;]),</span>
                         <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">trace1</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]),})</span>
                         <span class="c1">#&#39;beta_given_inclusion&#39;: np.apply_along_axis(np.sum, 0, trace1[&#39;xi&#39;]*trace1[&#39;beta&#39;]) / np.apply_along_axis(np.sum, 0, trace1[&#39;xi&#39;])})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">results1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[40]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>beta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.036425</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.058020</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.201155</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.278193</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.064904</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">trace1</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">][:</span><span class="mi">20</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[46]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[ 0.57544786, -0.83577541,  1.00803471,  0.90092193,  0.5007824 ],
       [ 0.53493692, -0.73696289,  0.74450684,  1.08871973,  0.62139148],
       [-0.53655792, -1.81085826,  1.56537819,  0.7579375 ,  0.45450664],
       [ 0.28066971, -0.54830376,  1.47187974,  1.06650231,  0.04784993],
       [ 1.02154957, -0.34109855,  1.11824843,  0.67996458, -0.32189377],
       [ 0.07639977,  1.7270387 ,  1.21956114, -0.15765375,  0.93010689],
       [-0.09135544,  0.93185076,  1.32433051,  0.26501064,  0.613627  ],
       [-0.09202819, -0.78502477,  0.89406565, -0.18790993,  0.15688979],
       [ 0.77443531,  0.23094802,  0.91258328,  0.55355652,  0.49466225],
       [ 1.02393264, -0.116118  ,  1.41482005,  0.82841188, -0.34933298],
       [ 1.6052633 , -0.46625997,  0.60527141, -0.13718251, -0.6633943 ],
       [-1.20039427, -0.3512295 ,  1.37466886,  0.82097067, -0.36497798],
       [ 0.59981736, -0.11575713,  0.95179546, -0.87212803, -0.3211485 ],
       [-1.21500965, -0.29185475,  1.10558614,  0.91309939, -0.13213086],
       [-1.21500965, -0.29185475,  1.10558614,  0.91309939, -0.13213086],
       [-0.6218663 , -0.49760203,  1.14179447,  1.02506239,  1.19065704],
       [ 0.03419999,  0.83696434,  0.8352372 , -0.1152659 , -0.95230753],
       [-0.77259998, -1.10411765,  1.28687226,  0.30134796,  0.86205695],
       [ 0.39350823,  0.46733192,  1.21966051,  0.50812087,  1.1546139 ],
       [-0.30294045,  0.55414534,  1.01669571,  0.53625888,  0.10938986]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">trace1</span><span class="p">[</span><span class="s2">&quot;xi&quot;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mixture-normal-model-2">Mixture normal model 2<a class="anchor-link" href="#Mixture-normal-model-2">&#182;</a></h2><p>Difference between multidimensional Gaussian (multivariate Gaussian) and Mixture normal <a href="https://stats.stackexchange.com/questions/319954/whats-the-difference-between-multivariate-gaussian-and-mixture-of-gaussians">link</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="kn">import</span> <span class="nn">pymc3</span> <span class="kn">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="kn">as</span> <span class="nn">tt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">bernoulli</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mf">1e-6</span>

<span class="k">def</span> <span class="nf">get_mix_model2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">mu_intercept</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma_intercept</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">):</span>
    <span class="n">invlogit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tt</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">model</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">mu_intercept</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="n">sigma_intercept</span><span class="p">)</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Bernoulli</span><span class="p">(</span><span class="s1">&#39;xi&#39;</span><span class="p">,</span> <span class="n">pi_varbvs</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">beta1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;beta1&quot;</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">beta2</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;beta2&quot;</span><span class="p">,</span> <span class="n">mu_varbvs</span><span class="p">,</span> <span class="n">si_varbvs</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">xi</span><span class="o">*</span><span class="n">beta1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">xi</span><span class="p">)</span><span class="o">*</span><span class="n">beta2</span><span class="p">)</span>
        <span class="n">y_obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Bernoulli</span><span class="p">(</span><span class="s1">&#39;y_obs&#39;</span><span class="p">,</span> <span class="n">invlogit</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">),</span> <span class="n">observed</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">get_mix_model2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">model2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[55]:</div>




<div class="output_latex output_subarea output_execute_result">
$$
            \begin{array}{rcl}
            \text{alpha} &\sim & \text{Normal}(\mathit{mu}=0.0,~\mathit{sigma}=1.5)\\\text{xi} &\sim & \text{Bernoulli}(\mathit{p}=0.0437754961218526)\\\text{beta1} &\sim & \text{Normal}(\mathit{mu}=0.0,~\mathit{sigma}=1e-06)\\\text{beta2} &\sim & \text{Normal}(\mathit{mu}=0.777072111580423,~\mathit{sigma}=0.8436501699101251)\\\text{y_obs} &\sim & \text{Bernoulli}(\mathit{p}=f(f(),~f(f(),~f(f(f(f(array,~f(f(\text{xi},~\text{beta1}),~f(f(f(),~\text{xi}),~\text{beta2}))),~f(\text{alpha})))))))
            \end{array}
            $$
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="k">with</span> <span class="n">model2</span><span class="p">:</span>
    <span class="n">trace2</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">random_seed</span> <span class="o">=</span> <span class="mi">999</span><span class="p">,</span> <span class="kp">cores</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">progressbar</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">chains</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>Sequential sampling (1 chains in 1 job)
CompoundStep
&gt;NUTS: [beta2, beta1, alpha]
&gt;BinaryGibbsMetropolis: [xi]
100%|██████████| 2500/2500 [01:43&lt;00:00, 24.23it/s]
Only one chain was sampled, this makes it impossible to run some convergence checks
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">pm</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[57]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>mc_error</th>
      <th>hpd_2.5</th>
      <th>hpd_97.5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>alpha</td>
      <td>-1.792694e-03</td>
      <td>1.633489e-02</td>
      <td>2.424184e-04</td>
      <td>-0.036442</td>
      <td>0.027095</td>
    </tr>
    <tr>
      <td>xi__0</td>
      <td>6.050000e-02</td>
      <td>2.384109e-01</td>
      <td>6.793195e-03</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <td>xi__1</td>
      <td>6.850000e-02</td>
      <td>2.526020e-01</td>
      <td>6.190921e-03</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <td>xi__2</td>
      <td>8.000000e-03</td>
      <td>8.908423e-02</td>
      <td>2.204541e-03</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>xi__3</td>
      <td>7.850000e-02</td>
      <td>2.689568e-01</td>
      <td>7.976685e-03</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <td>xi__4</td>
      <td>7.550000e-02</td>
      <td>2.641964e-01</td>
      <td>7.697240e-03</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <td>beta1__0</td>
      <td>-2.850403e-08</td>
      <td>1.001414e-06</td>
      <td>1.455378e-08</td>
      <td>-0.000002</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <td>beta1__1</td>
      <td>-2.006287e-08</td>
      <td>9.630560e-07</td>
      <td>1.521084e-08</td>
      <td>-0.000002</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <td>beta1__2</td>
      <td>-1.046630e-08</td>
      <td>9.851710e-07</td>
      <td>1.594965e-08</td>
      <td>-0.000002</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <td>beta1__3</td>
      <td>1.344149e-08</td>
      <td>1.025941e-06</td>
      <td>1.511805e-08</td>
      <td>-0.000002</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <td>beta1__4</td>
      <td>-8.524219e-09</td>
      <td>1.001885e-06</td>
      <td>1.509703e-08</td>
      <td>-0.000002</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <td>beta2__0</td>
      <td>1.049455e-01</td>
      <td>8.210894e-01</td>
      <td>1.448093e-02</td>
      <td>-1.541178</td>
      <td>1.705234</td>
    </tr>
    <tr>
      <td>beta2__1</td>
      <td>9.951122e-02</td>
      <td>8.312969e-01</td>
      <td>1.372516e-02</td>
      <td>-1.397382</td>
      <td>1.800130</td>
    </tr>
    <tr>
      <td>beta2__2</td>
      <td>1.211892e+00</td>
      <td>4.813717e-01</td>
      <td>7.670829e-03</td>
      <td>0.260755</td>
      <td>2.110489</td>
    </tr>
    <tr>
      <td>beta2__3</td>
      <td>3.359027e-01</td>
      <td>7.087585e-01</td>
      <td>1.243311e-02</td>
      <td>-1.034393</td>
      <td>1.762568</td>
    </tr>
    <tr>
      <td>beta2__4</td>
      <td>1.252870e-01</td>
      <td>8.015261e-01</td>
      <td>1.482588e-02</td>
      <td>-1.385974</td>
      <td>1.769432</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">results2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">trace2</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">])})</span>
                         <span class="c1">#&#39;beta&#39;: np.apply_along_axis(np.mean, 0, trace2[&#39;beta&#39;]),})</span>
                         <span class="c1">#&#39;beta_given_inclusion&#39;: np.apply_along_axis(np.sum, 0, trace2[&#39;xi&#39;]*trace2[&#39;beta&#39;]) / np.apply_along_axis(np.sum, 0, trace2[&#39;xi&#39;])})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">results2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[61]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.0605</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0685</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0080</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0785</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0755</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">trace2</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[49]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([0, 1, 2, 3, 4])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([1., 1., 1., 1., 1.])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[578]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## 2177_2182</span>
<span class="c1">## 1,2,3</span>
<span class="c1">## 2.51, 1.78, 0.60</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[578]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>0.4660</td>
      <td>1.368539</td>
      <td>2.058897</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.4525</td>
      <td>1.369640</td>
      <td>2.071297</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.4130</td>
      <td>1.294798</td>
      <td>2.016943</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.3945</td>
      <td>1.264112</td>
      <td>1.949095</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0690</td>
      <td>0.822499</td>
      <td>1.056799</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0665</td>
      <td>0.817413</td>
      <td>1.019666</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[579]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[579]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>38</td>
      <td>gene_2180</td>
      <td>56</td>
      <td>6650</td>
      <td>0</td>
      <td>6706</td>
      <td>2.473296e-17</td>
      <td>2</td>
    </tr>
    <tr>
      <td>39</td>
      <td>gene_2178</td>
      <td>56</td>
      <td>6650</td>
      <td>0</td>
      <td>6706</td>
      <td>2.473296e-17</td>
      <td>0</td>
    </tr>
    <tr>
      <td>40</td>
      <td>gene_2179</td>
      <td>56</td>
      <td>6650</td>
      <td>0</td>
      <td>6706</td>
      <td>2.473296e-17</td>
      <td>1</td>
    </tr>
    <tr>
      <td>41</td>
      <td>gene_2181</td>
      <td>56</td>
      <td>6650</td>
      <td>0</td>
      <td>6706</td>
      <td>2.473296e-17</td>
      <td>3</td>
    </tr>
    <tr>
      <td>71</td>
      <td>gene_2182</td>
      <td>24</td>
      <td>6682</td>
      <td>0</td>
      <td>6706</td>
      <td>1.167770e-07</td>
      <td>4</td>
    </tr>
    <tr>
      <td>72</td>
      <td>gene_2183</td>
      <td>24</td>
      <td>6682</td>
      <td>0</td>
      <td>6706</td>
      <td>1.167770e-07</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[556]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## 2092_2099</span>
<span class="c1">## 0,2,6</span>
<span class="c1">## 0.18, 1.71, 0.47</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[556]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>0.8390</td>
      <td>1.290242</td>
      <td>1.388613</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0785</td>
      <td>0.789153</td>
      <td>0.933225</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0680</td>
      <td>0.799668</td>
      <td>1.035229</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0635</td>
      <td>0.784478</td>
      <td>0.960614</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0605</td>
      <td>0.784214</td>
      <td>0.768279</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0565</td>
      <td>0.780303</td>
      <td>0.741498</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0260</td>
      <td>0.747943</td>
      <td>0.092032</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0235</td>
      <td>0.761483</td>
      <td>0.111491</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[557]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[557]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>108</td>
      <td>gene_2095</td>
      <td>36</td>
      <td>6670</td>
      <td>8</td>
      <td>6698</td>
      <td>0.000025</td>
      <td>2</td>
    </tr>
    <tr>
      <td>121</td>
      <td>gene_2096</td>
      <td>37</td>
      <td>6669</td>
      <td>12</td>
      <td>6694</td>
      <td>0.000459</td>
      <td>3</td>
    </tr>
    <tr>
      <td>122</td>
      <td>gene_2097</td>
      <td>37</td>
      <td>6669</td>
      <td>12</td>
      <td>6694</td>
      <td>0.000459</td>
      <td>4</td>
    </tr>
    <tr>
      <td>123</td>
      <td>gene_2098</td>
      <td>37</td>
      <td>6669</td>
      <td>12</td>
      <td>6694</td>
      <td>0.000459</td>
      <td>5</td>
    </tr>
    <tr>
      <td>268</td>
      <td>gene_2100</td>
      <td>28</td>
      <td>6678</td>
      <td>11</td>
      <td>6695</td>
      <td>0.009374</td>
      <td>7</td>
    </tr>
    <tr>
      <td>269</td>
      <td>gene_2099</td>
      <td>28</td>
      <td>6678</td>
      <td>11</td>
      <td>6695</td>
      <td>0.009374</td>
      <td>6</td>
    </tr>
    <tr>
      <td>291</td>
      <td>gene_2094</td>
      <td>9</td>
      <td>6697</td>
      <td>1</td>
      <td>6705</td>
      <td>0.021439</td>
      <td>1</td>
    </tr>
    <tr>
      <td>293</td>
      <td>gene_2093</td>
      <td>9</td>
      <td>6697</td>
      <td>1</td>
      <td>6705</td>
      <td>0.021439</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[513]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 1858_1875</span>
<span class="c1">## real 14</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[513]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>14</td>
      <td>0.1635</td>
      <td>0.885465</td>
      <td>1.445334</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.1415</td>
      <td>0.873469</td>
      <td>1.438782</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0950</td>
      <td>0.808904</td>
      <td>1.114097</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.0910</td>
      <td>0.799450</td>
      <td>1.168663</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0900</td>
      <td>0.805384</td>
      <td>1.061036</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0900</td>
      <td>0.806278</td>
      <td>1.133716</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.0895</td>
      <td>0.811432</td>
      <td>1.072543</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.0870</td>
      <td>0.809282</td>
      <td>1.182747</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.0830</td>
      <td>0.776091</td>
      <td>1.053188</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0810</td>
      <td>0.827899</td>
      <td>1.242092</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0810</td>
      <td>0.806535</td>
      <td>1.242010</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0800</td>
      <td>0.811711</td>
      <td>1.300500</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0780</td>
      <td>0.798235</td>
      <td>1.141132</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0780</td>
      <td>0.798494</td>
      <td>1.135631</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0310</td>
      <td>0.750434</td>
      <td>0.447150</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0310</td>
      <td>0.777832</td>
      <td>0.583112</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0295</td>
      <td>0.782552</td>
      <td>0.548759</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0275</td>
      <td>0.775015</td>
      <td>0.365444</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[514]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[514]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>283</td>
      <td>gene_1873</td>
      <td>7</td>
      <td>6699</td>
      <td>0</td>
      <td>6706</td>
      <td>0.015601</td>
      <td>14</td>
    </tr>
    <tr>
      <td>284</td>
      <td>gene_1872</td>
      <td>7</td>
      <td>6699</td>
      <td>0</td>
      <td>6706</td>
      <td>0.015601</td>
      <td>13</td>
    </tr>
    <tr>
      <td>362</td>
      <td>gene_1859</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>0</td>
    </tr>
    <tr>
      <td>365</td>
      <td>gene_1874</td>
      <td>10</td>
      <td>6696</td>
      <td>2</td>
      <td>6704</td>
      <td>0.038490</td>
      <td>15</td>
    </tr>
    <tr>
      <td>370</td>
      <td>gene_1869</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>10</td>
    </tr>
    <tr>
      <td>371</td>
      <td>gene_1868</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>9</td>
    </tr>
    <tr>
      <td>372</td>
      <td>gene_1867</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>8</td>
    </tr>
    <tr>
      <td>373</td>
      <td>gene_1866</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>7</td>
    </tr>
    <tr>
      <td>374</td>
      <td>gene_1865</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>6</td>
    </tr>
    <tr>
      <td>375</td>
      <td>gene_1864</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>5</td>
    </tr>
    <tr>
      <td>377</td>
      <td>gene_1863</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>4</td>
    </tr>
    <tr>
      <td>387</td>
      <td>gene_1862</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>3</td>
    </tr>
    <tr>
      <td>390</td>
      <td>gene_1871</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>12</td>
    </tr>
    <tr>
      <td>403</td>
      <td>gene_1870</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>11</td>
    </tr>
    <tr>
      <td>1616</td>
      <td>gene_1860</td>
      <td>1</td>
      <td>6705</td>
      <td>1</td>
      <td>6705</td>
      <td>1.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1617</td>
      <td>gene_1861</td>
      <td>2</td>
      <td>6704</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1618</td>
      <td>gene_1875</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>16</td>
    </tr>
    <tr>
      <td>1619</td>
      <td>gene_1876</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[408]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 1561_1579</span>
<span class="c1">## real 13,16</span>
<span class="c1">## effect 0.23,0.86</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[408]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>12</td>
      <td>0.2755</td>
      <td>0.718949</td>
      <td>0.560040</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.2190</td>
      <td>0.906800</td>
      <td>1.376750</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.1820</td>
      <td>0.777204</td>
      <td>0.807678</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.1285</td>
      <td>0.751887</td>
      <td>0.491896</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.1270</td>
      <td>0.725241</td>
      <td>0.488526</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.1125</td>
      <td>0.731549</td>
      <td>0.467664</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.1060</td>
      <td>0.739430</td>
      <td>0.466607</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0915</td>
      <td>0.737306</td>
      <td>0.426145</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0780</td>
      <td>0.779866</td>
      <td>0.808950</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.0355</td>
      <td>0.765793</td>
      <td>0.475941</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0300</td>
      <td>0.737081</td>
      <td>-0.215119</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0290</td>
      <td>0.733199</td>
      <td>-0.242040</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0265</td>
      <td>0.775239</td>
      <td>0.393628</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0265</td>
      <td>0.762716</td>
      <td>-0.163621</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0260</td>
      <td>0.743394</td>
      <td>-0.433540</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0250</td>
      <td>0.763786</td>
      <td>-0.272430</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0230</td>
      <td>0.773202</td>
      <td>0.334522</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0215</td>
      <td>0.754816</td>
      <td>0.213489</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0210</td>
      <td>0.752818</td>
      <td>-0.260079</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[409]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[409]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>118</td>
      <td>gene_1574</td>
      <td>114</td>
      <td>6592</td>
      <td>65</td>
      <td>6641</td>
      <td>0.000281</td>
      <td>12</td>
    </tr>
    <tr>
      <td>119</td>
      <td>gene_1575</td>
      <td>120</td>
      <td>6586</td>
      <td>71</td>
      <td>6635</td>
      <td>0.000439</td>
      <td>13</td>
    </tr>
    <tr>
      <td>120</td>
      <td>gene_1576</td>
      <td>120</td>
      <td>6586</td>
      <td>71</td>
      <td>6635</td>
      <td>0.000439</td>
      <td>14</td>
    </tr>
    <tr>
      <td>137</td>
      <td>gene_1572</td>
      <td>114</td>
      <td>6592</td>
      <td>68</td>
      <td>6638</td>
      <td>0.000740</td>
      <td>10</td>
    </tr>
    <tr>
      <td>138</td>
      <td>gene_1573</td>
      <td>114</td>
      <td>6592</td>
      <td>68</td>
      <td>6638</td>
      <td>0.000740</td>
      <td>11</td>
    </tr>
    <tr>
      <td>142</td>
      <td>gene_1578</td>
      <td>43</td>
      <td>6663</td>
      <td>17</td>
      <td>6689</td>
      <td>0.001039</td>
      <td>16</td>
    </tr>
    <tr>
      <td>143</td>
      <td>gene_1571</td>
      <td>106</td>
      <td>6600</td>
      <td>63</td>
      <td>6643</td>
      <td>0.001088</td>
      <td>9</td>
    </tr>
    <tr>
      <td>191</td>
      <td>gene_1577</td>
      <td>76</td>
      <td>6630</td>
      <td>44</td>
      <td>6662</td>
      <td>0.004281</td>
      <td>15</td>
    </tr>
    <tr>
      <td>285</td>
      <td>gene_1568</td>
      <td>54</td>
      <td>6652</td>
      <td>31</td>
      <td>6675</td>
      <td>0.016170</td>
      <td>6</td>
    </tr>
    <tr>
      <td>286</td>
      <td>gene_1570</td>
      <td>54</td>
      <td>6652</td>
      <td>31</td>
      <td>6675</td>
      <td>0.016170</td>
      <td>8</td>
    </tr>
    <tr>
      <td>287</td>
      <td>gene_1569</td>
      <td>54</td>
      <td>6652</td>
      <td>31</td>
      <td>6675</td>
      <td>0.016170</td>
      <td>7</td>
    </tr>
    <tr>
      <td>292</td>
      <td>gene_1580</td>
      <td>9</td>
      <td>6697</td>
      <td>1</td>
      <td>6705</td>
      <td>0.021439</td>
      <td>18</td>
    </tr>
    <tr>
      <td>333</td>
      <td>gene_1579</td>
      <td>18</td>
      <td>6688</td>
      <td>6</td>
      <td>6700</td>
      <td>0.022538</td>
      <td>17</td>
    </tr>
    <tr>
      <td>1269</td>
      <td>gene_1566</td>
      <td>2</td>
      <td>6704</td>
      <td>4</td>
      <td>6702</td>
      <td>0.687430</td>
      <td>4</td>
    </tr>
    <tr>
      <td>1272</td>
      <td>gene_1567</td>
      <td>2</td>
      <td>6704</td>
      <td>4</td>
      <td>6702</td>
      <td>0.687430</td>
      <td>5</td>
    </tr>
    <tr>
      <td>1282</td>
      <td>gene_1565</td>
      <td>2</td>
      <td>6704</td>
      <td>4</td>
      <td>6702</td>
      <td>0.687430</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1284</td>
      <td>gene_1564</td>
      <td>2</td>
      <td>6704</td>
      <td>4</td>
      <td>6702</td>
      <td>0.687430</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1285</td>
      <td>gene_1562</td>
      <td>2</td>
      <td>6704</td>
      <td>4</td>
      <td>6702</td>
      <td>0.687430</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1292</td>
      <td>gene_1563</td>
      <td>2</td>
      <td>6704</td>
      <td>4</td>
      <td>6702</td>
      <td>0.687430</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[616]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="s2">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/block_1430_1453/deletion.genes.block30.for_simu.sample.genes.block_1430_1453.SuSiE.L_1.prior_0p005.susie.rds&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[618]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">head</span><span class="p">(</span><span class="n">tmp</span><span class="err">$</span><span class="n">pip</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>0.0416666666666666</li>
	<li>0.0416666666666666</li>
	<li>0.0416666666666666</li>
	<li>0.0416666666666666</li>
	<li>0.0416666666666666</li>
	<li>0.0416666666666666</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[380]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 1430_1453</span>
<span class="c1">## real 2, 12, 21</span>
<span class="c1">## effect 1.23, 0.95, 1.15</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[380]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>8</td>
      <td>0.1390</td>
      <td>0.859537</td>
      <td>1.409517</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.1235</td>
      <td>0.838317</td>
      <td>1.292621</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.1230</td>
      <td>0.849467</td>
      <td>1.318009</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.1205</td>
      <td>0.864911</td>
      <td>1.408754</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.1185</td>
      <td>0.838471</td>
      <td>1.309034</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.1185</td>
      <td>0.848042</td>
      <td>1.468499</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.1175</td>
      <td>0.838416</td>
      <td>1.324686</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.1145</td>
      <td>0.826060</td>
      <td>1.336911</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.1120</td>
      <td>0.821494</td>
      <td>1.273331</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.1115</td>
      <td>0.838728</td>
      <td>1.289816</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.1100</td>
      <td>0.830796</td>
      <td>1.364167</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.1085</td>
      <td>0.832150</td>
      <td>1.333733</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.1040</td>
      <td>0.831801</td>
      <td>1.317243</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.1040</td>
      <td>0.862261</td>
      <td>1.399559</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.1040</td>
      <td>0.829605</td>
      <td>1.367403</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.1035</td>
      <td>0.835866</td>
      <td>1.344926</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.1030</td>
      <td>0.831313</td>
      <td>1.368431</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.1025</td>
      <td>0.813196</td>
      <td>1.341014</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.1020</td>
      <td>0.842287</td>
      <td>1.359600</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.1005</td>
      <td>0.829211</td>
      <td>1.318482</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.1005</td>
      <td>0.820365</td>
      <td>1.294683</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.0955</td>
      <td>0.857091</td>
      <td>1.350090</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0915</td>
      <td>0.803302</td>
      <td>1.328061</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0910</td>
      <td>0.814951</td>
      <td>1.400484</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[615]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[615]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>73</td>
      <td>gene_1450</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>19</td>
    </tr>
    <tr>
      <td>74</td>
      <td>gene_1441</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>10</td>
    </tr>
    <tr>
      <td>75</td>
      <td>gene_1449</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>18</td>
    </tr>
    <tr>
      <td>76</td>
      <td>gene_1452</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>21</td>
    </tr>
    <tr>
      <td>77</td>
      <td>gene_1448</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>17</td>
    </tr>
    <tr>
      <td>78</td>
      <td>gene_1447</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>16</td>
    </tr>
    <tr>
      <td>79</td>
      <td>gene_1446</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>15</td>
    </tr>
    <tr>
      <td>80</td>
      <td>gene_1445</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>14</td>
    </tr>
    <tr>
      <td>81</td>
      <td>gene_1444</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>13</td>
    </tr>
    <tr>
      <td>82</td>
      <td>gene_1443</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>12</td>
    </tr>
    <tr>
      <td>83</td>
      <td>gene_1442</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>11</td>
    </tr>
    <tr>
      <td>84</td>
      <td>gene_1451</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>20</td>
    </tr>
    <tr>
      <td>85</td>
      <td>gene_1440</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>9</td>
    </tr>
    <tr>
      <td>86</td>
      <td>gene_1453</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>22</td>
    </tr>
    <tr>
      <td>87</td>
      <td>gene_1438</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>7</td>
    </tr>
    <tr>
      <td>88</td>
      <td>gene_1437</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>6</td>
    </tr>
    <tr>
      <td>89</td>
      <td>gene_1436</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>5</td>
    </tr>
    <tr>
      <td>90</td>
      <td>gene_1435</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>4</td>
    </tr>
    <tr>
      <td>91</td>
      <td>gene_1434</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>3</td>
    </tr>
    <tr>
      <td>92</td>
      <td>gene_1433</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>2</td>
    </tr>
    <tr>
      <td>93</td>
      <td>gene_1432</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>1</td>
    </tr>
    <tr>
      <td>94</td>
      <td>gene_1431</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>0</td>
    </tr>
    <tr>
      <td>95</td>
      <td>gene_1439</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>8</td>
    </tr>
    <tr>
      <td>96</td>
      <td>gene_1454</td>
      <td>23</td>
      <td>6683</td>
      <td>0</td>
      <td>6706</td>
      <td>2.339559e-07</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[336]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 1361_1377</span>
<span class="c1">## real 1,15</span>
<span class="c1">## effect 1.18, 0.74</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[336]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>15</td>
      <td>0.1235</td>
      <td>0.823040</td>
      <td>1.098096</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.1170</td>
      <td>0.818803</td>
      <td>1.128166</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.1120</td>
      <td>0.793767</td>
      <td>1.062181</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0730</td>
      <td>0.805364</td>
      <td>0.864683</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.0730</td>
      <td>0.780449</td>
      <td>0.877235</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.0710</td>
      <td>0.793114</td>
      <td>1.007977</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0705</td>
      <td>0.784433</td>
      <td>0.833734</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0695</td>
      <td>0.798761</td>
      <td>0.965133</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.0665</td>
      <td>0.802419</td>
      <td>0.943085</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0650</td>
      <td>0.784205</td>
      <td>0.932707</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0625</td>
      <td>0.817216</td>
      <td>0.964107</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0615</td>
      <td>0.802516</td>
      <td>1.005574</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.0615</td>
      <td>0.792505</td>
      <td>0.909973</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0600</td>
      <td>0.792884</td>
      <td>1.068084</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0590</td>
      <td>0.805358</td>
      <td>0.912511</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0575</td>
      <td>0.782724</td>
      <td>0.881663</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0490</td>
      <td>0.790279</td>
      <td>0.956105</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[337]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[337]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>277</td>
      <td>gene_1378</td>
      <td>16</td>
      <td>6690</td>
      <td>4</td>
      <td>6702</td>
      <td>0.011757</td>
      <td>16</td>
    </tr>
    <tr>
      <td>278</td>
      <td>gene_1377</td>
      <td>16</td>
      <td>6690</td>
      <td>4</td>
      <td>6702</td>
      <td>0.011757</td>
      <td>15</td>
    </tr>
    <tr>
      <td>279</td>
      <td>gene_1376</td>
      <td>16</td>
      <td>6690</td>
      <td>4</td>
      <td>6702</td>
      <td>0.011757</td>
      <td>14</td>
    </tr>
    <tr>
      <td>350</td>
      <td>gene_1363</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>1</td>
    </tr>
    <tr>
      <td>351</td>
      <td>gene_1364</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>2</td>
    </tr>
    <tr>
      <td>352</td>
      <td>gene_1366</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>4</td>
    </tr>
    <tr>
      <td>353</td>
      <td>gene_1367</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>5</td>
    </tr>
    <tr>
      <td>354</td>
      <td>gene_1368</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>6</td>
    </tr>
    <tr>
      <td>355</td>
      <td>gene_1365</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>3</td>
    </tr>
    <tr>
      <td>356</td>
      <td>gene_1370</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>8</td>
    </tr>
    <tr>
      <td>357</td>
      <td>gene_1371</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>9</td>
    </tr>
    <tr>
      <td>358</td>
      <td>gene_1372</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>10</td>
    </tr>
    <tr>
      <td>359</td>
      <td>gene_1373</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>11</td>
    </tr>
    <tr>
      <td>360</td>
      <td>gene_1374</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>12</td>
    </tr>
    <tr>
      <td>361</td>
      <td>gene_1375</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>13</td>
    </tr>
    <tr>
      <td>363</td>
      <td>gene_1369</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>7</td>
    </tr>
    <tr>
      <td>364</td>
      <td>gene_1362</td>
      <td>12</td>
      <td>6694</td>
      <td>3</td>
      <td>6703</td>
      <td>0.035057</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[321]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 1320_1337</span>
<span class="c1">## real 5,7</span>
<span class="c1">## effect 1.71, 0.39</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[321]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4</td>
      <td>0.2720</td>
      <td>1.004289</td>
      <td>1.613462</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.2065</td>
      <td>0.937953</td>
      <td>1.517386</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.1765</td>
      <td>0.876835</td>
      <td>1.484768</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.1695</td>
      <td>0.912997</td>
      <td>1.485643</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.1680</td>
      <td>0.914467</td>
      <td>1.568524</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.1645</td>
      <td>0.883832</td>
      <td>1.499749</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.1170</td>
      <td>0.813945</td>
      <td>1.137207</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.1005</td>
      <td>0.823522</td>
      <td>1.178037</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.1000</td>
      <td>0.824287</td>
      <td>1.083487</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.0810</td>
      <td>0.804299</td>
      <td>1.205732</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0805</td>
      <td>0.813312</td>
      <td>1.126563</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.0780</td>
      <td>0.805600</td>
      <td>1.149433</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.0740</td>
      <td>0.812949</td>
      <td>0.988573</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0695</td>
      <td>0.795391</td>
      <td>1.175677</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.0690</td>
      <td>0.809186</td>
      <td>1.212687</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.0635</td>
      <td>0.801776</td>
      <td>1.037557</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0530</td>
      <td>0.779236</td>
      <td>1.058733</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.0470</td>
      <td>0.784323</td>
      <td>0.842119</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[322]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[322]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>43</td>
      <td>gene_1326</td>
      <td>58</td>
      <td>6648</td>
      <td>6</td>
      <td>6700</td>
      <td>8.171839e-12</td>
      <td>5</td>
    </tr>
    <tr>
      <td>44</td>
      <td>gene_1325</td>
      <td>58</td>
      <td>6648</td>
      <td>6</td>
      <td>6700</td>
      <td>8.171839e-12</td>
      <td>4</td>
    </tr>
    <tr>
      <td>45</td>
      <td>gene_1324</td>
      <td>58</td>
      <td>6648</td>
      <td>6</td>
      <td>6700</td>
      <td>8.171839e-12</td>
      <td>3</td>
    </tr>
    <tr>
      <td>46</td>
      <td>gene_1329</td>
      <td>58</td>
      <td>6648</td>
      <td>6</td>
      <td>6700</td>
      <td>8.171839e-12</td>
      <td>8</td>
    </tr>
    <tr>
      <td>47</td>
      <td>gene_1327</td>
      <td>58</td>
      <td>6648</td>
      <td>6</td>
      <td>6700</td>
      <td>8.171839e-12</td>
      <td>6</td>
    </tr>
    <tr>
      <td>48</td>
      <td>gene_1328</td>
      <td>58</td>
      <td>6648</td>
      <td>6</td>
      <td>6700</td>
      <td>8.171839e-12</td>
      <td>7</td>
    </tr>
    <tr>
      <td>49</td>
      <td>gene_1330</td>
      <td>47</td>
      <td>6659</td>
      <td>5</td>
      <td>6701</td>
      <td>1.204229e-09</td>
      <td>9</td>
    </tr>
    <tr>
      <td>51</td>
      <td>gene_1321</td>
      <td>37</td>
      <td>6669</td>
      <td>2</td>
      <td>6704</td>
      <td>2.717260e-09</td>
      <td>0</td>
    </tr>
    <tr>
      <td>52</td>
      <td>gene_1322</td>
      <td>37</td>
      <td>6669</td>
      <td>2</td>
      <td>6704</td>
      <td>2.717260e-09</td>
      <td>1</td>
    </tr>
    <tr>
      <td>53</td>
      <td>gene_1323</td>
      <td>37</td>
      <td>6669</td>
      <td>2</td>
      <td>6704</td>
      <td>2.717260e-09</td>
      <td>2</td>
    </tr>
    <tr>
      <td>54</td>
      <td>gene_1331</td>
      <td>38</td>
      <td>6668</td>
      <td>3</td>
      <td>6703</td>
      <td>1.002112e-08</td>
      <td>10</td>
    </tr>
    <tr>
      <td>97</td>
      <td>gene_1334</td>
      <td>26</td>
      <td>6680</td>
      <td>1</td>
      <td>6705</td>
      <td>4.079593e-07</td>
      <td>13</td>
    </tr>
    <tr>
      <td>98</td>
      <td>gene_1333</td>
      <td>26</td>
      <td>6680</td>
      <td>1</td>
      <td>6705</td>
      <td>4.079593e-07</td>
      <td>12</td>
    </tr>
    <tr>
      <td>99</td>
      <td>gene_1332</td>
      <td>26</td>
      <td>6680</td>
      <td>1</td>
      <td>6705</td>
      <td>4.079593e-07</td>
      <td>11</td>
    </tr>
    <tr>
      <td>127</td>
      <td>gene_1335</td>
      <td>12</td>
      <td>6694</td>
      <td>0</td>
      <td>6706</td>
      <td>4.858823e-04</td>
      <td>14</td>
    </tr>
    <tr>
      <td>128</td>
      <td>gene_1336</td>
      <td>12</td>
      <td>6694</td>
      <td>0</td>
      <td>6706</td>
      <td>4.858823e-04</td>
      <td>15</td>
    </tr>
    <tr>
      <td>129</td>
      <td>gene_1337</td>
      <td>12</td>
      <td>6694</td>
      <td>0</td>
      <td>6706</td>
      <td>4.858823e-04</td>
      <td>16</td>
    </tr>
    <tr>
      <td>130</td>
      <td>gene_1338</td>
      <td>12</td>
      <td>6694</td>
      <td>0</td>
      <td>6706</td>
      <td>4.858823e-04</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[620]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp1</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="s2">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/block_1109_1141/deletion.genes.block30.for_simu.sample.genes.block_1109_1141.SuSiE.L_1.prior_0p005.susie.rds&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[621]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp1</span><span class="err">$</span><span class="n">pip</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
	<li>0.333333333333333</li>
	<li>0.333333333333333</li>
	<li>0.333333333333333</li>
	<li>0</li>
	<li>0</li>
	<li>0</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[264]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 1109_1141</span>
<span class="c1">## real 29</span>
<span class="c1">## effect 2.05</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[264]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>27</td>
      <td>1.0000</td>
      <td>1.849512</td>
      <td>1.849512</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.4515</td>
      <td>0.794093</td>
      <td>0.790931</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.1450</td>
      <td>0.883395</td>
      <td>1.379335</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.1345</td>
      <td>0.828012</td>
      <td>1.324679</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.1285</td>
      <td>0.845456</td>
      <td>1.402063</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.1080</td>
      <td>0.815385</td>
      <td>1.315768</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.1005</td>
      <td>0.826173</td>
      <td>1.203562</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.1000</td>
      <td>0.793537</td>
      <td>1.124176</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0905</td>
      <td>0.794219</td>
      <td>1.143379</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0900</td>
      <td>0.745811</td>
      <td>0.706926</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0895</td>
      <td>0.870054</td>
      <td>1.274154</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0810</td>
      <td>0.723863</td>
      <td>0.646709</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0725</td>
      <td>0.773747</td>
      <td>0.630040</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.0685</td>
      <td>0.755045</td>
      <td>0.566712</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0330</td>
      <td>0.773194</td>
      <td>0.582991</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.0285</td>
      <td>0.771154</td>
      <td>0.381001</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0280</td>
      <td>0.785837</td>
      <td>0.555820</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.0230</td>
      <td>0.770592</td>
      <td>-0.320432</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0225</td>
      <td>0.760421</td>
      <td>0.266856</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0215</td>
      <td>0.775865</td>
      <td>-0.086558</td>
    </tr>
    <tr>
      <td>30</td>
      <td>0.0215</td>
      <td>0.785653</td>
      <td>-0.293866</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.0205</td>
      <td>0.724552</td>
      <td>-0.263460</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.0200</td>
      <td>0.718836</td>
      <td>-0.241045</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.0185</td>
      <td>0.751821</td>
      <td>-0.286396</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.0185</td>
      <td>0.780547</td>
      <td>-0.244976</td>
    </tr>
    <tr>
      <td>31</td>
      <td>0.0185</td>
      <td>0.731109</td>
      <td>-0.327986</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.0170</td>
      <td>0.730475</td>
      <td>-0.217563</td>
    </tr>
    <tr>
      <td>32</td>
      <td>0.0165</td>
      <td>0.771587</td>
      <td>-0.238879</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.0150</td>
      <td>0.748942</td>
      <td>-0.270061</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.0150</td>
      <td>0.738903</td>
      <td>-0.088858</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.0150</td>
      <td>0.803607</td>
      <td>0.195380</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.0150</td>
      <td>0.746746</td>
      <td>0.185059</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.0145</td>
      <td>0.747255</td>
      <td>-0.149917</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[265]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[265]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>6</td>
      <td>gene_1138</td>
      <td>502</td>
      <td>6204</td>
      <td>79</td>
      <td>6627</td>
      <td>2.861096e-79</td>
      <td>28</td>
    </tr>
    <tr>
      <td>7</td>
      <td>gene_1139</td>
      <td>502</td>
      <td>6204</td>
      <td>79</td>
      <td>6627</td>
      <td>2.861096e-79</td>
      <td>29</td>
    </tr>
    <tr>
      <td>8</td>
      <td>gene_1137</td>
      <td>502</td>
      <td>6204</td>
      <td>79</td>
      <td>6627</td>
      <td>2.861096e-79</td>
      <td>27</td>
    </tr>
    <tr>
      <td>50</td>
      <td>gene_1140</td>
      <td>91</td>
      <td>6615</td>
      <td>27</td>
      <td>6679</td>
      <td>2.307133e-09</td>
      <td>30</td>
    </tr>
    <tr>
      <td>106</td>
      <td>gene_1141</td>
      <td>44</td>
      <td>6662</td>
      <td>11</td>
      <td>6695</td>
      <td>8.356271e-06</td>
      <td>31</td>
    </tr>
    <tr>
      <td>107</td>
      <td>gene_1142</td>
      <td>44</td>
      <td>6662</td>
      <td>11</td>
      <td>6695</td>
      <td>8.356271e-06</td>
      <td>32</td>
    </tr>
    <tr>
      <td>109</td>
      <td>gene_1122</td>
      <td>15</td>
      <td>6691</td>
      <td>0</td>
      <td>6706</td>
      <td>6.055868e-05</td>
      <td>12</td>
    </tr>
    <tr>
      <td>110</td>
      <td>gene_1121</td>
      <td>15</td>
      <td>6691</td>
      <td>0</td>
      <td>6706</td>
      <td>6.055868e-05</td>
      <td>11</td>
    </tr>
    <tr>
      <td>111</td>
      <td>gene_1123</td>
      <td>15</td>
      <td>6691</td>
      <td>0</td>
      <td>6706</td>
      <td>6.055868e-05</td>
      <td>13</td>
    </tr>
    <tr>
      <td>112</td>
      <td>gene_1120</td>
      <td>15</td>
      <td>6691</td>
      <td>0</td>
      <td>6706</td>
      <td>6.055868e-05</td>
      <td>10</td>
    </tr>
    <tr>
      <td>114</td>
      <td>gene_1119</td>
      <td>17</td>
      <td>6689</td>
      <td>1</td>
      <td>6705</td>
      <td>1.436572e-04</td>
      <td>9</td>
    </tr>
    <tr>
      <td>115</td>
      <td>gene_1118</td>
      <td>17</td>
      <td>6689</td>
      <td>1</td>
      <td>6705</td>
      <td>1.436572e-04</td>
      <td>8</td>
    </tr>
    <tr>
      <td>116</td>
      <td>gene_1116</td>
      <td>17</td>
      <td>6689</td>
      <td>1</td>
      <td>6705</td>
      <td>1.436572e-04</td>
      <td>6</td>
    </tr>
    <tr>
      <td>117</td>
      <td>gene_1117</td>
      <td>17</td>
      <td>6689</td>
      <td>1</td>
      <td>6705</td>
      <td>1.436572e-04</td>
      <td>7</td>
    </tr>
    <tr>
      <td>266</td>
      <td>gene_1110</td>
      <td>43</td>
      <td>6663</td>
      <td>21</td>
      <td>6685</td>
      <td>7.997564e-03</td>
      <td>0</td>
    </tr>
    <tr>
      <td>275</td>
      <td>gene_1125</td>
      <td>16</td>
      <td>6690</td>
      <td>4</td>
      <td>6702</td>
      <td>1.175737e-02</td>
      <td>15</td>
    </tr>
    <tr>
      <td>276</td>
      <td>gene_1126</td>
      <td>16</td>
      <td>6690</td>
      <td>4</td>
      <td>6702</td>
      <td>1.175737e-02</td>
      <td>16</td>
    </tr>
    <tr>
      <td>347</td>
      <td>gene_1124</td>
      <td>17</td>
      <td>6689</td>
      <td>6</td>
      <td>6700</td>
      <td>3.453722e-02</td>
      <td>14</td>
    </tr>
    <tr>
      <td>405</td>
      <td>gene_1112</td>
      <td>29</td>
      <td>6677</td>
      <td>15</td>
      <td>6691</td>
      <td>4.839967e-02</td>
      <td>2</td>
    </tr>
    <tr>
      <td>406</td>
      <td>gene_1113</td>
      <td>29</td>
      <td>6677</td>
      <td>15</td>
      <td>6691</td>
      <td>4.839967e-02</td>
      <td>3</td>
    </tr>
    <tr>
      <td>407</td>
      <td>gene_1111</td>
      <td>29</td>
      <td>6677</td>
      <td>15</td>
      <td>6691</td>
      <td>4.839967e-02</td>
      <td>1</td>
    </tr>
    <tr>
      <td>546</td>
      <td>gene_1134</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>24</td>
    </tr>
    <tr>
      <td>547</td>
      <td>gene_1132</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>22</td>
    </tr>
    <tr>
      <td>548</td>
      <td>gene_1131</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>21</td>
    </tr>
    <tr>
      <td>549</td>
      <td>gene_1127</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>17</td>
    </tr>
    <tr>
      <td>550</td>
      <td>gene_1130</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>20</td>
    </tr>
    <tr>
      <td>551</td>
      <td>gene_1129</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>19</td>
    </tr>
    <tr>
      <td>552</td>
      <td>gene_1133</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>23</td>
    </tr>
    <tr>
      <td>553</td>
      <td>gene_1128</td>
      <td>17</td>
      <td>6689</td>
      <td>9</td>
      <td>6697</td>
      <td>1.682242e-01</td>
      <td>18</td>
    </tr>
    <tr>
      <td>578</td>
      <td>gene_1135</td>
      <td>19</td>
      <td>6687</td>
      <td>11</td>
      <td>6695</td>
      <td>1.999835e-01</td>
      <td>25</td>
    </tr>
    <tr>
      <td>579</td>
      <td>gene_1136</td>
      <td>19</td>
      <td>6687</td>
      <td>11</td>
      <td>6695</td>
      <td>1.999835e-01</td>
      <td>26</td>
    </tr>
    <tr>
      <td>2267</td>
      <td>gene_1114</td>
      <td>2</td>
      <td>6704</td>
      <td>1</td>
      <td>6705</td>
      <td>1.000000e+00</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2282</td>
      <td>gene_1115</td>
      <td>2</td>
      <td>6704</td>
      <td>1</td>
      <td>6705</td>
      <td>1.000000e+00</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">### selective</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[234]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 1018_1031</span>
<span class="c1">## real 2, 13</span>
<span class="c1">## effect 0.60, 1.07</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[234]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>0.3040</td>
      <td>0.926048</td>
      <td>1.296915</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0650</td>
      <td>0.767650</td>
      <td>0.801550</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0640</td>
      <td>0.777537</td>
      <td>0.820872</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0635</td>
      <td>0.773069</td>
      <td>0.866680</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.0585</td>
      <td>0.791200</td>
      <td>0.832734</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0580</td>
      <td>0.775015</td>
      <td>0.843443</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.0580</td>
      <td>0.796682</td>
      <td>0.831028</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.0580</td>
      <td>0.780965</td>
      <td>0.919135</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0505</td>
      <td>0.768463</td>
      <td>0.766376</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0495</td>
      <td>0.774164</td>
      <td>0.727036</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.0485</td>
      <td>0.796748</td>
      <td>0.973925</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0475</td>
      <td>0.780096</td>
      <td>0.834351</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0385</td>
      <td>0.804297</td>
      <td>0.855654</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0365</td>
      <td>0.755608</td>
      <td>0.538007</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[233]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[233]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>280</td>
      <td>gene_1021</td>
      <td>14</td>
      <td>6692</td>
      <td>3</td>
      <td>6703</td>
      <td>0.012672</td>
      <td>2</td>
    </tr>
    <tr>
      <td>556</td>
      <td>gene_1023</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>4</td>
    </tr>
    <tr>
      <td>557</td>
      <td>gene_1024</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>5</td>
    </tr>
    <tr>
      <td>565</td>
      <td>gene_1022</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>3</td>
    </tr>
    <tr>
      <td>566</td>
      <td>gene_1025</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>6</td>
    </tr>
    <tr>
      <td>568</td>
      <td>gene_1027</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>8</td>
    </tr>
    <tr>
      <td>569</td>
      <td>gene_1030</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>11</td>
    </tr>
    <tr>
      <td>570</td>
      <td>gene_1031</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>12</td>
    </tr>
    <tr>
      <td>571</td>
      <td>gene_1032</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>13</td>
    </tr>
    <tr>
      <td>572</td>
      <td>gene_1029</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>10</td>
    </tr>
    <tr>
      <td>573</td>
      <td>gene_1026</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>7</td>
    </tr>
    <tr>
      <td>574</td>
      <td>gene_1028</td>
      <td>7</td>
      <td>6699</td>
      <td>2</td>
      <td>6704</td>
      <td>0.179541</td>
      <td>9</td>
    </tr>
    <tr>
      <td>717</td>
      <td>gene_1020</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>1</td>
    </tr>
    <tr>
      <td>721</td>
      <td>gene_1019</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[206]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 930_937</span>
<span class="c1">## real 2</span>
<span class="c1">## effect 0.96</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[206]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>0.1175</td>
      <td>0.848943</td>
      <td>1.234252</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.1130</td>
      <td>0.814002</td>
      <td>1.313239</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.1120</td>
      <td>0.846596</td>
      <td>1.367156</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.1105</td>
      <td>0.833119</td>
      <td>1.239662</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.1095</td>
      <td>0.815812</td>
      <td>1.231239</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.1020</td>
      <td>0.829710</td>
      <td>1.340558</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0960</td>
      <td>0.826704</td>
      <td>1.339139</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0925</td>
      <td>0.814909</td>
      <td>1.330195</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[207]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[207]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>516</td>
      <td>gene_932</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>1</td>
    </tr>
    <tr>
      <td>524</td>
      <td>gene_938</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>7</td>
    </tr>
    <tr>
      <td>527</td>
      <td>gene_937</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>6</td>
    </tr>
    <tr>
      <td>532</td>
      <td>gene_935</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>4</td>
    </tr>
    <tr>
      <td>533</td>
      <td>gene_934</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>3</td>
    </tr>
    <tr>
      <td>534</td>
      <td>gene_933</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>2</td>
    </tr>
    <tr>
      <td>536</td>
      <td>gene_931</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>0</td>
    </tr>
    <tr>
      <td>537</td>
      <td>gene_936</td>
      <td>4</td>
      <td>6702</td>
      <td>0</td>
      <td>6706</td>
      <td>0.124944</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[192]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 893_910</span>
<span class="c1">## real 11, 15</span>
<span class="c1">## effect 1.92, 1.48</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[192]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>7</td>
      <td>0.1615</td>
      <td>0.883286</td>
      <td>1.481295</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.1575</td>
      <td>0.907570</td>
      <td>1.529887</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.1540</td>
      <td>0.894071</td>
      <td>1.511624</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.1540</td>
      <td>0.864708</td>
      <td>1.537633</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.1535</td>
      <td>0.896044</td>
      <td>1.491993</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.1465</td>
      <td>0.896886</td>
      <td>1.547793</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.1435</td>
      <td>0.891985</td>
      <td>1.436742</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.1430</td>
      <td>0.871303</td>
      <td>1.446187</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.1385</td>
      <td>0.859715</td>
      <td>1.509538</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.1330</td>
      <td>0.862674</td>
      <td>1.454693</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.1320</td>
      <td>0.875985</td>
      <td>1.488568</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.1300</td>
      <td>0.854547</td>
      <td>1.403941</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.1295</td>
      <td>0.872957</td>
      <td>1.478818</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.1260</td>
      <td>0.870050</td>
      <td>1.530126</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.1250</td>
      <td>0.858429</td>
      <td>1.474100</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.1180</td>
      <td>0.858334</td>
      <td>1.446376</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0355</td>
      <td>0.769790</td>
      <td>0.739928</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0295</td>
      <td>0.774088</td>
      <td>0.240750</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[193]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>55</td>
      <td>gene_895</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>1</td>
    </tr>
    <tr>
      <td>56</td>
      <td>gene_894</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>0</td>
    </tr>
    <tr>
      <td>57</td>
      <td>gene_896</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>2</td>
    </tr>
    <tr>
      <td>58</td>
      <td>gene_898</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>4</td>
    </tr>
    <tr>
      <td>59</td>
      <td>gene_899</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>5</td>
    </tr>
    <tr>
      <td>60</td>
      <td>gene_900</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>6</td>
    </tr>
    <tr>
      <td>61</td>
      <td>gene_901</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>7</td>
    </tr>
    <tr>
      <td>62</td>
      <td>gene_897</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>3</td>
    </tr>
    <tr>
      <td>63</td>
      <td>gene_903</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>9</td>
    </tr>
    <tr>
      <td>64</td>
      <td>gene_904</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>10</td>
    </tr>
    <tr>
      <td>65</td>
      <td>gene_905</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>11</td>
    </tr>
    <tr>
      <td>66</td>
      <td>gene_906</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>12</td>
    </tr>
    <tr>
      <td>67</td>
      <td>gene_902</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>8</td>
    </tr>
    <tr>
      <td>68</td>
      <td>gene_907</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>13</td>
    </tr>
    <tr>
      <td>69</td>
      <td>gene_908</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>14</td>
    </tr>
    <tr>
      <td>70</td>
      <td>gene_909</td>
      <td>25</td>
      <td>6681</td>
      <td>0</td>
      <td>6706</td>
      <td>5.828382e-08</td>
      <td>15</td>
    </tr>
    <tr>
      <td>105</td>
      <td>gene_910</td>
      <td>27</td>
      <td>6679</td>
      <td>3</td>
      <td>6703</td>
      <td>8.256687e-06</td>
      <td>16</td>
    </tr>
    <tr>
      <td>2173</td>
      <td>gene_911</td>
      <td>2</td>
      <td>6704</td>
      <td>3</td>
      <td>6703</td>
      <td>1.000000e+00</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[178]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 841_870</span>
<span class="c1">## real 4, 17</span>
<span class="c1">## effect 0.74, 1.45</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[178]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>22</td>
      <td>0.0930</td>
      <td>0.818293</td>
      <td>1.287559</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.0915</td>
      <td>0.815534</td>
      <td>1.254016</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.0905</td>
      <td>0.812697</td>
      <td>1.240249</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0895</td>
      <td>0.813472</td>
      <td>1.153967</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0890</td>
      <td>0.815766</td>
      <td>1.194412</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.0870</td>
      <td>0.812563</td>
      <td>1.171672</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.0865</td>
      <td>0.787368</td>
      <td>1.109925</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0860</td>
      <td>0.827101</td>
      <td>1.223039</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0845</td>
      <td>0.824216</td>
      <td>1.109448</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.0830</td>
      <td>0.819679</td>
      <td>1.168925</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0825</td>
      <td>0.798963</td>
      <td>1.309202</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.0805</td>
      <td>0.825028</td>
      <td>1.160679</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0795</td>
      <td>0.817191</td>
      <td>1.249124</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.0785</td>
      <td>0.821416</td>
      <td>1.273996</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.0785</td>
      <td>0.821349</td>
      <td>1.168293</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.0745</td>
      <td>0.803480</td>
      <td>1.117298</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.0735</td>
      <td>0.813623</td>
      <td>1.246405</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0735</td>
      <td>0.814804</td>
      <td>1.131786</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0735</td>
      <td>0.813586</td>
      <td>1.154009</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0730</td>
      <td>0.809178</td>
      <td>1.223808</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.0725</td>
      <td>0.822360</td>
      <td>1.189761</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0720</td>
      <td>0.820888</td>
      <td>1.072196</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.0715</td>
      <td>0.812287</td>
      <td>1.251653</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0715</td>
      <td>0.818457</td>
      <td>1.222624</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0710</td>
      <td>0.819275</td>
      <td>1.227494</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.0710</td>
      <td>0.809757</td>
      <td>1.119287</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.0700</td>
      <td>0.782696</td>
      <td>1.126058</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.0690</td>
      <td>0.794670</td>
      <td>1.150148</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.0680</td>
      <td>0.789122</td>
      <td>1.163342</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.0665</td>
      <td>0.794701</td>
      <td>1.151687</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[179]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[179]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>236</td>
      <td>gene_849</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>7</td>
    </tr>
    <tr>
      <td>237</td>
      <td>gene_870</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>28</td>
    </tr>
    <tr>
      <td>238</td>
      <td>gene_848</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>6</td>
    </tr>
    <tr>
      <td>239</td>
      <td>gene_847</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>5</td>
    </tr>
    <tr>
      <td>240</td>
      <td>gene_845</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>3</td>
    </tr>
    <tr>
      <td>241</td>
      <td>gene_844</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>2</td>
    </tr>
    <tr>
      <td>242</td>
      <td>gene_843</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>1</td>
    </tr>
    <tr>
      <td>243</td>
      <td>gene_842</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>0</td>
    </tr>
    <tr>
      <td>244</td>
      <td>gene_851</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>9</td>
    </tr>
    <tr>
      <td>245</td>
      <td>gene_852</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>10</td>
    </tr>
    <tr>
      <td>246</td>
      <td>gene_853</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>11</td>
    </tr>
    <tr>
      <td>247</td>
      <td>gene_855</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>13</td>
    </tr>
    <tr>
      <td>248</td>
      <td>gene_856</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>14</td>
    </tr>
    <tr>
      <td>249</td>
      <td>gene_857</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>15</td>
    </tr>
    <tr>
      <td>250</td>
      <td>gene_858</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>16</td>
    </tr>
    <tr>
      <td>251</td>
      <td>gene_859</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>17</td>
    </tr>
    <tr>
      <td>252</td>
      <td>gene_860</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>18</td>
    </tr>
    <tr>
      <td>253</td>
      <td>gene_861</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>19</td>
    </tr>
    <tr>
      <td>254</td>
      <td>gene_862</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>20</td>
    </tr>
    <tr>
      <td>255</td>
      <td>gene_863</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>21</td>
    </tr>
    <tr>
      <td>256</td>
      <td>gene_864</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>22</td>
    </tr>
    <tr>
      <td>257</td>
      <td>gene_865</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>23</td>
    </tr>
    <tr>
      <td>258</td>
      <td>gene_866</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>24</td>
    </tr>
    <tr>
      <td>259</td>
      <td>gene_850</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>8</td>
    </tr>
    <tr>
      <td>260</td>
      <td>gene_867</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>25</td>
    </tr>
    <tr>
      <td>261</td>
      <td>gene_868</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>26</td>
    </tr>
    <tr>
      <td>262</td>
      <td>gene_869</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>27</td>
    </tr>
    <tr>
      <td>263</td>
      <td>gene_871</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>29</td>
    </tr>
    <tr>
      <td>264</td>
      <td>gene_854</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>12</td>
    </tr>
    <tr>
      <td>265</td>
      <td>gene_846</td>
      <td>8</td>
      <td>6698</td>
      <td>0</td>
      <td>6706</td>
      <td>0.007796</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[622]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp2</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="s2">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/block_788_797/deletion.genes.block30.for_simu.sample.genes.block_788_797.SuSiE.L_1.prior_0p005.susie.rds&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[627]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp2</span><span class="err">$</span><span class="n">pip</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
	<li>0.1</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[164]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 788_797</span>
<span class="c1">## real 7</span>
<span class="c1">## effect 1.808</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[164]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>7</td>
      <td>0.1320</td>
      <td>0.825230</td>
      <td>1.093129</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.1145</td>
      <td>0.810917</td>
      <td>1.147125</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.1115</td>
      <td>0.823439</td>
      <td>1.219508</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.1105</td>
      <td>0.818534</td>
      <td>1.139817</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.1095</td>
      <td>0.837740</td>
      <td>1.163126</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.1095</td>
      <td>0.807095</td>
      <td>1.194249</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.1065</td>
      <td>0.817155</td>
      <td>1.143092</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.1050</td>
      <td>0.798071</td>
      <td>1.205505</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.1040</td>
      <td>0.825068</td>
      <td>1.111863</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0995</td>
      <td>0.821848</td>
      <td>1.072202</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[165]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[165]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>295</td>
      <td>gene_794</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>5</td>
    </tr>
    <tr>
      <td>301</td>
      <td>gene_793</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>4</td>
    </tr>
    <tr>
      <td>310</td>
      <td>gene_792</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>3</td>
    </tr>
    <tr>
      <td>311</td>
      <td>gene_791</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>2</td>
    </tr>
    <tr>
      <td>313</td>
      <td>gene_795</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>6</td>
    </tr>
    <tr>
      <td>316</td>
      <td>gene_789</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>0</td>
    </tr>
    <tr>
      <td>317</td>
      <td>gene_790</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>1</td>
    </tr>
    <tr>
      <td>328</td>
      <td>gene_796</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>7</td>
    </tr>
    <tr>
      <td>331</td>
      <td>gene_798</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>9</td>
    </tr>
    <tr>
      <td>332</td>
      <td>gene_797</td>
      <td>11</td>
      <td>6695</td>
      <td>2</td>
      <td>6704</td>
      <td>0.022398</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 739_743</span>
<span class="c1">## real 2</span>
<span class="c1">## effect 0.98</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[86]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>0.4930</td>
      <td>1.000700</td>
      <td>1.232291</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0360</td>
      <td>0.726913</td>
      <td>0.263216</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0350</td>
      <td>0.753536</td>
      <td>0.516642</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0295</td>
      <td>0.787234</td>
      <td>0.411099</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0260</td>
      <td>0.768642</td>
      <td>0.450941</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[121]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>274</td>
      <td>gene_742</td>
      <td>16</td>
      <td>6690</td>
      <td>4</td>
      <td>6702</td>
      <td>0.011757</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1384</td>
      <td>gene_743</td>
      <td>5</td>
      <td>6701</td>
      <td>3</td>
      <td>6703</td>
      <td>0.726481</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2184</td>
      <td>gene_744</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2185</td>
      <td>gene_741</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2186</td>
      <td>gene_740</td>
      <td>3</td>
      <td>6703</td>
      <td>2</td>
      <td>6704</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">### selective</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[628]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp3</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="s2">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/block_666_677/deletion.genes.block30.for_simu.sample.genes.block_666_677.SuSiE.L_1.prior_0p005.susie.rds&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[629]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp3</span><span class="err">$</span><span class="n">pip</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>8.88178419700125e-16</li>
	<li>3.33066907387547e-16</li>
	<li>3.33066907387547e-16</li>
	<li>3.33066907387547e-16</li>
	<li>0.499999999999196</li>
	<li>0.499999999999196</li>
	<li>7.99360577730113e-15</li>
	<li>7.99360577730113e-15</li>
	<li>7.99360577730113e-15</li>
	<li>5.27577981301874e-13</li>
	<li>5.27577981301874e-13</li>
	<li>5.27577981301874e-13</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 666_677</span>
<span class="c1">## real 4, 5, 11</span>
<span class="c1">## effect 1.28, 0.53, 0.98</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[74]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4</td>
      <td>0.5460</td>
      <td>1.477352</td>
      <td>2.060144</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.5185</td>
      <td>1.432267</td>
      <td>2.043380</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.1325</td>
      <td>0.848880</td>
      <td>1.329551</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.1270</td>
      <td>0.854411</td>
      <td>1.342899</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.1080</td>
      <td>0.823739</td>
      <td>1.277766</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0300</td>
      <td>0.750469</td>
      <td>0.429703</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0240</td>
      <td>0.744307</td>
      <td>0.225855</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0230</td>
      <td>0.770120</td>
      <td>0.375470</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0195</td>
      <td>0.749606</td>
      <td>0.191625</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0185</td>
      <td>0.788487</td>
      <td>0.367600</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0150</td>
      <td>0.744767</td>
      <td>0.102463</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0110</td>
      <td>0.773154</td>
      <td>0.384195</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">666</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">677</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">666</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[120]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>36</td>
      <td>gene_671</td>
      <td>99</td>
      <td>6607</td>
      <td>9</td>
      <td>6697</td>
      <td>1.956916e-20</td>
      <td>4</td>
    </tr>
    <tr>
      <td>37</td>
      <td>gene_672</td>
      <td>99</td>
      <td>6607</td>
      <td>9</td>
      <td>6697</td>
      <td>1.956916e-20</td>
      <td>5</td>
    </tr>
    <tr>
      <td>102</td>
      <td>gene_676</td>
      <td>20</td>
      <td>6686</td>
      <td>0</td>
      <td>6706</td>
      <td>1.880480e-06</td>
      <td>9</td>
    </tr>
    <tr>
      <td>103</td>
      <td>gene_678</td>
      <td>20</td>
      <td>6686</td>
      <td>0</td>
      <td>6706</td>
      <td>1.880480e-06</td>
      <td>11</td>
    </tr>
    <tr>
      <td>104</td>
      <td>gene_677</td>
      <td>20</td>
      <td>6686</td>
      <td>0</td>
      <td>6706</td>
      <td>1.880480e-06</td>
      <td>10</td>
    </tr>
    <tr>
      <td>139</td>
      <td>gene_673</td>
      <td>23</td>
      <td>6683</td>
      <td>5</td>
      <td>6701</td>
      <td>9.016016e-04</td>
      <td>6</td>
    </tr>
    <tr>
      <td>140</td>
      <td>gene_674</td>
      <td>23</td>
      <td>6683</td>
      <td>5</td>
      <td>6701</td>
      <td>9.016016e-04</td>
      <td>7</td>
    </tr>
    <tr>
      <td>141</td>
      <td>gene_675</td>
      <td>23</td>
      <td>6683</td>
      <td>5</td>
      <td>6701</td>
      <td>9.016016e-04</td>
      <td>8</td>
    </tr>
    <tr>
      <td>282</td>
      <td>gene_667</td>
      <td>12</td>
      <td>6694</td>
      <td>2</td>
      <td>6704</td>
      <td>1.289476e-02</td>
      <td>0</td>
    </tr>
    <tr>
      <td>345</td>
      <td>gene_668</td>
      <td>17</td>
      <td>6689</td>
      <td>6</td>
      <td>6700</td>
      <td>3.453722e-02</td>
      <td>1</td>
    </tr>
    <tr>
      <td>346</td>
      <td>gene_670</td>
      <td>17</td>
      <td>6689</td>
      <td>6</td>
      <td>6700</td>
      <td>3.453722e-02</td>
      <td>3</td>
    </tr>
    <tr>
      <td>348</td>
      <td>gene_669</td>
      <td>17</td>
      <td>6689</td>
      <td>6</td>
      <td>6700</td>
      <td>3.453722e-02</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">### selective</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[663]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="s2">&quot;/home/min/GIT/cnv-gene-mapping/data/deletion_simu/block_556_583/deletion.genes.block30.for_simu.sample.genes.block_556_583.SuSiE.L_1.prior_0p005.susie.rds&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[664]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">tmp</span><span class="err">$</span><span class="n">pip</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>0</li>
	<li>1.11545223535625e-06</li>
	<li>1.11545223535625e-06</li>
	<li>1.11545223535625e-06</li>
	<li>1.11545223535625e-06</li>
	<li>1.11545223535625e-06</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0.0499997211369412</li>
	<li>0</li>
	<li>0</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 556_583</span>
<span class="c1">## real 8, 14, 20</span>
<span class="c1">## effect 2.03, 0.84, 0.71</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[62]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>13</td>
      <td>0.1765</td>
      <td>0.912673</td>
      <td>1.541970</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.1680</td>
      <td>0.899262</td>
      <td>1.533234</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.1565</td>
      <td>0.894481</td>
      <td>1.473024</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.1450</td>
      <td>0.899563</td>
      <td>1.550085</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.1400</td>
      <td>0.881196</td>
      <td>1.520979</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.1390</td>
      <td>0.877870</td>
      <td>1.524457</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.1365</td>
      <td>0.872064</td>
      <td>1.475609</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.1355</td>
      <td>0.876335</td>
      <td>1.551596</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.1335</td>
      <td>0.881722</td>
      <td>1.562205</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.1325</td>
      <td>0.879677</td>
      <td>1.423774</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.1325</td>
      <td>0.879466</td>
      <td>1.524186</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.1320</td>
      <td>0.896319</td>
      <td>1.445784</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.1315</td>
      <td>0.870917</td>
      <td>1.529550</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.1315</td>
      <td>0.879215</td>
      <td>1.536151</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.1315</td>
      <td>0.889288</td>
      <td>1.498121</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.1300</td>
      <td>0.882583</td>
      <td>1.529814</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.1280</td>
      <td>0.862068</td>
      <td>1.457598</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.1225</td>
      <td>0.834628</td>
      <td>1.497794</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.1190</td>
      <td>0.860485</td>
      <td>1.423408</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.1130</td>
      <td>0.842922</td>
      <td>1.405974</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0695</td>
      <td>0.806391</td>
      <td>1.038744</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0615</td>
      <td>0.788237</td>
      <td>1.092125</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0585</td>
      <td>0.787436</td>
      <td>0.997605</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.0570</td>
      <td>0.819494</td>
      <td>1.083626</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0540</td>
      <td>0.783500</td>
      <td>0.949915</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0535</td>
      <td>0.785115</td>
      <td>0.938133</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.0500</td>
      <td>0.769003</td>
      <td>0.961894</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0245</td>
      <td>0.754623</td>
      <td>0.167191</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">556</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">583</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">556</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[119]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>9</td>
      <td>gene_567</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>10</td>
    </tr>
    <tr>
      <td>10</td>
      <td>gene_582</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>25</td>
    </tr>
    <tr>
      <td>11</td>
      <td>gene_581</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>24</td>
    </tr>
    <tr>
      <td>12</td>
      <td>gene_580</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>23</td>
    </tr>
    <tr>
      <td>13</td>
      <td>gene_577</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>20</td>
    </tr>
    <tr>
      <td>14</td>
      <td>gene_579</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>22</td>
    </tr>
    <tr>
      <td>15</td>
      <td>gene_576</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>19</td>
    </tr>
    <tr>
      <td>16</td>
      <td>gene_575</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>18</td>
    </tr>
    <tr>
      <td>17</td>
      <td>gene_574</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>17</td>
    </tr>
    <tr>
      <td>18</td>
      <td>gene_566</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>9</td>
    </tr>
    <tr>
      <td>19</td>
      <td>gene_573</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>16</td>
    </tr>
    <tr>
      <td>20</td>
      <td>gene_571</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>14</td>
    </tr>
    <tr>
      <td>21</td>
      <td>gene_570</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>13</td>
    </tr>
    <tr>
      <td>22</td>
      <td>gene_569</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>12</td>
    </tr>
    <tr>
      <td>23</td>
      <td>gene_563</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>6</td>
    </tr>
    <tr>
      <td>24</td>
      <td>gene_564</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>7</td>
    </tr>
    <tr>
      <td>25</td>
      <td>gene_565</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>8</td>
    </tr>
    <tr>
      <td>26</td>
      <td>gene_578</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>21</td>
    </tr>
    <tr>
      <td>27</td>
      <td>gene_568</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>11</td>
    </tr>
    <tr>
      <td>28</td>
      <td>gene_572</td>
      <td>132</td>
      <td>6574</td>
      <td>1</td>
      <td>6705</td>
      <td>1.296086e-38</td>
      <td>15</td>
    </tr>
    <tr>
      <td>30</td>
      <td>gene_558</td>
      <td>111</td>
      <td>6595</td>
      <td>1</td>
      <td>6705</td>
      <td>2.773089e-32</td>
      <td>1</td>
    </tr>
    <tr>
      <td>31</td>
      <td>gene_562</td>
      <td>111</td>
      <td>6595</td>
      <td>1</td>
      <td>6705</td>
      <td>2.773089e-32</td>
      <td>5</td>
    </tr>
    <tr>
      <td>32</td>
      <td>gene_559</td>
      <td>111</td>
      <td>6595</td>
      <td>1</td>
      <td>6705</td>
      <td>2.773089e-32</td>
      <td>2</td>
    </tr>
    <tr>
      <td>33</td>
      <td>gene_560</td>
      <td>111</td>
      <td>6595</td>
      <td>1</td>
      <td>6705</td>
      <td>2.773089e-32</td>
      <td>3</td>
    </tr>
    <tr>
      <td>34</td>
      <td>gene_561</td>
      <td>111</td>
      <td>6595</td>
      <td>1</td>
      <td>6705</td>
      <td>2.773089e-32</td>
      <td>4</td>
    </tr>
    <tr>
      <td>42</td>
      <td>gene_583</td>
      <td>38</td>
      <td>6668</td>
      <td>0</td>
      <td>6706</td>
      <td>6.903390e-12</td>
      <td>26</td>
    </tr>
    <tr>
      <td>100</td>
      <td>gene_584</td>
      <td>21</td>
      <td>6685</td>
      <td>0</td>
      <td>6706</td>
      <td>9.388358e-07</td>
      <td>27</td>
    </tr>
    <tr>
      <td>101</td>
      <td>gene_557</td>
      <td>24</td>
      <td>6682</td>
      <td>1</td>
      <td>6705</td>
      <td>1.520613e-06</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 380_417</span>
<span class="c1">## real 17, 37</span>
<span class="c1">## effect 0.66, 0.88</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>20</td>
      <td>0.0540</td>
      <td>0.803795</td>
      <td>0.668929</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.0525</td>
      <td>0.792524</td>
      <td>0.659880</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.0500</td>
      <td>0.788163</td>
      <td>0.726686</td>
    </tr>
    <tr>
      <td>35</td>
      <td>0.0470</td>
      <td>0.777344</td>
      <td>0.739140</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0470</td>
      <td>0.770187</td>
      <td>0.604312</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.0465</td>
      <td>0.774596</td>
      <td>0.735595</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.0460</td>
      <td>0.782624</td>
      <td>0.709078</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0455</td>
      <td>0.768314</td>
      <td>0.681973</td>
    </tr>
    <tr>
      <td>33</td>
      <td>0.0450</td>
      <td>0.760441</td>
      <td>0.726983</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0445</td>
      <td>0.774748</td>
      <td>0.715291</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0440</td>
      <td>0.791584</td>
      <td>0.694080</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.0435</td>
      <td>0.780463</td>
      <td>0.727889</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.0430</td>
      <td>0.767022</td>
      <td>0.751666</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.0425</td>
      <td>0.775494</td>
      <td>0.814419</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.0420</td>
      <td>0.792654</td>
      <td>0.610945</td>
    </tr>
    <tr>
      <td>31</td>
      <td>0.0420</td>
      <td>0.762668</td>
      <td>0.560496</td>
    </tr>
    <tr>
      <td>36</td>
      <td>0.0420</td>
      <td>0.775194</td>
      <td>0.641992</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0415</td>
      <td>0.793269</td>
      <td>0.737730</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0410</td>
      <td>0.769310</td>
      <td>0.735044</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.0410</td>
      <td>0.749258</td>
      <td>0.741400</td>
    </tr>
    <tr>
      <td>32</td>
      <td>0.0410</td>
      <td>0.769769</td>
      <td>0.737659</td>
    </tr>
    <tr>
      <td>34</td>
      <td>0.0405</td>
      <td>0.776389</td>
      <td>0.776820</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.0405</td>
      <td>0.768463</td>
      <td>0.787852</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.0400</td>
      <td>0.746078</td>
      <td>0.720867</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.0390</td>
      <td>0.775483</td>
      <td>0.587352</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.0380</td>
      <td>0.763622</td>
      <td>0.736676</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0375</td>
      <td>0.776823</td>
      <td>0.793458</td>
    </tr>
    <tr>
      <td>37</td>
      <td>0.0375</td>
      <td>0.787847</td>
      <td>0.865077</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.0370</td>
      <td>0.758668</td>
      <td>0.513210</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.0360</td>
      <td>0.786266</td>
      <td>0.660319</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0350</td>
      <td>0.760738</td>
      <td>0.750750</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.0340</td>
      <td>0.757268</td>
      <td>0.630983</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0340</td>
      <td>0.780339</td>
      <td>0.798237</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.0340</td>
      <td>0.788884</td>
      <td>0.746811</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0335</td>
      <td>0.740508</td>
      <td>0.570123</td>
    </tr>
    <tr>
      <td>30</td>
      <td>0.0315</td>
      <td>0.769352</td>
      <td>0.639670</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0290</td>
      <td>0.756785</td>
      <td>0.068725</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0220</td>
      <td>0.747167</td>
      <td>-0.125303</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">380</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">417</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">380</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[118]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>740</td>
      <td>gene_389</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>8</td>
    </tr>
    <tr>
      <td>743</td>
      <td>gene_388</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>7</td>
    </tr>
    <tr>
      <td>744</td>
      <td>gene_387</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>6</td>
    </tr>
    <tr>
      <td>745</td>
      <td>gene_386</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>5</td>
    </tr>
    <tr>
      <td>746</td>
      <td>gene_385</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>4</td>
    </tr>
    <tr>
      <td>748</td>
      <td>gene_384</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>3</td>
    </tr>
    <tr>
      <td>750</td>
      <td>gene_382</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>1</td>
    </tr>
    <tr>
      <td>752</td>
      <td>gene_405</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>24</td>
    </tr>
    <tr>
      <td>753</td>
      <td>gene_418</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>37</td>
    </tr>
    <tr>
      <td>754</td>
      <td>gene_390</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>9</td>
    </tr>
    <tr>
      <td>755</td>
      <td>gene_391</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>10</td>
    </tr>
    <tr>
      <td>756</td>
      <td>gene_392</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>11</td>
    </tr>
    <tr>
      <td>757</td>
      <td>gene_393</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>12</td>
    </tr>
    <tr>
      <td>758</td>
      <td>gene_417</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>36</td>
    </tr>
    <tr>
      <td>759</td>
      <td>gene_416</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>35</td>
    </tr>
    <tr>
      <td>760</td>
      <td>gene_403</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>22</td>
    </tr>
    <tr>
      <td>761</td>
      <td>gene_402</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>21</td>
    </tr>
    <tr>
      <td>762</td>
      <td>gene_401</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>20</td>
    </tr>
    <tr>
      <td>763</td>
      <td>gene_400</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>19</td>
    </tr>
    <tr>
      <td>764</td>
      <td>gene_415</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>34</td>
    </tr>
    <tr>
      <td>765</td>
      <td>gene_399</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>18</td>
    </tr>
    <tr>
      <td>767</td>
      <td>gene_398</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>17</td>
    </tr>
    <tr>
      <td>768</td>
      <td>gene_397</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>16</td>
    </tr>
    <tr>
      <td>769</td>
      <td>gene_396</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>15</td>
    </tr>
    <tr>
      <td>770</td>
      <td>gene_395</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>14</td>
    </tr>
    <tr>
      <td>771</td>
      <td>gene_394</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>13</td>
    </tr>
    <tr>
      <td>772</td>
      <td>gene_404</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>23</td>
    </tr>
    <tr>
      <td>781</td>
      <td>gene_407</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>26</td>
    </tr>
    <tr>
      <td>782</td>
      <td>gene_408</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>27</td>
    </tr>
    <tr>
      <td>787</td>
      <td>gene_409</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>28</td>
    </tr>
    <tr>
      <td>788</td>
      <td>gene_410</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>29</td>
    </tr>
    <tr>
      <td>789</td>
      <td>gene_411</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>30</td>
    </tr>
    <tr>
      <td>792</td>
      <td>gene_412</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>31</td>
    </tr>
    <tr>
      <td>794</td>
      <td>gene_413</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>32</td>
    </tr>
    <tr>
      <td>795</td>
      <td>gene_414</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>33</td>
    </tr>
    <tr>
      <td>799</td>
      <td>gene_406</td>
      <td>6</td>
      <td>6700</td>
      <td>2</td>
      <td>6704</td>
      <td>0.288916</td>
      <td>25</td>
    </tr>
    <tr>
      <td>1046</td>
      <td>gene_381</td>
      <td>0</td>
      <td>6706</td>
      <td>2</td>
      <td>6704</td>
      <td>0.499963</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1759</td>
      <td>gene_383</td>
      <td>6</td>
      <td>6700</td>
      <td>5</td>
      <td>6701</td>
      <td>1.000000</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 365_374</span>
<span class="c1">## real 4</span>
<span class="c1">## effect 1.59</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[38]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4</td>
      <td>0.0965</td>
      <td>0.795459</td>
      <td>1.128080</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0925</td>
      <td>0.810873</td>
      <td>1.156519</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0900</td>
      <td>0.806027</td>
      <td>1.201729</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0885</td>
      <td>0.813363</td>
      <td>1.141432</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.0860</td>
      <td>0.819544</td>
      <td>1.043773</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0810</td>
      <td>0.816045</td>
      <td>1.104243</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.0810</td>
      <td>0.794617</td>
      <td>1.111514</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0765</td>
      <td>0.820308</td>
      <td>1.141249</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0760</td>
      <td>0.811247</td>
      <td>1.101379</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.0705</td>
      <td>0.802559</td>
      <td>1.156571</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[115]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">365</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">374</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">365</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[115]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>505</td>
      <td>gene_375</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>9</td>
    </tr>
    <tr>
      <td>506</td>
      <td>gene_374</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>8</td>
    </tr>
    <tr>
      <td>507</td>
      <td>gene_373</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>7</td>
    </tr>
    <tr>
      <td>508</td>
      <td>gene_372</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>6</td>
    </tr>
    <tr>
      <td>509</td>
      <td>gene_371</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>5</td>
    </tr>
    <tr>
      <td>510</td>
      <td>gene_370</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>4</td>
    </tr>
    <tr>
      <td>511</td>
      <td>gene_369</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>3</td>
    </tr>
    <tr>
      <td>513</td>
      <td>gene_367</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>1</td>
    </tr>
    <tr>
      <td>514</td>
      <td>gene_366</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>0</td>
    </tr>
    <tr>
      <td>515</td>
      <td>gene_368</td>
      <td>6</td>
      <td>6700</td>
      <td>1</td>
      <td>6705</td>
      <td>0.124902</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 264_293</span>
<span class="c1">## real 8,9,29</span>
<span class="c1">## effect 0.92, 1.21, 1.66</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>29</td>
      <td>0.2185</td>
      <td>0.911840</td>
      <td>1.368975</td>
    </tr>
    <tr>
      <td>0</td>
      <td>0.1415</td>
      <td>0.879138</td>
      <td>1.279202</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.1270</td>
      <td>0.830457</td>
      <td>1.272394</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.1260</td>
      <td>0.836580</td>
      <td>1.248508</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.1225</td>
      <td>0.845818</td>
      <td>1.323052</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.1175</td>
      <td>0.842276</td>
      <td>1.306886</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.0425</td>
      <td>0.777203</td>
      <td>0.572693</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.0400</td>
      <td>0.758333</td>
      <td>0.537903</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.0400</td>
      <td>0.782790</td>
      <td>0.602011</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.0370</td>
      <td>0.764466</td>
      <td>0.552337</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0365</td>
      <td>0.780601</td>
      <td>0.503386</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.0360</td>
      <td>0.777004</td>
      <td>0.432275</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.0355</td>
      <td>0.746566</td>
      <td>0.307252</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.0355</td>
      <td>0.771091</td>
      <td>0.521338</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.0350</td>
      <td>0.767981</td>
      <td>0.622685</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.0350</td>
      <td>0.775457</td>
      <td>0.545767</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.0335</td>
      <td>0.761779</td>
      <td>0.404635</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.0335</td>
      <td>0.755583</td>
      <td>0.508821</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.0335</td>
      <td>0.760093</td>
      <td>0.526724</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.0325</td>
      <td>0.750117</td>
      <td>0.383714</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.0325</td>
      <td>0.767277</td>
      <td>0.512558</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0325</td>
      <td>0.779531</td>
      <td>0.449769</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.0290</td>
      <td>0.798526</td>
      <td>0.554665</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.0285</td>
      <td>0.770494</td>
      <td>0.398047</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.0285</td>
      <td>0.770700</td>
      <td>0.375933</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0260</td>
      <td>0.764281</td>
      <td>0.593026</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.0255</td>
      <td>0.782997</td>
      <td>0.772184</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.0210</td>
      <td>0.751765</td>
      <td>-0.412728</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.0205</td>
      <td>0.772362</td>
      <td>-0.240226</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.0170</td>
      <td>0.749505</td>
      <td>-0.362882</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[117]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">264</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">293</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">264</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[117]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>381</td>
      <td>gene_275</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>10</td>
    </tr>
    <tr>
      <td>382</td>
      <td>gene_274</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>9</td>
    </tr>
    <tr>
      <td>383</td>
      <td>gene_273</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>8</td>
    </tr>
    <tr>
      <td>384</td>
      <td>gene_272</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>7</td>
    </tr>
    <tr>
      <td>386</td>
      <td>gene_265</td>
      <td>8</td>
      <td>6698</td>
      <td>1</td>
      <td>6705</td>
      <td>0.039000</td>
      <td>0</td>
    </tr>
    <tr>
      <td>439</td>
      <td>gene_294</td>
      <td>7</td>
      <td>6699</td>
      <td>1</td>
      <td>6705</td>
      <td>0.070231</td>
      <td>29</td>
    </tr>
    <tr>
      <td>706</td>
      <td>gene_283</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>18</td>
    </tr>
    <tr>
      <td>707</td>
      <td>gene_270</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>5</td>
    </tr>
    <tr>
      <td>708</td>
      <td>gene_285</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>20</td>
    </tr>
    <tr>
      <td>709</td>
      <td>gene_284</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>19</td>
    </tr>
    <tr>
      <td>710</td>
      <td>gene_282</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>17</td>
    </tr>
    <tr>
      <td>711</td>
      <td>gene_286</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>21</td>
    </tr>
    <tr>
      <td>712</td>
      <td>gene_281</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>16</td>
    </tr>
    <tr>
      <td>713</td>
      <td>gene_271</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>6</td>
    </tr>
    <tr>
      <td>714</td>
      <td>gene_280</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>15</td>
    </tr>
    <tr>
      <td>715</td>
      <td>gene_279</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>14</td>
    </tr>
    <tr>
      <td>716</td>
      <td>gene_278</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>13</td>
    </tr>
    <tr>
      <td>718</td>
      <td>gene_269</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>4</td>
    </tr>
    <tr>
      <td>720</td>
      <td>gene_268</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>3</td>
    </tr>
    <tr>
      <td>722</td>
      <td>gene_287</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>22</td>
    </tr>
    <tr>
      <td>723</td>
      <td>gene_289</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>24</td>
    </tr>
    <tr>
      <td>724</td>
      <td>gene_277</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>12</td>
    </tr>
    <tr>
      <td>725</td>
      <td>gene_276</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>11</td>
    </tr>
    <tr>
      <td>726</td>
      <td>gene_266</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>1</td>
    </tr>
    <tr>
      <td>727</td>
      <td>gene_267</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>2</td>
    </tr>
    <tr>
      <td>728</td>
      <td>gene_288</td>
      <td>9</td>
      <td>6697</td>
      <td>4</td>
      <td>6702</td>
      <td>0.266611</td>
      <td>23</td>
    </tr>
    <tr>
      <td>814</td>
      <td>gene_290</td>
      <td>16</td>
      <td>6690</td>
      <td>23</td>
      <td>6683</td>
      <td>0.336077</td>
      <td>25</td>
    </tr>
    <tr>
      <td>948</td>
      <td>gene_293</td>
      <td>9</td>
      <td>6697</td>
      <td>5</td>
      <td>6701</td>
      <td>0.423704</td>
      <td>28</td>
    </tr>
    <tr>
      <td>955</td>
      <td>gene_291</td>
      <td>18</td>
      <td>6688</td>
      <td>24</td>
      <td>6682</td>
      <td>0.440078</td>
      <td>26</td>
    </tr>
    <tr>
      <td>1087</td>
      <td>gene_292</td>
      <td>8</td>
      <td>6698</td>
      <td>12</td>
      <td>6694</td>
      <td>0.503122</td>
      <td>27</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[645]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">### selective</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[647]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="c1">## block 23_36</span>
<span class="c1">## real 0,2,5,11</span>
<span class="n">results</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;inclusion_probability&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[647]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>inclusion_probability</th>
      <th>beta</th>
      <th>beta_given_inclusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.0970</td>
      <td>0.816991</td>
      <td>1.289321</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.1175</td>
      <td>0.838144</td>
      <td>1.255700</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0990</td>
      <td>0.825578</td>
      <td>1.192458</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.1105</td>
      <td>0.835401</td>
      <td>1.263729</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.1225</td>
      <td>0.795763</td>
      <td>1.200789</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.1100</td>
      <td>0.801798</td>
      <td>1.221597</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.1075</td>
      <td>0.824616</td>
      <td>1.175793</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.1110</td>
      <td>0.843880</td>
      <td>1.219808</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.0975</td>
      <td>0.827300</td>
      <td>1.229726</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.1230</td>
      <td>0.838705</td>
      <td>1.268431</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[644]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">fisher_block</span> <span class="o">=</span> <span class="n">fisher</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">fisher</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">f</span><span class="s2">&quot;gene_{x}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">+</span><span class="mi">2</span><span class="p">)])]</span>
<span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fisher_block</span><span class="p">[</span><span class="s2">&quot;gene&quot;</span><span class="p">]]</span>
<span class="n">fisher_block</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[644]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>d_c</th>
      <th>d_nc</th>
      <th>nd_c</th>
      <th>nd_nc</th>
      <th>p</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>gene_25</td>
      <td>603</td>
      <td>6103</td>
      <td>76</td>
      <td>6630</td>
      <td>1.910490e-107</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>gene_28</td>
      <td>603</td>
      <td>6103</td>
      <td>76</td>
      <td>6630</td>
      <td>1.910490e-107</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>gene_27</td>
      <td>603</td>
      <td>6103</td>
      <td>76</td>
      <td>6630</td>
      <td>1.910490e-107</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3</td>
      <td>gene_26</td>
      <td>603</td>
      <td>6103</td>
      <td>76</td>
      <td>6630</td>
      <td>1.910490e-107</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>gene_29</td>
      <td>603</td>
      <td>6103</td>
      <td>76</td>
      <td>6630</td>
      <td>1.910490e-107</td>
      <td>5</td>
    </tr>
    <tr>
      <td>5</td>
      <td>gene_24</td>
      <td>528</td>
      <td>6178</td>
      <td>61</td>
      <td>6645</td>
      <td>1.710063e-97</td>
      <td>0</td>
    </tr>
    <tr>
      <td>29</td>
      <td>gene_30</td>
      <td>234</td>
      <td>6472</td>
      <td>41</td>
      <td>6665</td>
      <td>1.291823e-34</td>
      <td>6</td>
    </tr>
    <tr>
      <td>35</td>
      <td>gene_31</td>
      <td>162</td>
      <td>6544</td>
      <td>26</td>
      <td>6680</td>
      <td>1.641138e-25</td>
      <td>7</td>
    </tr>
    <tr>
      <td>124</td>
      <td>gene_32</td>
      <td>20</td>
      <td>6686</td>
      <td>3</td>
      <td>6703</td>
      <td>4.832617e-04</td>
      <td>8</td>
    </tr>
    <tr>
      <td>125</td>
      <td>gene_33</td>
      <td>20</td>
      <td>6686</td>
      <td>3</td>
      <td>6703</td>
      <td>4.832617e-04</td>
      <td>9</td>
    </tr>
    <tr>
      <td>126</td>
      <td>gene_34</td>
      <td>20</td>
      <td>6686</td>
      <td>3</td>
      <td>6703</td>
      <td>4.832617e-04</td>
      <td>10</td>
    </tr>
    <tr>
      <td>161</td>
      <td>gene_37</td>
      <td>12</td>
      <td>6694</td>
      <td>1</td>
      <td>6705</td>
      <td>3.403787e-03</td>
      <td>13</td>
    </tr>
    <tr>
      <td>162</td>
      <td>gene_36</td>
      <td>12</td>
      <td>6694</td>
      <td>1</td>
      <td>6705</td>
      <td>3.403787e-03</td>
      <td>12</td>
    </tr>
    <tr>
      <td>163</td>
      <td>gene_35</td>
      <td>12</td>
      <td>6694</td>
      <td>1</td>
      <td>6705</td>
      <td>3.403787e-03</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But the true causal variables are 14 and 31 ... apparently this needs more work.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Some-sanity-check">Some sanity check<a class="anchor-link" href="#Some-sanity-check">&#182;</a></h2><ol>
<li>Does posterior predictive mean $\tilde{y}$ roughly equal to data mean?</li>
<li>What's the posterior number of non-zero variables?</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">estimate</span> <span class="o">=</span> <span class="n">trace</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">trace</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">]</span> 
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expit</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">estimate</span><span class="p">)</span> <span class="p">))</span> <span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_hat</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">inclusion_probability</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.5000008683342422 1.13855
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the posterior mean suggests 1 variable involved. The prior is $0.043 \times 50 \approx 2$ expected. <strong>Need to check this with simulated truth; also should run <code>varbvs</code> on this and compare</strong>.</p>

</div>
</div>
</div>
<hr>
&copy 2016-2017 Min Qiao at <a href="http://xinhelab.org">Xin He lab</a>, The University of Chicago
<p><small>Exported from <a href="http://github.com/gaow/cnv-gene-mapping/blob/06b7431656558076017f93d48f8d163668b0319a/dsc/20191005_PyMC3_SpikeSlab.ipynb"><code>dsc/20191005_PyMC3_SpikeSlab.ipynb</code></a> committed by minqiao on Fri Jan 10 14:40:33 2020 <a href="http://github.com/gaow/cnv-gene-mapping/commit/06b7431656558076017f93d48f8d163668b0319a">revision 9, 06b7431</a> <a href="https://stephenslab.github.io/ipynb-website/notes.html#Note-about-commit-ids"><span class="fa fa-question-circle"></span></a></small></p>
</div>
</div>
</body>
</html>
