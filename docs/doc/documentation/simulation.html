<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>simulation</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>








<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>

 <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>

<style>  /* defined here in case the main.css below cannot be loaded */
.lev1 {margin-left: 80px}
.lev2 {margin-left: 100px}
.lev3 {margin-left: 120px}
.lev4 {margin-left: 140px}
.lev5 {margin-left: 160px}
.lev6 {margin-left: 180px}
</style>

<link rel="stylesheet" type="text/css" href="../../css/jt.css">
<link rel="stylesheet" type="text/css" href="../../css/toc2.css">

<script src="../../js/toc2.js"></script>
<script src="../../js/docs.js"></script>

<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["STIX","TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>

<script>
$( document ).ready(function(){

            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false, 
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }

            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;

            // fire the main function with these parameters


            table_of_contents(cfg,st);

            var file=analysisDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=documentation;
            var pos=documentation.indexOf(file);
        
            for (var a=pos;a>=0;a--){
                  var name=docs[a]
                  $('<li><a href="'+name+'.html">'+name.replace(/_/g," ")+'</a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");


            $('<li id="indexHome"><a href="../../documentation.html"><b>Analysis Home<b></a></li>').insertBefore("#toc-level0 li:eq(0)");
            for (var a=pos+1;a<docs.length;a++){
                  var name=docs[a]
                  $(".toc #toc-level0").append('<li><a href="'+name+'.html">'+name.replace(/_/g," ")+'</a></li>');
            }
            $("#toc-header").hide();

    });
</script>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Simulation-of-Exome-wide-CNV-data-for-case-control-samples">Simulation of Exome-wide CNV data for case control samples<a class="anchor-link" href="#Simulation-of-Exome-wide-CNV-data-for-case-control-samples">&#182;</a></h1><h2 id="Simulation-outline">Simulation outline<a class="anchor-link" href="#Simulation-outline">&#182;</a></h2><p>For given type of CNV (e.g. duplication) we first simulate all the variants across exome, 
then assign these simulated CNVs to genes. For case samples we expect an enrichment in causal
genes and the enrichment should be quantified by relative risk of a CNV's contribution to disease
when presented in causal gene vs. non causal gene.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters">&#182;</a></h2><p>We define causal CNV as CNV in causal gene, and denote it as CCNV. Likewise we have NCNV for non-causal CNV.</p>
<table>
<thead><tr>
<th style="text-align:center">Parameter</th>
<th style="text-align:center">Description</th>
<th style="text-align:center">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$\lambda$</td>
<td style="text-align:center">Average number of CNV per exome</td>
<td style="text-align:center">100 for dup, 20 for del (<em>FIXME: reference required</em>)</td>
</tr>
<tr>
<td style="text-align:center">$p_L$</td>
<td style="text-align:center">Parameter for Geometric distribution that models length of CNV</td>
<td style="text-align:center">To be fitted from data</td>
</tr>
<tr>
<td style="text-align:center">$\gamma$</td>
<td style="text-align:center">Odds ratio of CCNV</td>
<td style="text-align:center">To draw from distribution Gamma(5, 1)</td>
</tr>
<tr>
<td style="text-align:center">$p_0$</td>
<td style="text-align:center">Pr(case &#124; NCNV)</td>
<td style="text-align:center">To be calculated below</td>
</tr>
<tr>
<td style="text-align:center">$p_1$</td>
<td style="text-align:center">Pr(case &#124; CCNV)</td>
<td style="text-align:center">To be calculated from $p_0$ and $\gamma$</td>
</tr>
<tr>
<td style="text-align:center">$N_0, N_1$</td>
<td style="text-align:center">Case / Ctrl sample size</td>
<td style="text-align:center">Various numbers</td>
</tr>
<tr>
<td style="text-align:center">$q$</td>
<td style="text-align:center">Proportion of causal gene</td>
<td style="text-align:center">(<em>FIXME: reference required</em>)</td>
</tr>
<tr>
<td style="text-align:center">$k$</td>
<td style="text-align:center">The prevalence of disease</td>
<td style="text-align:center">(<em>FIXME: reference required</em>)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simulation-steps">Simulation steps<a class="anchor-link" href="#Simulation-steps">&#182;</a></h2><p>The steps below simulates exome data for single individual case or control for one type of CNV.</p>
<h3 id="Step-1:-Simulate-number-of-CNV-per-exome">Step 1: Simulate number of CNV per exome<a class="anchor-link" href="#Step-1:-Simulate-number-of-CNV-per-exome">&#182;</a></h3><p>Simply drawn from Pois($\lambda$)</p>
<h3 id="Step-2:-Get-the-length-of-each-of-these-CNV-simulated">Step 2: Get the length of each of these CNV simulated<a class="anchor-link" href="#Step-2:-Get-the-length-of-each-of-these-CNV-simulated">&#182;</a></h3><p>First, separate genome to 10K blocks and find how many CNV overlap (for real data), draw histogram and create a table. Define any block containing 2 or more CNVs as a hotspot.</p>
<p>Second, mimic the distribution of the length of CNV: fit a mixture of geometric, a prop is long tail, a prop is short and a prop is normal.</p>
<p>Finally for each CNV, draw the length of it from the distribution obtained, and set the start point according to the histogram of CNV start point among 10K blocks, and set the length according to mixed geometric.</p>
<h3 id="Step-3:-Get-the-probability-of-a-sample-being-case-give-all-CNVs">Step 3: Get the probability of a sample being case give all CNVs<a class="anchor-link" href="#Step-3:-Get-the-probability-of-a-sample-being-case-give-all-CNVs">&#182;</a></h3><p>Suppose $p$ is baseline probability of the disease (prevalence), and $r_0$ is the baseline odds $\frac{p}{1-p}$.</p>
<p>Given simulated CNVs in a sample, the probability for the sample to be case is $p_1$, then the odds ratio for case is $r_1 = r_0 \times R = \frac{p_1}{1-p_1}$, $R$ is the combined relative risks of the all CNVs involved in a sample. Each $R_i$ for causal CNVs is to be sampled from Gamma(1,5), $R = \prod_{i=1}^{\#CNV} R_i$. For noncausal CNV, the $R_i$ is 1. Then $P(case|all CNV) = p_1 = \frac{r_0*R}{1+r_0*R}$, and $P(ctrl|all CNV) = 1-p_1$.</p>
<p>Since $p_1$ is small, about $\frac{1}{p} * n$ trials are to be simulated in order to obtain $n$ cases. However, $n$ controls are easy to obtain.</p>
<h3 id="Step-4:-Check-if-CNVs-overlap-with-causal-gene">Step 4: Check if CNVs overlap with causal gene<a class="anchor-link" href="#Step-4:-Check-if-CNVs-overlap-with-causal-gene">&#182;</a></h3><p>Causal/noncausal gene positions are supposed to be determined by literature. But we can simulate randomly for starters.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implementation">Implementation<a class="anchor-link" href="#Implementation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandasql</span> <span class="k">import</span> <span class="n">sqldf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ref_gene</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;data/refGene.txt.gz&quot;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> 
                         <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> 
                         <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;tx_name&quot;</span><span class="p">,</span> <span class="s2">&quot;chrom&quot;</span><span class="p">,</span> <span class="s2">&quot;tx_start&quot;</span><span class="p">,</span> <span class="s2">&quot;tx_end&quot;</span><span class="p">,</span> <span class="s2">&quot;gene_name&quot;</span><span class="p">])</span>
<span class="c1">#gene_df = ref_gene.drop_duplicates(subset=(&quot;chrom&quot;, &quot;tx_start&quot;, &quot;tx_end&quot;, &quot;gene_name&quot;))</span>
<span class="n">gene_df</span> <span class="o">=</span> <span class="n">ref_gene</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;chrom&quot;</span><span class="p">,</span> <span class="s2">&quot;tx_start&quot;</span><span class="p">,</span> <span class="s2">&quot;tx_end&quot;</span><span class="p">))</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">select chrom, gene_name, min(tx_start), max(tx_end)</span>
<span class="s1">from gene_df</span>
<span class="s1">group by chrom, gene_name</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">gene_table</span> <span class="o">=</span> <span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="c1">#print (gene_table)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Step-1-&amp;-2">Step 1 &amp; 2<a class="anchor-link" href="#Step-1-&amp;-2">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;data/ISC-r1.CNV.bed&quot;</span>
<span class="n">cnvbed</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;chr&quot;</span><span class="p">):</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;name=&quot;</span><span class="p">)</span>
        <span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">continue</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">]:</span>
        <span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
    
<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">cnvbed</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">]:</span>
        <span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="n">chrom</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">cnvbed_df</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">cnvbed</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">cnvbed_df</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;chrom&quot;</span><span class="p">:[],</span> <span class="s2">&quot;cnv_start&quot;</span><span class="p">:[],</span> <span class="s2">&quot;cnv_end&quot;</span><span class="p">:[]}</span>
    <span class="k">for</span> <span class="n">chrom</span> <span class="ow">in</span> <span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">]:</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">cnvbed</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="n">chrom</span><span class="p">]))</span> 
        <span class="n">cnvbed_df</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="s2">&quot;chrom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">chrom</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">start</span><span class="p">))</span>
        <span class="n">cnvbed_df</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="s2">&quot;cnv_start&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="n">cnvbed_df</span><span class="p">[</span><span class="n">dataset</span><span class="p">][</span><span class="s2">&quot;cnv_end&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
    <span class="n">cnvbed_df</span><span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">cnvbed_df</span><span class="p">[</span><span class="n">dataset</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                                            <span class="n">subset</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;chrom&quot;</span><span class="p">,</span> <span class="s2">&quot;cnv_start&quot;</span><span class="p">,</span> <span class="s2">&quot;cnv_end&quot;</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">cnvbed_df</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;dupControls&#39;:       chrom    cnv_end  cnv_start
0      chr4     192796      55677
1      chr4     190632      58821
2      chr4     192796      58821
3      chr4     240067     110944
4      chr4     250808     133439
5      chr4     302482     200096
6      chr4     380687     256863
7      chr4    3225269    2943461
8      chr4    4972110    4627826
9      chr4    7871489    7340508
10     chr4    7871489    7340508
11     chr4    9133247    8842614
12     chr4    9147528    9046959
13     chr4    9147528    9046959
14     chr4    9162357    9046959
15     chr4    9177664    9046959
16     chr4    9168219    9048572
17     chr4    9171010    9048572
18     chr4    9174136    9048572
19     chr4    9310260    9162356
20     chr4    9326868    9223591
21     chr4   22479717   22268861
22     chr4   22689901   22542427
23     chr4   33876324   33562102
24     chr4   40620897   40512226
25     chr4   40621293   40512226
26     chr4   40621293   40519602
27     chr4   43061614   42660686
28     chr4   47747776   47328868
29     chr4   49420535   48954984
...     ...        ...        ...
1843  chr11   63808017   63641029
1844  chr11   64137868   63953600
1845  chr11   64555625   64404625
1846  chr11   65343086   65207596
1847  chr11   67505899   67229481
1848  chr11   67505899   67229481
1849  chr11   67505899   67232177
1850  chr11   67505822   67232201
1851  chr11   67505899   67258202
1852  chr11   67505899   67258202
1853  chr11   67488891   67267202
1854  chr11   67505899   67273413
1855  chr11   71252943   71004601
1856  chr11   71252943   71012031
1857  chr11   84898422   84793776
1858  chr11   92385453   92234331
1859  chr11   99851558   95784982
1860  chr11  107463032  107046147
1861  chr11  107368941  107047029
1862  chr11  113291750  113039585
1863  chr11  117458899  117346037
1864  chr11  120490210  120145290
1865  chr11  122194854  122038669
1866  chr11  123088827  122871569
1867  chr11  129371864  129194999
1868  chr11  131103920  130068459
1869  chr11  132206155  130150716
1870  chr11  134074153  133631822
1871  chr11  133924158  133760600
1872  chr11  134357489  134216179

[1873 rows x 3 columns], &#39;delControls&#39;:       chrom    cnv_end  cnv_start
0      chr4     220238      77113
1      chr4    4240901    3934713
2      chr4    9147528    9046959
3      chr4    9162357    9046959
4      chr4    9174185    9046959
5      chr4    9174185    9048572
6      chr4    9174185    9048572
7      chr4    9174185    9048572
8      chr4    9177664    9048572
9      chr4    9174136    9052835
10     chr4    9162357    9057460
11     chr4   11948682   11838297
12     chr4   11948682   11841929
13     chr4   12783628   12580799
14     chr4   18892765   18776398
15     chr4   35266905   35166442
16     chr4   56543228   56332815
17     chr4   58690124   58544547
18     chr4   58691860   58544547
19     chr4   64122614   63951115
20     chr4   64122614   63951115
21     chr4   65745197   65561686
22     chr4   65745197   65561686
23     chr4   69318484   69021137
24     chr4   69702177   69203707
25     chr4   69702177   69203707
26     chr4   69702177   69203707
27     chr4   69702177   69203707
28     chr4   69702177   69203707
29     chr4   69724268   69203707
...     ...        ...        ...
1248  chr11   48931205   48335526
1249  chr11   48622613   48337480
1250  chr11   48690754   48358731
1251  chr11   48924604   48358731
1252  chr11   48763985   48358889
1253  chr11   48527010   48386976
1254  chr11   48849796   48747676
1255  chr11   48849796   48747676
1256  chr11   48849796   48747676
1257  chr11   48849796   48747676
1258  chr11   48849796   48747676
1259  chr11   60384160   60282828
1260  chr11   65105808   64875573
1261  chr11   67505899   67247590
1262  chr11   67488891   67263973
1263  chr11   67488891   67263973
1264  chr11   67505899   67267202
1265  chr11   67488533   67268917
1266  chr11   67488766   67268917
1267  chr11   79777811   79604531
1268  chr11   82124217   81811881
1269  chr11   83952350   83687877
1270  chr11   89299217   89097352
1271  chr11   89913100   89693979
1272  chr11   97048013   96918354
1273  chr11   97061600   96928700
1274  chr11   97858766   97224044
1275  chr11   97615092   97336453
1276  chr11  134449983  132212647
1277  chr11  134314301  134167737

[1278 rows x 3 columns], &#39;dupCases&#39;:       chrom    cnv_end  cnv_start
0      chr4     111563       2116
1      chr4     111563       6428
2      chr4     141233       6428
3      chr4     207972       6428
4      chr4     173518      26855
5      chr4     207972      48827
6      chr4    4285206    4045997
7      chr4    5812277    5643778
8      chr4    7957994    7357403
9      chr4    7871489    7613999
10     chr4    8113746    7993652
11     chr4    8561190    8415398
12     chr4    9162357    9046959
13     chr4    9162222    9048572
14     chr4    9168219    9048572
15     chr4    9171010    9048572
16     chr4    9503140    9197126
17     chr4    9508574    9220415
18     chr4   10066985    9661275
19     chr4   10358658   10078987
20     chr4   11103073   10382691
21     chr4   11978183   11796129
22     chr4   12351659   12053862
23     chr4   22695018   22542427
24     chr4   28573504   28393800
25     chr4   33876324   33577983
26     chr4   37584918   37397276
27     chr4   40057340   39521590
28     chr4   39937505   39594100
29     chr4   47747776   47328868
...     ...        ...        ...
2198  chr11   69644131   69521535
2199  chr11   70141466   69804033
2200  chr11   70269882   70141465
2201  chr11   72225335   72061419
2202  chr11   77108365   76961696
2203  chr11   77108365   76961696
2204  chr11   85042205   84304683
2205  chr11   85465059   85142570
2206  chr11   87354718   87201391
2207  chr11   89098558   88988300
2208  chr11   89138011   89015605
2209  chr11   96106467   95950843
2210  chr11  104792504  103542068
2211  chr11  107451795  107022117
2212  chr11  114682575  114570503
2213  chr11  118566821  118321366
2214  chr11  119101983  118863632
2215  chr11  119047766  118915906
2216  chr11  128790554  128603323
2217  chr11  132771542  132329581
2218  chr11  134449983  134161618
2219  chr11  134449983  134258768
2220  chr11  134449983  134258768
2221  chr11  134449983  134268514
2222  chr11  134449983  134284092
2223  chr11  134449983  134291361
2224  chr11  134449983  134313007
2225  chr11  134449983  134338994
2226  chr11  134449983  134347740
2227  chr11  134449983  134347740

[2228 rows x 3 columns], &#39;delCases&#39;:      chrom    cnv_end  cnv_start
0     chr4     166522      58821
1     chr4     712308     511830
2     chr4    8738298    8586366
3     chr4    8738298    8586709
4     chr4    9155615    9046959
5     chr4    9174185    9046959
6     chr4    9177664    9046959
7     chr4    9177664    9046959
8     chr4    9262583    9046959
9     chr4    9263034    9046959
10    chr4    9174136    9048572
11    chr4    9174136    9048572
12    chr4    9177664    9052835
13    chr4   11876033   11775897
14    chr4   11948682   11838410
15    chr4   12783628   12671014
16    chr4   16467467   16195988
17    chr4   18863181   18692392
18    chr4   29213748   28161470
19    chr4   28541944   28415433
20    chr4   29994533   29759473
21    chr4   29994405   29759720
22    chr4   29999261   29759720
23    chr4   32087396   30676200
24    chr4   48050810   47943533
25    chr4   64107613   63951115
26    chr4   64837821   64328775
27    chr4   65745197   65561686
28    chr4   66634266   66454990
29    chr4   66776942   66657713
...    ...        ...        ...
1344  chr2  117847299  117685310
1345  chr2  117837101  117689384
1346  chr2  118115373  117965018
1347  chr2  118114733  117965159
1348  chr2  118114733  117971266
1349  chr2  123952005  123823604
1350  chr2  126757786  126522904
1351  chr2  126771256  126522904
1352  chr2  132095962  131989506
1353  chr2  133717921  133599881
1354  chr2  133997053  133621694
1355  chr2  151493414  150848112
1356  chr2  153166230  153054076
1357  chr2  181995913  181854864
1358  chr2  185909729  185118087
1359  chr2  186688954  186267497
1360  chr2  193867991  193681876
1361  chr2  193960577  193697717
1362  chr2  194972493  194779093
1363  chr2  195747271  195566354
1364  chr2  213074751  212966805
1365  chr2  215598268  215454266
1366  chr2  233134572  233029864
1367  chr2  234518700  234336814
1368  chr2  237502635  236664542
1369  chr2  242745404  242439795
1370  chr2  242745404  242439795
1371  chr2  242750316  242439795
1372  chr2  242753422  242439795
1373  chr2  242750439  242502261

[1374 rows x 3 columns]}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cnv_length</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cnvbed_df</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT cnv_end-cnv_start</span>
<span class="s2">    FROM value</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">cnv_length</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqldf</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">cnv_length</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnv_length</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cnv_end-cnv_start&quot;</span><span class="p">:</span> <span class="s2">&quot;cnv_length&quot;</span><span class="p">})</span>

<span class="c1">#print (cnv_length[&quot;delCases&quot;])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">cnv_length</span><span class="p">[</span><span class="s2">&quot;dupCases&quot;</span><span class="p">]))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">cnv_length</span><span class="p">[</span><span class="s2">&quot;delCases&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">800</span><span class="p">])</span>
<span class="c1">#plt.plot(cnv_length[&quot;delControls&quot;])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>192471.0
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[7]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f11adb8b668&gt;</pre>
</div>

</div>

<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cnv_overlap</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cnvbed_df</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    WHERE </span>
<span class="s2">    &quot;&quot;&quot;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[153]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n1</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># to be obtained from literature</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">80</span> <span class="c1"># to be obtained from literature</span>
<span class="n">p_del</span> <span class="o">=</span> <span class="mf">0.00006</span> <span class="c1"># to be obtained from real data</span>
<span class="n">p_dup</span> <span class="o">=</span> <span class="mf">0.00004</span> <span class="c1"># to be obtained from real data</span>
<span class="n">n_delcase</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_delctrl</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_dupcase</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_dupctrl</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_del</span> <span class="o">=</span> <span class="n">n_delcase</span><span class="o">+</span><span class="n">n_delctrl</span>
<span class="n">n_dup</span> <span class="o">=</span> <span class="n">n_dupcase</span><span class="o">+</span><span class="n">n_dupctrl</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># prevalence of the disease</span>
<span class="n">q</span> <span class="o">=</span> <span class="mf">0.002</span> <span class="c1"># q: Proportion of causal gene</span>
<span class="n">shape</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">delCNV</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span>
    <span class="n">n_del</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
    <span class="n">len_delcnv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">geometric</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_del</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_del</span><span class="p">)</span><span class="o">+</span><span class="mi">10000</span>
    <span class="k">return</span> <span class="n">len_delcnv</span>

<span class="k">def</span> <span class="nf">dupCNV</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
    <span class="n">n_dup</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
    <span class="n">len_dupcnv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">geometric</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p_dup</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_dup</span><span class="p">)</span><span class="o">+</span><span class="mi">10000</span>
    <span class="k">return</span> <span class="n">len_dupcnv</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Step-3">Step 3<a class="anchor-link" href="#Step-3">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">genegroup</span><span class="p">(</span><span class="n">genelist</span><span class="p">):</span>
    <span class="n">cslgene</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">genelist</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">genelist</span><span class="p">)))</span>
    <span class="n">noncslgene</span> <span class="o">=</span> <span class="n">genelist</span> <span class="o">-</span> <span class="n">cslgene</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cslgene</span><span class="p">,</span> <span class="n">noncslgene</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">p_case</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="c1"># p1: Pr(case | CCNV), p0: Pr(case | NCNV)</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">rv</span><span class="o">-</span><span class="n">q</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">k</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">rv</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">rv</span><span class="o">+</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">rv</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
    <span class="n">p_ccnv_case</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="n">q</span> <span class="o">/</span> <span class="n">k</span>
    <span class="n">p_ncnv_case</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_ccnv_case</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p_ccnv_case</span><span class="p">,</span> <span class="n">p_ncnv_case</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">p_ctrl</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="n">p_ccnv_ctrl</span> <span class="o">=</span> <span class="n">q</span>
    <span class="n">p_ncnv_ctrl</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">q</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p_ccnv_ctrl</span><span class="p">,</span> <span class="n">p_ncnv_ctrl</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Trial">Trial<a class="anchor-link" href="#Trial">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cnvg</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1"># prevalence of the disease</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># q: Proportion of causal gene</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">r</span><span class="o">-</span><span class="n">q</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">k</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">r</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">r</span><span class="o">+</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">r</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">p_ccnv_case</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="n">q</span><span class="o">/</span><span class="n">k</span>
    <span class="n">p_ncnv_case</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p_ccnv_case</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p_ccnv_case</span><span class="p">,</span> <span class="n">p_ncnv_case</span><span class="p">)</span>
<span class="n">cnvg</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>4.889419045453884
0.043919588316617804
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[79]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(0.08783917663323561, 0.9121608233667644)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[152]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">CNVcase</span><span class="p">(</span><span class="n">delCNV</span><span class="p">):</span>
    <span class="n">cslcnv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">CCNV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p_ccnv_case</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">CCNV</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">cslcnv</span><span class="o">.</span><span class="n">append</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
    </div>
  </div>
</body>
</html>
